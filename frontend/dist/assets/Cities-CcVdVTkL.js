import{r as h,p as e,S as K,s as N,Q as q,ae as V,O as u,R as H,X as J}from"./index-DaTQeIrM.js";import{D as Q}from"./ConfirmationDialog-DxRMdj0p.js";import{a as Z}from"./useConfirmation-C3qnwA_z.js";import{b as _,u as $,c as X,d as Y}from"./citiesApi-CcYT57x4.js";import{P as W}from"./plus-CH9F90nm.js";import{P as ee}from"./pen-square-CD6kqgaB.js";import{T as ae}from"./trash-2-NO2IJ0Re.js";import"./shield-DyTx0jkP.js";import"./check-circle-C7Swk4iC.js";import"./info-geJWZ_yE.js";const te=["Afghanistan","Albania","Algeria","Andorra","Angola","Antigua and Barbuda","Argentina","Armenia","Australia","Austria","Azerbaijan","Bahamas","Bahrain","Bangladesh","Barbados","Belarus","Belgium","Belize","Benin","Bhutan","Bolivia","Bosnia and Herzegovina","Botswana","Brazil","Brunei","Bulgaria","Burkina Faso","Burundi","Cabo Verde","Cambodia","Cameroon","Canada","Central African Republic","Chad","Chile","China","Colombia","Comoros","Congo","Costa Rica","Croatia","Cuba","Cyprus","Czech Republic","Denmark","Djibouti","Dominica","Dominican Republic","Ecuador","Egypt","El Salvador","Equatorial Guinea","Eritrea","Estonia","Eswatini","Ethiopia","Fiji","Finland","France","Gabon","Gambia","Georgia","Germany","Ghana","Greece","Grenada","Guatemala","Guinea","Guinea-Bissau","Guyana","Haiti","Honduras","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Jamaica","Japan","Jordan","Kazakhstan","Kenya","Kiribati","Korea, North","Korea, South","Kuwait","Kyrgyzstan","Laos","Latvia","Lebanon","Lesotho","Liberia","Libya","Liechtenstein","Lithuania","Luxembourg","Madagascar","Malawi","Malaysia","Maldives","Mali","Malta","Marshall Islands","Mauritania","Mauritius","Mexico","Micronesia","Moldova","Monaco","Mongolia","Montenegro","Morocco","Mozambique","Myanmar","Namibia","Nauru","Nepal","Netherlands","New Zealand","Nicaragua","Niger","Nigeria","North Macedonia","Norway","Oman","Pakistan","Palau","Palestine","Panama","Papua New Guinea","Paraguay","Peru","Philippines","Poland","Portugal","Qatar","Romania","Russia","Rwanda","Saint Kitts and Nevis","Saint Lucia","Saint Vincent and the Grenadines","Samoa","San Marino","Sao Tome and Principe","Saudi Arabia","Senegal","Serbia","Seychelles","Sierra Leone","Singapore","Slovakia","Slovenia","Solomon Islands","Somalia","South Africa","South Sudan","Spain","Sri Lanka","Sudan","Suriname","Sweden","Switzerland","Syria","Taiwan","Tajikistan","Tanzania","Thailand","Timor-Leste","Togo","Tonga","Trinidad and Tobago","Tunisia","Turkey","Turkmenistan","Tuvalu","Uganda","Ukraine","United Arab Emirates","United Kingdom","United States","Uruguay","Uzbekistan","Vanuatu","Vatican City","Venezuela","Vietnam","Yemen","Zambia","Zimbabwe"],M={name:"",state:"",country:"Pakistan",description:"",isActive:!0},se=({city:n,onSave:g,onCancel:p,isSubmitting:r})=>{const[i,l]=h.useState(()=>({...M}));H.useEffect(()=>{l(n?{name:n.name||"",state:n.state||"",country:n.country||"Pakistan",description:n.description||"",isActive:n.isActive!==void 0?n.isActive:!0}:{...M})},[n]);const x=s=>{if(s.preventDefault(),!i.name.trim()){u.error("City name is required");return}g(i)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-md w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:n?"Edit City":"Add New City"}),e.jsx("button",{onClick:p,className:"p-2 text-gray-400 hover:text-gray-600",children:e.jsx(J,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Country"}),e.jsx("select",{value:i.country,onChange:s=>l({...i,country:s.target.value}),className:"input",children:te.map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"City Name *"}),e.jsx("input",{type:"text",value:i.name,onChange:s=>l({...i,name:s.target.value}),className:"input",placeholder:"Enter city name",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"State"}),e.jsx("input",{type:"text",value:i.state,onChange:s=>l({...i,state:s.target.value}),className:"input",placeholder:"Enter state"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{value:i.description,onChange:s=>l({...i,description:s.target.value}),className:"input",rows:"3",placeholder:"Optional description"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"isActive",checked:i.isActive,onChange:s=>l({...i,isActive:s.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"isActive",className:"ml-2 block text-sm text-gray-700",children:"Active"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:p,className:"btn btn-secondary",disabled:r,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:r,children:r?"Saving...":n?"Update City":"Add City"})]})]})]})})})},pe=()=>{var w,C,S,A,k;const[n,g]=h.useState(""),[p,r]=h.useState(!1),[i,l]=h.useState(null),[x,s]=h.useState("all"),L={search:n,isActive:x==="all"?void 0:x==="active"?"true":"false"},{data:t,isLoading:y,error:m,refetch:b}=_(L,{refetchOnMountOrArgChange:!0}),[T,{isLoading:B}]=$(),[P,{isLoading:E}]=X(),[D,{isLoading:ie}]=Y(),{confirmation:j,confirmDelete:G,handleConfirm:z,handleCancel:I}=Z(),R=a=>{i?P({id:i._id,...a}).unwrap().then(()=>{u.success("City updated successfully"),r(!1),l(null)}).catch(c=>{var d;u.error(((d=c==null?void 0:c.data)==null?void 0:d.message)||"Failed to update city")}):T(a).unwrap().then(()=>{u.success("City created successfully"),r(!1),l(null)}).catch(c=>{var d;u.error(((d=c==null?void 0:c.data)==null?void 0:d.message)||"Failed to create city")})},F=a=>{l(a),r(!0)},O=a=>{const c=a.name||"this city";G(c,"city",async()=>{var d;try{await D(a._id).unwrap(),u.success("City deleted successfully")}catch(f){u.error(((d=f==null?void 0:f.data)==null?void 0:d.message)||"Failed to delete city")}})},U=()=>{l(null),r(!0)},v=((w=t==null?void 0:t.data)==null?void 0:w.cities)||(t==null?void 0:t.cities)||(t==null?void 0:t.items)||[],o=((C=t==null?void 0:t.data)==null?void 0:C.pagination)||(t==null?void 0:t.pagination)||(t==null?void 0:t.meta)||{};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Cities"}),e.jsx("p",{className:"text-gray-600",children:"Manage cities for customer and supplier addresses"})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsxs("button",{onClick:U,className:"btn btn-primary btn-md w-full sm:w-auto",children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"Add New City"]})})]}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-[3] relative",children:[e.jsx(K,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search cities...",value:n,onChange:a=>g(a.target.value),className:"input pl-10 w-full"})]}),e.jsx("div",{className:"flex-1",children:e.jsxs("select",{value:x,onChange:a=>s(a.target.value),className:"input w-full",children:[e.jsx("option",{value:"all",children:"All Cities"}),e.jsx("option",{value:"active",children:"Active Only"}),e.jsx("option",{value:"inactive",children:"Inactive Only"})]})}),e.jsx("div",{className:"flex-shrink-0",children:e.jsxs("button",{onClick:()=>b(),className:"btn btn-secondary btn-md",disabled:y,children:[e.jsx(N,{className:`h-4 w-4 mr-2 ${y?"animate-spin":""}`}),"Refresh"]})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:y?e.jsx(q,{}):m?e.jsxs("div",{className:"p-6 text-center text-red-600",children:[e.jsxs("p",{children:["Error loading cities: ",((S=m==null?void 0:m.data)==null?void 0:S.message)||(m==null?void 0:m.message)]}),e.jsxs("button",{onClick:()=>b(),className:"mt-4 btn btn-secondary btn-sm",children:[e.jsx(N,{className:"h-4 w-4 mr-2"}),"Retry"]})]}):v.length===0?e.jsxs("div",{className:"p-6 text-center text-gray-500",children:[e.jsx("p",{children:"No cities found. Add your first city to get started."}),e.jsxs("p",{className:"text-sm mt-2",children:["Total in database: ",o.total||0]}),e.jsxs("button",{onClick:()=>b(),className:"mt-4 btn btn-secondary btn-sm",children:[e.jsx(N,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"City Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"State"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Country"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:v.map(a=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(V,{className:"h-5 w-5 text-gray-400 mr-2"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:a.name})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:a.state||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:a.country||"US"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${a.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:a.isActive?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:a.description||"-"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsx("button",{onClick:()=>F(a),className:"text-blue-600 hover:text-blue-900 mr-4",children:e.jsx(ee,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>O(a),className:"text-red-600 hover:text-red-900",children:e.jsx(ae,{className:"h-4 w-4"})})]})]},a._id))})]})})}),o.pages>1&&e.jsx("div",{className:"flex items-center justify-between bg-white px-4 py-3 rounded-lg shadow",children:e.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",(o.page-1)*o.limit+1," to"," ",Math.min(o.page*o.limit,o.total)," of"," ",o.total," cities"]})}),p&&e.jsx(se,{city:i,onSave:R,onCancel:()=>{r(!1),l(null)},isSubmitting:B||E}),e.jsx(Q,{isOpen:j.isOpen,onClose:I,onConfirm:z,itemName:((k=(A=j.message)==null?void 0:A.match(/"([^"]*)"/))==null?void 0:k[1])||"this city",itemType:"city",isLoading:j.isLoading})]})};export{pe as Cities,pe as default};
