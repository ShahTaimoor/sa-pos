import{r as x}from"./index-DaTQeIrM.js";const z=(r,s)=>{const n=(r||"").toLowerCase(),o=(s||"").toLowerCase();if(n===o)return 0;if(n.length===0)return o.length;if(o.length===0)return n.length;const l=[];for(let e=0;e<=o.length;e++)l[e]=[e];for(let e=0;e<=n.length;e++)l[0][e]=e;for(let e=1;e<=o.length;e++)for(let a=1;a<=n.length;a++)o.charAt(e-1)===n.charAt(a-1)?l[e][a]=l[e-1][a-1]:l[e][a]=Math.min(l[e-1][a-1]+1,l[e][a-1]+1,l[e-1][a]+1);return l[o.length][n.length]},M=(r,s,n={})=>{const{threshold:o=.6,caseSensitive:l=!1,wholeWords:e=!1,maxDistance:a=3}=n;if(!r||!s)return{matched:!1,score:0,type:"none"};const i=l?r:r.toLowerCase(),f=l?s:s.toLowerCase();if(i===f)return{matched:!0,score:1,type:"exact"};if(i.includes(f))return{matched:!0,score:.8+f.length/i.length*.2,type:"contains"};if(e){const t=i.split(/\s+/);for(const c of t)if(c===f||c.startsWith(f))return{matched:!0,score:.9,type:"word"}}const p=z(r,s),u=Math.max(r.length,s.length),d=u>0?1-p/u:0;if(p<=a&&d>=o)return{matched:!0,score:d,type:"fuzzy"};const g=f.split(/\s+/).filter(t=>t.length>2);if(g.length>0){let t=0,c=0;for(const h of g)if(i.includes(h))t++,c+=.7;else{const w=i.split(/\s+/);for(const y of w)if(z(y,h)<=2&&y.length>=h.length-2){t++,c+=.5;break}}if(t>0)return{matched:!0,score:c/g.length,type:"partial"}}return{matched:!1,score:0,type:"none"}},L=(r,s,n,o={})=>{if(!r||!Array.isArray(r)||r.length===0)return[];if(!s||s.trim().length===0)return r;const{threshold:l=.4,limit:e=null,minScore:a=.3,caseSensitive:i=!1}=o,f=s.trim(),p=[];let u=[];typeof n=="string"?u=[t=>S(t,n)]:Array.isArray(n)?u=n.map(t=>typeof t=="function"?t:c=>S(c,t)):typeof n=="function"?u=[n]:u=[t=>t.name||t.title||t.companyName||t.businessName||"",t=>t.description||"",t=>t.email||"",t=>t.phone||"",t=>t.code||t.sku||t.poNumber||t.orderNumber||""];for(const t of r){let c=0,h=null;for(const w of u)try{const y=w(t);if(y==null)continue;const A=Array.isArray(y)?y.join(" "):String(y),m=M(A,f,{threshold:l,caseSensitive:i});m.matched&&m.score>c&&(c=m.score,h=m)}catch{}h&&c>=a&&p.push({item:t,score:c,matchType:h.type})}const d={exact:4,contains:3,word:2,fuzzy:1,partial:0};p.sort((t,c)=>Math.abs(t.score-c.score)>.01?c.score-t.score:d[c.matchType]-d[t.matchType]);const g=p.map(t=>t.item);return e?g.slice(0,e):g},S=(r,s)=>{if(!r||!s)return"";const n=s.split(".");let o=r;for(const l of n){if(o==null)return"";o=o[l]}return o!=null?String(o):""},W=(r,s,n,o={})=>x.useMemo(()=>!r||!Array.isArray(r)?[]:!s||s.trim().length===0?r:L(r,s,n,o),[r,s,n,o]);export{W as u};
