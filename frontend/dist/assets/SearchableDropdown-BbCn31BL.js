import{r as n,p as s,S as q,R as N}from"./index-QHzcgHe1.js";import{C as G}from"./chevron-down-oX_1uWoZ.js";import{C as H}from"./check-CWpXnlSq.js";const X=n.forwardRef(({placeholder:I="Search...",items:m=[],onSelect:T,onSearch:C,onKeyDown:D,displayKey:f="name",valueKey:S="_id",selectedItem:h=null,loading:A=!1,emptyMessage:$="No items found",className:j="",disabled:O=!1,showSelected:R=!0,value:o=null},b)=>{var L;const[d,p]=n.useState(!1),[x,g]=n.useState(""),[a,i]=n.useState(-1),[c,V]=n.useState(m),y=n.useRef(null),E=n.useRef(null),k=n.useRef([]),u=e=>{if(e==null)return"";if(typeof e=="string")return e;if(typeof e=="number")return`${e}`;if(typeof e=="boolean")return e?"Yes":"No";if(Array.isArray(e)){const r=e.find(t=>t!=null);return u(r)}if(typeof e=="object"){if(N.isValidElement(e))return"";const r=["label","name","displayName","businessName","companyName","accountName","bankName","type","title","code","id","_id"];for(const t of r)if(t in e){const l=u(e[t]);if(l)return l}}try{return JSON.stringify(e)}catch{return""}},z=e=>{if(!e)return"";if(typeof f=="function"){const r=f(e);return N.isValidElement(r)?[e.displayName,e.name,e.businessName,e.companyName,e.accountName,e.bankName,e.code,e.id,e._id].find(l=>typeof l=="string"&&l.trim().length>0)||"Selected item":u(r)}return u(e[f])};n.useEffect(()=>{o!==null&&(g(o),o===""&&(p(!1),i(-1)))},[o]),n.useEffect(()=>{const e=o!==null?o:x;if(e){const r=m.filter(t=>{if(typeof f=="function")return[t.displayName,t.name,t.businessName,t.companyName,t.email,t.phone].filter(Boolean).some(Y=>Y.toLowerCase().includes(e.toLowerCase()));const l=u(t[f]);return l?l.toLowerCase().includes(e.toLowerCase()):!1});V(r)}else V(m);i(-1)},[o,x,m,f]);const _=e=>{C&&C(e),o===null&&g(e)},w=e=>{T(e),R||g(""),p(!1),i(-1)},P=e=>{var r;if(D&&D(e),!e.defaultPrevented){if(!d){if(e.key==="ArrowDown"||e.key==="Enter"){e.preventDefault(),p(!0),i(0);return}if(e.key==="Tab"&&x&&c.length>0){w(c[0]);return}return}switch(e.key){case"ArrowDown":e.preventDefault(),i(t=>t<c.length-1?t+1:0);break;case"ArrowUp":e.preventDefault(),i(t=>t>0?t-1:c.length-1);break;case"Enter":e.preventDefault(),a>=0&&a<c.length&&w(c[a]);break;case"Tab":a>=0&&a<c.length&&w(c[a]);break;case"Escape":e.preventDefault(),p(!1),i(-1),g(""),(r=y.current)==null||r.blur();break}}};n.useEffect(()=>{a>=0&&k.current[a]&&k.current[a].scrollIntoView({block:"nearest",behavior:"smooth"})},[a]),n.useEffect(()=>{const e=r=>{E.current&&!E.current.contains(r.target)&&(p(!1),i(-1))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),n.useEffect(()=>{d&&y.current&&y.current.focus()},[d]);const B=e=>{if(!e)return"";if(typeof f=="function"){const t=f(e);return N.isValidElement(t)?t:u(t)||""}const r=e[f];return N.isValidElement(r)?r:u(r)||""},J=()=>o!==null?o:d?x:R&&h?z(h):"",U=j.includes("pr-");return s.jsxs("div",{className:`relative ${j.replace(/pr-\d+/g,"").trim()}`,ref:E,children:[s.jsxs("div",{className:"relative",children:[s.jsx(q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 z-10"}),s.jsx("input",{ref:e=>{y.current=e,b&&(typeof b=="function"?b(e):b.current=e)},type:"text",placeholder:I,value:J(),onChange:e=>_(e.target.value),onKeyDown:P,onFocus:()=>p(!0),disabled:O,className:`input pl-10 ${U&&((L=j.match(/pr-\d+/))==null?void 0:L[0])||"pr-10"} w-full`}),s.jsx(G,{className:`absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 transition-transform z-10 ${d?"rotate-180":""}`})]}),d&&s.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:A?s.jsxs("div",{className:"p-3 text-center text-gray-500",children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary-600 mx-auto"}),s.jsx("p",{className:"mt-2 text-sm",children:"Loading..."})]}):c.length>0?s.jsx("div",{className:"py-1",children:c.map((e,r)=>{const t=a===r,l=h&&h[S]===e[S];return s.jsxs("button",{ref:F=>k.current[r]=F,type:"button",onClick:()=>w(e),className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 focus:bg-gray-50 focus:outline-none flex items-center justify-between ${t?"bg-primary-50 text-primary-700":"text-gray-900"}`,children:[B(e),l&&s.jsx(H,{className:"h-4 w-4 text-primary-600"})]},e[S])})}):s.jsx("div",{className:"p-3 text-center text-gray-500 text-sm",children:$})})]})});export{X as S};
