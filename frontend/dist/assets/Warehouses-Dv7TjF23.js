import{D as N,r as y,R as I,p as e,ao as q,aV as T,S as V,Q as E,aU as W,O as j,av as _,X as $,ae as S,U as B,ad as H,L as Q}from"./index-QHzcgHe1.js";import{u as Z,a as G,b as X,c as J}from"./warehousesApi-Br2SOI6X.js";import{a as K}from"./useConfirmation-BFyzFbUJ.js";import{P as A}from"./plus-wthIFHeq.js";import{C as Y}from"./check-circle-pdbRLUjc.js";import{P as R}from"./pen-square-D_ZZfkE6.js";import{T as ee}from"./trash-2-G7GOGhVq.js";import{P as se}from"./phone-DmhyAe7y.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=N("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=N("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=N("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=N("StickyNote",[["path",{d:"M15.5 3H5a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h14a2 2 0 0 0 2-2V8.5L15.5 3Z",key:"1wis1t"}],["path",{d:"M15 3v6h6",key:"edgan2"}]]),u={name:"",code:"",description:"",address:{line1:"",line2:"",city:"",state:"",postalCode:"",country:""},contact:{name:"",phone:"",email:""},capacity:"",isPrimary:!1,isActive:!0,notes:""},ie=d=>{var h,p,i,m;const a={...d};if(a.code=(h=a.code)==null?void 0:h.trim().toUpperCase(),a.name=(p=a.name)==null?void 0:p.trim(),a.description=((i=a.description)==null?void 0:i.trim())||void 0,a.notes=((m=a.notes)==null?void 0:m.trim())||void 0,a.capacity===""||a.capacity===null?delete a.capacity:a.capacity=Number(a.capacity),a.address){const x=Object.fromEntries(Object.entries(a.address).map(([t,o])=>[t,(o==null?void 0:o.trim())||void 0]));Object.values(x).every(t=>!t)?delete a.address:a.address=x}if(a.contact){const x=Object.fromEntries(Object.entries(a.contact).map(([t,o])=>[t,(o==null?void 0:o.trim())||void 0]));Object.values(x).every(t=>!t)?delete a.contact:a.contact=x}return a},re=({warehouse:d,onSave:a,onCancel:h,isSubmitting:p})=>{var g;const{register:i,handleSubmit:m,reset:x,formState:{errors:t}}=_({defaultValues:u});y.useEffect(()=>{x(d?{...u,...d,capacity:d.capacity??"",address:{...u.address,...d.address||{}},contact:{...u.contact,...d.contact||{}}}:u)},[d,x]);const o=l=>{const b=ie(l);a(b)};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 p-4",children:e.jsxs("div",{className:"w-full max-w-4xl rounded-xl bg-white shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between border-b p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(W,{className:"h-6 w-6 text-primary-600"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:d?"Edit Warehouse":"Add Warehouse"})]}),e.jsx("button",{type:"button",onClick:h,className:"text-gray-400 transition hover:text-gray-600",children:e.jsx($,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:m(o),className:"max-h-[75vh] overflow-y-auto p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"form-label flex items-center space-x-2",children:[e.jsx(te,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{children:"Name *"})]}),e.jsx("input",{...i("name",{required:"Warehouse name is required"}),className:"input",placeholder:"Main Warehouse"}),t.name&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.name.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"form-label flex items-center space-x-2",children:[e.jsx(ce,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{children:"Code *"})]}),e.jsx("input",{...i("code",{required:"Warehouse code is required",maxLength:{value:50,message:"Maximum 50 characters"}}),className:"input uppercase",placeholder:"MAIN"}),t.code&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.code.message})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"form-label flex items-center space-x-2",children:[e.jsx(le,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{children:"Description"})]}),e.jsx("textarea",{...i("description",{maxLength:{value:500,message:"Max 500 characters"}}),className:"input",rows:3,placeholder:"Short description about warehouse purpose or coverage"}),t.description&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.description.message})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"form-label flex items-center space-x-2",children:[e.jsx(S,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{children:"Address Line 1"})]}),e.jsx("input",{...i("address.line1"),className:"input",placeholder:"Street, number..."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"form-label flex items-center space-x-2",children:[e.jsx(S,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{children:"Address Line 2"})]}),e.jsx("input",{...i("address.line2"),className:"input",placeholder:"Suite, building..."})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"City"}),e.jsx("input",{...i("address.city"),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"State/Province"}),e.jsx("input",{...i("address.state"),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Postal Code"}),e.jsx("input",{...i("address.postalCode"),className:"input"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"form-label flex items-center space-x-2",children:[e.jsx(ae,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{children:"Country"})]}),e.jsx("input",{...i("address.country"),className:"input"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"form-label flex items-center space-x-2",children:[e.jsx(B,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{children:"Contact Person"})]}),e.jsx("input",{...i("contact.name"),className:"input",placeholder:"Person in charge"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"form-label flex items-center space-x-2",children:[e.jsx(se,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{children:"Phone"})]}),e.jsx("input",{...i("contact.phone"),className:"input",placeholder:"+1 555 123 4567"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"form-label flex items-center space-x-2",children:[e.jsx(H,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{children:"Email"})]}),e.jsx("input",{...i("contact.email",{pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Please enter a valid email address"}}),className:"input",placeholder:"contact@example.com"}),((g=t.contact)==null?void 0:g.email)&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.contact.email.message})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Storage Capacity (optional)"}),e.jsx("input",{type:"number",min:"0",step:"1",...i("capacity",{min:{value:0,message:"Capacity must be zero or higher"}}),className:"input",placeholder:"Units or pallets"}),t.capacity&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.capacity.message})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",...i("isPrimary"),className:"checkbox"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Primary Warehouse"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Marks this warehouse as default for new inventory records."})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",...i("isActive"),className:"checkbox"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Active"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Inactive warehouses will be hidden from selection lists."})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Notes"}),e.jsx("textarea",{...i("notes"),className:"input",rows:3,placeholder:"Internal notes or handling instructions"})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-3 border-t pt-4",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:h,disabled:p,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:p,children:p?e.jsx(Q,{}):e.jsxs("span",{className:"flex items-center space-x-2",children:[e.jsx(A,{className:"h-4 w-4"}),e.jsx("span",{children:d?"Update Warehouse":"Create Warehouse"})]})})]})]})]})})},ue=()=>{const[d,a]=y.useState(""),[h,p]=y.useState(!1),[i,m]=y.useState(!1),[x,t]=y.useState(null),{confirmDelete:o,deleteDialog:g}=K(),{data:l,isLoading:b,error:v,isFetching:P,refetch:w}=Z({search:d||void 0,isActive:h?"true":void 0,limit:100}),f=I.useMemo(()=>{var s,r,c,n;return l?(r=(s=l==null?void 0:l.data)==null?void 0:s.data)!=null&&r.items?l.data.data.items:(c=l==null?void 0:l.data)!=null&&c.items?l.data.items:(n=l==null?void 0:l.data)!=null&&n.warehouses?l.data.warehouses:l!=null&&l.warehouses?l.warehouses:Array.isArray(l)?l:[]:[]},[l]),[L]=G(),[M]=X(),[O]=J(),U=async s=>{var r;try{x?(await M({id:x._id,...s}).unwrap(),j.success("Warehouse updated successfully")):(await L(s).unwrap(),j.success("Warehouse created successfully")),m(!1),t(null),w()}catch(c){const n=((r=c==null?void 0:c.data)==null?void 0:r.message)||(c==null?void 0:c.message)||"Unable to save warehouse";j.error(n)}},z=()=>{t(null),m(!0)},k=s=>{t(s),m(!0)},C=async s=>{var c;if(await o(`Are you sure you want to delete "${s.name}" warehouse? This action cannot be undone.`))try{await O(s._id).unwrap(),j.success("Warehouse deleted successfully"),w()}catch(n){const F=((c=n==null?void 0:n.data)==null?void 0:c.message)||(n==null?void 0:n.message)||"Unable to delete warehouse";j.error(F)}},D=!1;return b?e.jsx(q,{message:"Loading warehouses..."}):v?e.jsx("div",{className:"space-y-4",children:e.jsx(T,{title:"Failed to load warehouses",children:e.jsx("p",{className:"text-sm text-red-500",children:v.message||"Something went wrong while fetching warehouses."})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col items-start justify-between gap-4 sm:flex-row sm:items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Warehouses"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage warehouse locations, contacts, capacity, and availability."})]}),e.jsxs("button",{onClick:z,className:"btn btn-primary flex items-center space-x-2",children:[e.jsx(A,{className:"h-4 w-4"}),e.jsx("span",{children:"Add Warehouse"})]})]}),e.jsx("div",{className:"rounded-lg bg-white p-4 shadow",children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(V,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"}),e.jsx("input",{value:d,onChange:s=>a(s.target.value),placeholder:"Search by name or code...",className:"input pl-9"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:h,onChange:s=>p(s.target.checked),className:"checkbox"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Show active only"})]})}),P&&e.jsxs("div",{className:"flex items-end justify-end text-xs text-gray-500",children:[e.jsx(E,{className:"mr-2 h-4 w-4"}),"Refreshing..."]})]})}),e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white shadow",children:[e.jsx("div",{className:"hidden md:block",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider text-gray-500",children:"Warehouse"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider text-gray-500",children:"Location"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider text-gray-500",children:"Contact"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold uppercase tracking-wider text-gray-500",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold uppercase tracking-wider text-gray-500",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:f.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-10 text-center text-sm text-gray-500",children:"No warehouses found. Click “Add Warehouse” to create the first one."})}):f.map(s=>{const r=s.address||{},c=s.contact||{},n=[r.city,r.state,r.country].filter(Boolean).join(", ");return e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-primary-50 text-primary-600",children:e.jsx(W,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:s.name}),s.isPrimary&&e.jsxs("span",{className:"inline-flex items-center rounded-full bg-green-100 px-2 py-0.5 text-xs font-medium text-green-800",children:[e.jsx(Y,{className:"mr-1 h-3 w-3"}),"Primary"]})]}),e.jsxs("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:["Code: ",s.code]})]})]})}),e.jsx("td",{className:"px-4 py-4 text-sm text-gray-700",children:n||r.line1||"—"}),e.jsx("td",{className:"px-4 py-4 text-sm text-gray-700",children:c.name?e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-medium text-gray-900",children:c.name}),e.jsx("p",{className:"text-xs text-gray-500",children:c.phone||"No phone"}),e.jsx("p",{className:"text-xs text-gray-500",children:c.email||"No email"})]}):e.jsx("span",{className:"text-gray-400",children:"No contact"})}),e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsx("span",{className:`inline-flex rounded-full px-2 py-1 text-xs font-semibold ${s.isActive?"bg-green-100 text-green-800":"bg-gray-200 text-gray-600"}`,children:s.isActive?"Active":"Inactive"})}),e.jsx("td",{className:"px-4 py-4 text-right text-sm font-medium",children:e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{onClick:()=>k(s),className:"rounded-md p-2 text-blue-600 transition hover:bg-blue-50",children:e.jsx(R,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>C(s),className:"rounded-md p-2 text-red-600 transition hover:bg-red-50",children:e.jsx(ee,{className:"h-4 w-4"})})]})})]},s._id)})})]})}),e.jsx("div",{className:"space-y-3 p-4 md:hidden",children:f.length===0?e.jsx("div",{className:"rounded-lg border border-dashed border-gray-300 p-6 text-center text-sm text-gray-500",children:"No warehouses found. Tap “Add Warehouse” to create one."}):f.map(s=>{const r=s.address||{},c=s.contact||{},n=[r.city,r.state,r.country].filter(Boolean).join(", ");return e.jsxs("div",{className:"rounded-lg border border-gray-200 p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.name}),s.isPrimary&&e.jsx("span",{className:"inline-flex items-center rounded-full bg-green-100 px-2 py-0.5 text-xs font-medium text-green-800",children:"Primary"})]}),e.jsxs("p",{className:"text-xs uppercase text-gray-500",children:["Code: ",s.code]})]}),e.jsx("span",{className:`inline-flex rounded-full px-2 py-1 text-xs font-semibold ${s.isActive?"bg-green-100 text-green-800":"bg-gray-200 text-gray-600"}`,children:s.isActive?"Active":"Inactive"})]}),e.jsxs("div",{className:"mt-3 space-y-2 text-sm text-gray-600",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Location:"})," ",n||r.line1||"—"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Contact:"})," ",c.name||"Not assigned"]}),c.phone&&e.jsxs("p",{children:["Phone: ",c.phone]}),c.email&&e.jsxs("p",{children:["Email: ",c.email]})]}),e.jsxs("div",{className:"mt-4 flex space-x-2",children:[e.jsx("button",{onClick:()=>k(s),className:"btn btn-secondary flex-1",children:"Edit"}),e.jsx("button",{onClick:()=>C(s),className:"btn btn-danger flex-1",children:"Delete"})]})]},s._id)})})]}),i&&e.jsx(re,{warehouse:x,onSave:U,onCancel:()=>{m(!1),t(null)},isSubmitting:D}),g]})};export{ue as default};
