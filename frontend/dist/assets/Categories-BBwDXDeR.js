import{D as H,r as p,bT as G,an as Q,bU as W,bV as Y,bW as Z,p as e,ao as J,S as K,ak as X,O as x,R as ee,L as se}from"./index-QHzcgHe1.js";import{D as ae}from"./ConfirmationDialog-CpWps3pF.js";import{a as te}from"./useConfirmation-BFyzFbUJ.js";import{P as re}from"./pen-square-D_ZZfkE6.js";import{T as ne}from"./trash-2-G7GOGhVq.js";import"./check-circle-pdbRLUjc.js";import"./info-L9xTXcgi.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=H("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=H("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]),le=({category:t,isOpen:N,onClose:y,onSave:i,isSubmitting:c,categories:d=[],categoryType:h="parent"})=>{const[n,g]=p.useState({name:"",description:"",parentCategory:"",sortOrder:0,isActive:!0}),[r,u]=p.useState({});ee.useEffect(()=>{var a;g(t?{name:t.name||"",description:t.description||"",parentCategory:((a=t.parentCategory)==null?void 0:a._id)||"",sortOrder:t.sortOrder||0,isActive:t.isActive!==void 0?t.isActive:!0}:{name:"",description:"",parentCategory:"",sortOrder:0,isActive:!0}),u({})},[t,N]);const o=a=>{const{name:b,value:w,type:k,checked:D}=a.target;g(f=>({...f,[b]:k==="checkbox"?D:w})),r[b]&&u(f=>({...f,[b]:null}))},m=()=>{const a={};return n.name.trim()||(a.name="Category name is required"),!t&&h==="child"&&!n.parentCategory&&(a.parentCategory="Parent category is required for child categories"),u(a),Object.keys(a).length===0},C=a=>{a.preventDefault(),m()&&(i(n),y())};return N?e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75",onClick:y}),e.jsx("div",{className:"relative inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all w-full max-w-lg max-h-[90vh] flex flex-col",children:e.jsxs("form",{onSubmit:C,className:"flex flex-col h-full",children:[e.jsxs("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4 overflow-y-auto flex-1",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:t?"Edit Category":h==="parent"?"Add New Parent Category":"Add New Child Category"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Category Name"}),e.jsx("input",{id:"name",name:"name",type:"text",value:n.name,onChange:o,placeholder:"Enter category name",className:`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 ${r.name?"border-red-300":"border-gray-300"}`,autoComplete:"off"}),r.name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.name})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{id:"description",name:"description",value:n.description,onChange:o,placeholder:"Enter category description",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Optional description of the category"})]}),!t&&h==="child"&&e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"parentCategory",className:"block text-sm font-medium text-gray-700 mb-1",children:["Parent Category ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{id:"parentCategory",name:"parentCategory",value:n.parentCategory,onChange:o,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"",children:"Select a parent category"}),d.filter(a=>!a.parentCategory).map(a=>e.jsx("option",{value:a._id,children:a.name},a._id))]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Select the parent category for this subcategory"}),r.parentCategory&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.parentCategory})]}),!t&&h==="parent"&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"parentCategory",className:"block text-sm font-medium text-gray-700 mb-1",children:"Parent Category"}),e.jsx("input",{type:"text",value:"No parent (Top level category)",disabled:!0,className:"w-full px-3 py-2 border border-gray-200 rounded-md shadow-sm bg-gray-50 text-gray-500"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"This will be a top-level parent category"})]}),t&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"parentCategory",className:"block text-sm font-medium text-gray-700 mb-1",children:"Parent Category"}),e.jsxs("select",{id:"parentCategory",name:"parentCategory",value:n.parentCategory,onChange:o,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"",children:"No parent category (Top level)"}),d.filter(a=>!t||a._id!==t._id).map(a=>e.jsx("option",{value:a._id,children:a.name},a._id))]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Optional parent category for hierarchical organization"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sortOrder",className:"block text-sm font-medium text-gray-700 mb-1",children:"Sort Order"}),e.jsx("input",{id:"sortOrder",name:"sortOrder",type:"number",min:"0",value:n.sortOrder,onChange:o,placeholder:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Display order (lower numbers first)"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"isActive",name:"isActive",type:"checkbox",checked:n.isActive,onChange:o,className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"isActive",className:"ml-2 block text-sm text-gray-900",children:"Active"})]})]})]})]}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse flex-shrink-0",children:[e.jsx(se,{type:"submit",isLoading:c,disabled:!n.name||c,className:"btn btn-primary btn-md w-full sm:w-auto sm:ml-3 disabled:opacity-50 disabled:cursor-not-allowed",children:t?"Update Category":"Create Category"}),e.jsx("button",{type:"button",onClick:y,disabled:c,className:"btn btn-secondary btn-md w-full sm:w-auto mt-3 sm:mt-0 disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"})]})]})})]})}):null},he=()=>{var E,P,T,L,M;const[t,N]=p.useState(""),[y,i]=p.useState(!1),[c,d]=p.useState(null),[h,n]=p.useState("parent"),[g]=G();p.useEffect(()=>{if(g.get("action")==="add"){i(!0);const s=new URL(window.location);s.searchParams.delete("action"),window.history.replaceState({},"",s)}},[g]);const{data:r,isLoading:u,error:o,refetch:m}=Q({search:t},{refetchOnMountOrArgChange:!0}),[C,{isLoading:a}]=W(),[b,{isLoading:w}]=Y(),[k,{isLoading:D}]=Z(),f=s=>{d(s),i(!0)},{confirmation:O,confirmDelete:I,handleConfirm:U,handleCancel:V}=te(),z=s=>{I(s.name,"Category",async()=>{var j;try{await k(s._id).unwrap(),x.success("Category deleted successfully"),m()}catch(l){x.error(((j=l==null?void 0:l.data)==null?void 0:j.message)||"Failed to delete category")}})},$=s=>{const j={...s,parentCategory:s.parentCategory===""?void 0:s.parentCategory,sortOrder:parseInt(s.sortOrder)||0,isActive:!!s.isActive};c?b({id:c._id,...j}).unwrap().then(()=>{x.success("Category updated successfully"),i(!1),d(null),m()}).catch(l=>{var v;x.error(((v=l==null?void 0:l.data)==null?void 0:v.message)||"Failed to update category")}):C(j).unwrap().then(()=>{x.success("Category created successfully"),i(!1),d(null),m()}).catch(l=>{var _,R;const v=(_=l==null?void 0:l.data)==null?void 0:_.errors;v?x.error(`Validation failed: ${Object.values(v).join(", ")}`):x.error(((R=l==null?void 0:l.data)==null?void 0:R.message)||"Failed to create category")})},B=()=>{i(!1),d(null),n("parent")};if(u)return e.jsx(J,{});if(o)return e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-danger-600",children:"Failed to load categories"})});const A=(r==null?void 0:r.categories)||((E=r==null?void 0:r.data)==null?void 0:E.categories)||[],S=(r==null?void 0:r.pagination)||((P=r==null?void 0:r.data)==null?void 0:P.pagination)||{};return e.jsxs("div",{className:"space-y-6 w-full",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Categories"}),e.jsx("p",{className:"text-gray-600",children:"Manage your product categories"})]}),e.jsxs("div",{className:"flex-shrink-0 flex flex-col sm:flex-row gap-3",children:[e.jsxs("button",{onClick:()=>{d(null),n("parent"),i(!0)},className:"btn btn-primary btn-lg w-full sm:w-auto shadow-lg hover:shadow-xl transition-shadow",children:[e.jsx(F,{className:"h-5 w-5 mr-2"}),"Add Parent Category"]}),e.jsxs("button",{onClick:()=>{d(null),n("child"),i(!0)},className:"btn btn-outline btn-lg w-full sm:w-auto shadow-lg hover:shadow-xl transition-shadow",children:[e.jsx(q,{className:"h-5 w-5 mr-2"}),"Add Child Category"]})]})]})}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(K,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search categories...",value:t,onChange:s=>N(s.target.value),className:"input pl-10"})]})}),u?e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading categories..."})]}):o?e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[e.jsxs("p",{className:"text-red-600",children:["Error loading categories: ",o.message]}),e.jsx("button",{onClick:()=>m(),className:"mt-4 btn btn-secondary btn-sm",children:"Retry"})]}):A.length===0?e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[e.jsx(X,{className:"mx-auto h-16 w-16 text-gray-400"}),e.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"No categories found"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:t?"Try adjusting your search terms.":"Get started by adding your first category."}),e.jsxs("p",{className:"mt-2 text-xs text-gray-400",children:["Total in database: ",(S==null?void 0:S.total)||0]}),e.jsx("button",{onClick:()=>m(),className:"mt-4 btn btn-secondary btn-sm",children:"Refresh"}),!t&&e.jsxs("div",{className:"mt-6",children:[e.jsxs("button",{onClick:()=>{n("parent"),i(!0)},className:"btn btn-primary btn-lg shadow-lg hover:shadow-xl transition-shadow",children:[e.jsx(F,{className:"h-5 w-5 mr-2"}),"Add Your First Parent Category"]}),e.jsx("p",{className:"mt-3 text-xs text-gray-400",children:'ðŸ’¡ Tip: Start with parent categories (like "Electronics"), then add subcategories'})]})]}):e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"bg-gray-50 px-6 py-3 border-b border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-12 gap-4 text-xs font-medium text-gray-500 uppercase tracking-wider",children:[e.jsx("div",{className:"col-span-1",children:"Type"}),e.jsx("div",{className:"col-span-4",children:"Category Name"}),e.jsx("div",{className:"col-span-3",children:"Description"}),e.jsx("div",{className:"col-span-1",children:"Parent"}),e.jsx("div",{className:"col-span-1",children:"Sort"}),e.jsx("div",{className:"col-span-1",children:"Status"}),e.jsx("div",{className:"col-span-1",children:"Actions"})]})}),e.jsx("div",{className:"divide-y divide-gray-200",children:A.map(s=>e.jsx("div",{className:"px-6 py-4 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"grid grid-cols-12 gap-4 items-center",children:[e.jsx("div",{className:"col-span-1",children:s.parentCategory?e.jsx(q,{className:"h-5 w-5 text-gray-400"}):e.jsx(F,{className:"h-5 w-5 text-primary-600"})}),e.jsx("div",{className:"col-span-4",children:e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("h3",{className:"text-sm font-medium text-gray-900 truncate",children:s.name})})}),e.jsx("div",{className:"col-span-3",children:e.jsx("p",{className:"text-sm text-gray-600 truncate",children:s.description||"-"})}),e.jsx("div",{className:"col-span-1",children:e.jsx("span",{className:"text-xs text-gray-500",children:s.parentCategory?s.parentCategory.name:"-"})}),e.jsx("div",{className:"col-span-1",children:e.jsx("span",{className:"text-xs text-gray-500",children:s.sortOrder})}),e.jsx("div",{className:"col-span-1",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${s.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:s.isActive?"Active":"Inactive"})}),e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>f(s),className:"text-primary-600 hover:text-primary-800 p-1",title:"Edit category",children:e.jsx(re,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>z(s),className:"text-danger-600 hover:text-danger-800 p-1",title:"Delete category",children:e.jsx(ne,{className:"h-4 w-4"})})]})})]})},s._id))})]}),e.jsx(le,{category:c,isOpen:y,onClose:B,onSave:$,isSubmitting:a||w,categories:A,categoryType:h}),e.jsx(ae,{isOpen:O.isOpen,onClose:V,onConfirm:U,itemName:((L=(T=O.message)==null?void 0:T.match(/"([^"]*)"/))==null?void 0:L[1])||"",itemType:((M=O.message)==null?void 0:M.split(" ")[1])||""})]})};export{he as Categories,he as default};
