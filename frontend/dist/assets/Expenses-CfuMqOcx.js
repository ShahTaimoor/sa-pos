import{D as ne,r as h,bu as xe,bv as he,bw as pe,bx as be,by as ge,bz as ye,p as e,bA as fe,x as re,C as te,q as E,w as M,I as je,aI as X,F as Ne,z as w,B as k,y as C,bn as ve,bB as we,bo as ke,bC as Ce,bD as Ae,bE as Ee,bF as De,bG as Pe,bH as Se,T as Me}from"./index-DaTQeIrM.js";import{u as _e}from"./chartOfAccountsApi-AOutBST3.js";import{u as ce}from"./banksApi-BjGxgmxs.js";import{P as ie}from"./plus-CH9F90nm.js";import{C as Be}from"./check-circle-C7Swk4iC.js";import{E as Le}from"./eye-DQ0qHB88.js";import{P as Fe}from"./printer-sSBWtYCz.js";import{T as $e}from"./trash-2-NO2IJ0Re.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=ne("ArrowLeftRight",[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=ne("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),se={name:"",description:"",amount:"",dayOfMonth:1,reminderDaysBefore:3,defaultPaymentType:"cash",expenseAccount:"",bank:"",notes:"",startFromDate:""},ze=n=>{if(!n)return null;const x=new Date;x.setHours(0,0,0,0);const y=new Date(n);y.setHours(0,0,0,0);const j=y.getTime()-x.getTime();return Math.round(j/(1e3*60*60*24))},Oe=n=>n!=null&&n.supplier?n.supplier.displayName||n.supplier.companyName||n.supplier.businessName||n.supplier.name:n!=null&&n.customer?n.customer.displayName||n.customer.businessName||n.customer.name||[n.customer.firstName,n.customer.lastName].filter(Boolean).join(" "):"General Expense",qe=({expenseAccounts:n=[],onPaymentRecorded:x})=>{const[y,j]=h.useState(!1),[d,p]=h.useState(se),[m,_]=h.useState(7),{data:b,isLoading:R,isFetching:N,refetch:f}=xe({days:m},{pollingInterval:6e4}),{data:B,isLoading:z}=he({status:"active"}),{data:u,isLoading:O}=ce({isActive:!0},{staleTime:5*6e4}),D=s=>{var c,o;return s?Array.isArray(s)?s:Array.isArray(s==null?void 0:s.data)?s.data:Array.isArray(s==null?void 0:s.expenses)?s.expenses:Array.isArray((c=s==null?void 0:s.data)==null?void 0:c.recurringExpenses)?s.data.recurringExpenses:Array.isArray((o=s==null?void 0:s.data)==null?void 0:o.items)?s.data.items:[]:[]},g=h.useMemo(()=>D(b),[b]),L=h.useMemo(()=>D(B),[B]),F=h.useMemo(()=>{var s;return((s=u==null?void 0:u.data)==null?void 0:s.banks)||(u==null?void 0:u.banks)||[]},[u]),P=h.useMemo(()=>Array.isArray(n)?n:[],[n]),v=()=>{p(se)},[q]=pe(),[U]=be(),[G]=ge(),[V]=ye(),Q=async s=>{try{await q(s).unwrap(),k("Recurring expense created"),j(!1),v()}catch(c){C(c,"Create Recurring Expense")}},H=async(s,c)=>{try{const o=await U({id:s,...c}).unwrap();k("Payment recorded successfully"),typeof x=="function"&&x((o==null?void 0:o.data)||o)}catch(o){C(o,"Record Payment")}},I=async s=>{try{await G(s).unwrap(),k("Recurring expense deactivated")}catch(c){C(c,"Deactivate Recurring Expense")}},W=async(s,c)=>{try{await V({id:s,...c}).unwrap(),k("Reminder updated")}catch(o){C(o,"Snooze Recurring Expense")}},Y=s=>{const c=P.find(o=>o._id===s);p(o=>({...o,expenseAccount:s,name:c?c.accountName:""}))},Z=s=>{var o,T;if(s.preventDefault(),!d.expenseAccount){w("Please select an expense account");return}const c={name:d.name.trim(),description:((o=d.description)==null?void 0:o.trim())||void 0,amount:parseFloat(d.amount),dayOfMonth:Number(d.dayOfMonth),reminderDaysBefore:Number(d.reminderDaysBefore),defaultPaymentType:d.defaultPaymentType,expenseAccount:d.expenseAccount||void 0,bank:d.defaultPaymentType==="bank"&&d.bank||void 0,notes:((T=d.notes)==null?void 0:T.trim())||void 0,startFromDate:d.startFromDate||void 0};Q(c)},J=s=>{H(s._id,{paymentType:s.defaultPaymentType,notes:`Recurring payment for ${s.name}`})},$=(s,c=3)=>{W(s._id,{snoozeDays:c})},K=s=>{I(s)};return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center space-x-2",children:[e.jsx(fe,{className:"h-5 w-5 text-primary-600"}),e.jsx("span",{children:"Recurring Expense Reminders"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track monthly obligations and record payments in a single click."})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Show next"}),e.jsxs("select",{value:m,onChange:s=>_(Number(s.target.value)),className:"input w-24",children:[e.jsx("option",{value:3,children:"3 days"}),e.jsx("option",{value:7,children:"7 days"}),e.jsx("option",{value:14,children:"14 days"}),e.jsx("option",{value:30,children:"30 days"})]}),e.jsxs("button",{type:"button",onClick:()=>f(),className:"btn btn-light flex items-center space-x-1",disabled:N,children:[e.jsx(re,{className:`h-4 w-4 ${N?"animate-spin":""}`}),e.jsx("span",{children:"Refresh"})]}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>j(s=>!s),children:y?"Close":"Add Recurring Expense"})]})]}),e.jsxs("div",{className:"card-content space-y-6",children:[y&&e.jsxs("div",{className:"border border-dashed border-primary-200 rounded-lg p-4 bg-primary-50/40",children:[e.jsxs("h3",{className:"text-sm font-semibold text-primary-700 flex items-center space-x-2 mb-3",children:[e.jsx(ie,{className:"h-4 w-4"}),e.jsx("span",{children:"Create Recurring Expense"})]}),e.jsxs("form",{onSubmit:Z,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Expense Account*"}),e.jsxs("select",{className:"input",value:d.expenseAccount,onChange:s=>Y(s.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select expense account"}),P.map(s=>e.jsxs("option",{value:s._id,children:[s.accountName," (",s.accountCode,")"]},s._id))]}),d.name&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Selected: ",d.name]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Amount*"}),e.jsx("input",{type:"number",min:"0",step:"0.01",className:"input",value:d.amount,onChange:s=>p(c=>({...c,amount:s.target.value})),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Due Day of Month*"}),e.jsx("input",{type:"number",min:"1",max:"31",className:"input",value:d.dayOfMonth,onChange:s=>p(c=>({...c,dayOfMonth:Number(s.target.value)})),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Reminder (days before)"}),e.jsx("input",{type:"number",min:"0",max:"31",className:"input",value:d.reminderDaysBefore,onChange:s=>p(c=>({...c,reminderDaysBefore:Number(s.target.value)}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Default Payment Type*"}),e.jsxs("select",{className:"input",value:d.defaultPaymentType,onChange:s=>p(c=>({...c,defaultPaymentType:s.target.value,bank:s.target.value==="bank"?c.bank:""})),children:[e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"bank",children:"Bank"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Start From"}),e.jsx("input",{type:"date",className:"input",value:d.startFromDate,onChange:s=>p(c=>({...c,startFromDate:s.target.value}))})]}),d.defaultPaymentType==="bank"&&e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Bank Account*"}),e.jsxs("select",{className:"input",value:d.bank,onChange:s=>p(c=>({...c,bank:s.target.value})),required:!0,disabled:O,children:[e.jsx("option",{value:"",children:"Select bank account"}),F.map(s=>e.jsxs("option",{value:s._id,children:[s.bankName," • ",s.accountNumber,s.accountName?` (${s.accountName})`:""]},s._id))]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"form-label",children:"Notes"}),e.jsx("textarea",{className:"input",rows:2,value:d.notes,onChange:s=>p(c=>({...c,notes:s.target.value}))})]}),e.jsxs("div",{className:"md:col-span-2 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",className:"btn btn-light",onClick:()=>{j(!1),v()},disabled:!1,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:!d.amount||!d.expenseAccount,children:"Save Recurring Expense"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-700 flex items-center space-x-2",children:[e.jsx(te,{className:"h-4 w-4 text-primary-500"}),e.jsx("span",{children:"Upcoming"})]}),(R||N)&&e.jsx("span",{className:"text-xs text-gray-500",children:"Loading..."})]}),g.length===0?e.jsxs("div",{className:"text-center text-sm text-gray-500 bg-white border border-dashed border-gray-200 rounded-lg py-6",children:[e.jsx(Be,{className:"h-5 w-5 mx-auto text-success-500 mb-2"}),e.jsxs("p",{children:["No reminders due in the next ",m," days."]})]}):e.jsx("div",{className:"space-y-3",children:g.map(s=>{const c=ze(s.nextDueDate),o=typeof c=="number"&&c<0;return e.jsx("div",{className:`rounded-lg border bg-white p-4 shadow-sm ${o?"border-danger-200 bg-danger-50/40":"border-gray-200"}`,children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:s.name}),e.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-primary-100 text-primary-700",children:s.defaultPaymentType==="bank"?"Bank":"Cash"})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[E(s.amount)," • Due ",M(s.nextDueDate)]}),e.jsx("p",{className:"text-xs text-gray-500",children:Oe(s)})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`flex items-center space-x-1 text-sm font-semibold ${o?"text-danger-600":"text-primary-600"}`,children:o?e.jsxs(e.Fragment,{children:[e.jsx(je,{className:"h-4 w-4"}),e.jsxs("span",{children:[Math.abs(c)," day(s) overdue"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"h-4 w-4"}),e.jsxs("span",{children:[c," day(s) left"]})]})}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{type:"button",className:"btn btn-secondary flex items-center space-x-1",onClick:()=>$(s,3),disabled:!1,children:[e.jsx(te,{className:"h-4 w-4"}),e.jsx("span",{children:"Snooze 3d"})]}),e.jsxs("button",{type:"button",className:"btn btn-primary flex items-center space-x-1",onClick:()=>J(s),disabled:!1,children:[e.jsx(Ne,{className:"h-4 w-4"}),e.jsx("span",{children:"Record Payment"})]})]})]})]})},s._id)})})]}),e.jsxs("div",{className:"border rounded-lg p-4 bg-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-700 flex items-center space-x-2",children:[e.jsx(X,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:"Active Recurring Expenses"})]}),z&&e.jsx("span",{className:"text-xs text-gray-500",children:"Loading..."})]}),L.length===0?e.jsx("div",{className:"text-center text-sm text-gray-500 border border-dashed border-gray-200 rounded-lg py-6",children:e.jsx("p",{children:"No recurring expenses configured yet."})}):e.jsx("div",{className:"max-h-72 overflow-y-auto divide-y",children:L.map(s=>e.jsxs("div",{className:"py-3 flex items-start justify-between space-x-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-gray-800",children:s.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Due every month on day ",s.dayOfMonth," •"," ",s.reminderDaysBefore," day(s) reminder"]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Next: ",M(s.nextDueDate)," • ",E(s.amount)]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",className:"btn btn-light text-xs",onClick:()=>$(s,30),disabled:isSubmitting,children:"Skip Month"}),e.jsx("button",{type:"button",className:"btn btn-danger text-xs",onClick:()=>K(s._id),disabled:isSubmitting,children:"Deactivate"})]})]},s._id))})]})]})]})]})},Ue=(n=new Date)=>{const x=n.getFullYear(),y=String(n.getMonth()+1).padStart(2,"0"),j=String(n.getDate()).padStart(2,"0");return`${x}-${y}-${j}`},le=Ue(),ae={date:le,expenseAccount:"",amount:"",notes:"",bank:"",particular:""},Je=()=>{const[n,x]=h.useState(ae),[y,j]=h.useState("cash"),[d,p]=h.useState([]),[m,_]=h.useState(null),{data:b,isLoading:R}=_e({accountType:"expense",isActive:"true"}),N=h.useMemo(()=>{var t;return((t=b==null?void 0:b.data)==null?void 0:t.accounts)||(b==null?void 0:b.accounts)||(b==null?void 0:b.data)||[]},[b]),{data:f,isLoading:B}=ce({isActive:!0}),z=h.useMemo(()=>{var t;return((t=f==null?void 0:f.data)==null?void 0:t.banks)||(f==null?void 0:f.banks)||(f==null?void 0:f.data)||[]},[f]),{data:u,isFetching:O}=ve({limit:20}),D=h.useMemo(()=>{var a,r,i;return(((a=u==null?void 0:u.data)==null?void 0:a.cashPayments)||(u==null?void 0:u.cashPayments)||((i=(r=u==null?void 0:u.data)==null?void 0:r.data)==null?void 0:i.cashPayments)||[]).filter(l=>!(l!=null&&l.supplier)&&!(l!=null&&l.customer))},[u]),{data:g,isFetching:L}=we({limit:20}),F=h.useMemo(()=>{var a,r,i;return(((a=g==null?void 0:g.data)==null?void 0:a.bankPayments)||(g==null?void 0:g.bankPayments)||((i=(r=g==null?void 0:g.data)==null?void 0:r.data)==null?void 0:i.bankPayments)||[]).filter(l=>!(l!=null&&l.supplier)&&!(l!=null&&l.customer))},[g]),P=h.useMemo(()=>[...(D||[]).map(a=>({...a,source:"cash"})),...(F||[]).map(a=>({...a,source:"bank"})),...d].filter((a,r,i)=>(a==null?void 0:a._id)&&r===i.findIndex(l=>l._id===a._id)).sort((a,r)=>new Date(r.date||r.createdAt)-new Date(a.date||a.createdAt)).slice(0,25),[D,F,d]),v=t=>{if(t==null)return"";if(typeof t=="string")return t;if(typeof t=="number")return`${t}`;if(typeof t=="boolean")return t?"Yes":"No";if(Array.isArray(t)){const a=t.find(r=>r!=null);return v(a)}if(typeof t=="object"){const a=["label","name","accountName","bankName","displayName","companyName","businessName","type","title","code","id","_id"];for(const r of a)if(r in t){const i=v(t[r]);if(i)return i}}return""},q=t=>{if(!t)return"cash";const{source:a,bank:r}=t,i=v(a);if(i)return i;if(r){const l=v(r);return l||"bank"}return"cash"},[U,{isLoading:G}]=ke(),[V,{isLoading:Q}]=Ce(),[H]=Ae(),[I,{isLoading:W}]=Ee(),[Y,{isLoading:Z}]=De(),[J]=Pe(),$=async t=>{try{let a;(m==null?void 0:m.source)==="cash"?a=await V({id:m._id,...t}).unwrap():a=await U(t).unwrap();const r=(a==null?void 0:a.data)||a;if(r){const i={...r,source:"cash"};p(l=>{const S=l.filter(A=>A._id!==i._id);return[i,...S].slice(0,10)})}k(m?"Cash expense updated successfully":"Cash expense recorded successfully"),o()}catch(a){w(C(a))}},K=async t=>{try{let a;(m==null?void 0:m.source)==="bank"?a=await Y({id:m._id,...t}).unwrap():a=await I(t).unwrap();const r=(a==null?void 0:a.data)||a;if(r){const i={...r,source:"bank"};p(l=>{const S=l.filter(A=>A._id!==i._id);return[i,...S].slice(0,10)})}k(m?"Bank expense updated successfully":"Bank expense recorded successfully"),o()}catch(a){w(C(a))}},s=h.useMemo(()=>N.find(t=>t._id===n.expenseAccount),[N,n.expenseAccount]),c=t=>{x(a=>({...a,expenseAccount:t,particular:a.particular||(()=>{const r=N.find(i=>i._id===t);return r?r.accountName:""})()}))},o=()=>{x(ae),j("cash"),_(null)},T=t=>{var r,i;if(t.preventDefault(),!n.expenseAccount){w("Please choose an expense account");return}if(!n.amount||Number(n.amount)<=0){w("Amount must be greater than zero");return}const a={date:n.date,amount:parseFloat(n.amount),particular:((r=n.particular)==null?void 0:r.trim())||(s==null?void 0:s.accountName)||"Expense",expenseAccount:n.expenseAccount,notes:((i=n.notes)==null?void 0:i.trim())||void 0};if(y==="bank"){if(!n.bank){w("Please select a bank account for this expense");return}K({...a,bank:n.bank})}else $(a)},de=t=>{var a,r,i;_(t),j(t.source==="bank"?"bank":"cash"),x({date:t.date?t.date.split("T")[0]:le,expenseAccount:((a=t.expenseAccount)==null?void 0:a._id)||t.expenseAccount||"",amount:((r=t.amount)==null?void 0:r.toString())||"",notes:t.notes||"",bank:((i=t.bank)==null?void 0:i._id)||t.bank||"",particular:t.particular||""})},oe=async t=>{if(window.confirm("Are you sure you want to delete this expense entry?"))try{t.source==="bank"?await J(t._id).unwrap():await H(t._id).unwrap(),p(r=>r.filter(i=>i._id!==t._id)),k("Expense deleted successfully"),(m==null?void 0:m._id)===t._id&&o()}catch(r){w(C(r))}},ee=(t,{print:a=!1}={})=>{var A;const r=(A=t.expenseAccount)!=null&&A.accountName?`${t.expenseAccount.accountName} (${t.expenseAccount.accountCode||""})`:"Expense Account",i=t.source==="bank"?"Bank":"Cash",l=window.open("","_blank","width=800,height=600");if(!l)return;const S=`
      <html>
        <head>
          <title>Expense Voucher</title>
          <style>
            body { font-family: Arial, sans-serif; margin: 24px; color: #1f2937; }
            h1 { font-size: 20px; margin-bottom: 16px; }
            table { width: 100%; border-collapse: collapse; margin-bottom: 24px; }
            td { padding: 8px 12px; border: 1px solid #e5e7eb; vertical-align: top; font-size: 14px; }
            .label { font-weight: 600; background: #f3f4f6; width: 35%; }
            .footer { text-align: center; font-size: 12px; color: #6b7280; }
          </style>
        </head>
        <body>
          <h1>Expense Voucher</h1>
          <table>
            <tr>
              <td class="label">Voucher ID</td>
              <td>${t.voucherCode||t._id}</td>
            </tr>
            <tr>
              <td class="label">Date</td>
              <td>${M(t.date||t.createdAt)}</td>
            </tr>
            <tr>
              <td class="label">Payment Method</td>
              <td>${i}</td>
            </tr>
            <tr>
              <td class="label">Expense Account</td>
              <td>${r}</td>
            </tr>
            <tr>
              <td class="label">Amount</td>
              <td>${E(t.amount||0)}</td>
            </tr>
            <tr>
              <td class="label">Description</td>
              <td>${t.particular||"-"}</td>
            </tr>
            <tr>
              <td class="label">Notes</td>
              <td>${t.notes||"-"}</td>
            </tr>
          </table>
          <div class="footer">Generated on ${M(new Date().toISOString())}</div>
        </body>
      </html>
    `;l.document.open(),l.document.write(S),l.document.close(),l.focus(),a&&(l.print(),l.close())},me=t=>{ee(t,{print:!1})},ue=t=>{ee(t,{print:!0})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center space-x-2",children:[e.jsx(Se,{className:"h-6 w-6 text-primary-600"}),e.jsx("span",{children:"Record Expense"})]}),e.jsxs("div",{className:"mt-1 lg:mt-0 grid grid-cols-1 lg:grid-cols-[minmax(0,1fr)_minmax(420px,0.45fr)] gap-3 lg:gap-6 lg:items-start lg:mt-1",children:[e.jsx("p",{className:"text-gray-600 lg:mt-1",children:"Log operating expenses directly from cash or bank while posting to the right expense account."}),e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50 w-full",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Payment Method"}),e.jsx("div",{className:"flex items-center gap-3 mt-1",children:[{value:"cash",label:"Cash",helper:"Use cash on hand"},{value:"bank",label:"Bank",helper:"Use a bank account"}].map(t=>{const a=y===t.value;return e.jsxs("button",{type:"button",onClick:()=>{j(t.value),t.value==="cash"&&x(r=>({...r,bank:""}))},className:`flex-1 px-4 py-3 rounded-xl border-2 text-left transition-all duration-200 ${a?"border-primary-500 bg-primary-50 text-primary-700 shadow-sm":"border-gray-200 text-gray-600 hover:border-primary-300 hover:bg-primary-50/40"}`,children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`h-4 w-4 rounded-full border ${a?"border-primary-500 bg-primary-500":"border-gray-300 bg-white"}`}),e.jsx("span",{className:"text-sm font-semibold",children:t.label})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:t.helper})]},t.value)})})]})]})]}),e.jsx("div",{className:"card relative",children:e.jsx("div",{className:"card-content pt-4",children:e.jsxs("form",{onSubmit:T,className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"form-label flex items-center justify-between",children:[e.jsx("span",{children:"Expense Account"}),e.jsxs("button",{type:"button",onClick:o,className:"text-sm text-primary-600 hover:text-primary-700 flex items-center space-x-1",children:[e.jsx(re,{className:"h-4 w-4"}),e.jsx("span",{children:"Reset"})]})]}),e.jsxs("select",{className:"input",value:n.expenseAccount,onChange:t=>c(t.target.value),required:!0,disabled:R,children:[e.jsx("option",{value:"",children:"Select expense account"}),N.map(t=>e.jsxs("option",{value:t._id,children:[t.accountName," (",t.accountCode,")"]},t._id))]}),s&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Selected account will be debited when this expense is posted."})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Amount"}),e.jsxs("div",{className:"relative",children:[e.jsx(Me,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"number",min:"0",step:"0.01",className:"input pl-9",value:n.amount,onChange:t=>x(a=>({...a,amount:t.target.value})),required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Date"}),e.jsxs("div",{className:"relative",children:[e.jsx(X,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"date",className:"input pl-9",value:n.date,onChange:t=>x(a=>({...a,date:t.target.value}))})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Description (optional)"}),e.jsx("input",{type:"text",className:"input",placeholder:s?s.accountName:"e.g., Rent for November",value:n.particular,onChange:t=>x(a=>({...a,particular:t.target.value}))})]}),y==="bank"&&e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Bank Account"}),e.jsxs("select",{className:"input",value:n.bank,onChange:t=>x(a=>({...a,bank:t.target.value})),required:!0,disabled:B,children:[e.jsx("option",{value:"",children:"Select bank account"}),z.map(t=>e.jsxs("option",{value:t._id,children:[t.bankName," • ",t.accountNumber,t.accountName?` (${t.accountName})`:""]},t._id))]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Notes"}),e.jsx("textarea",{className:"input",rows:6,placeholder:"Optional internal notes...",value:n.notes,onChange:t=>x(a=>({...a,notes:t.target.value}))})]}),e.jsxs("div",{className:"border rounded-lg bg-primary-50/40 p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-primary-700 mb-2",children:"Posting Preview"}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Debit"}),e.jsx("span",{children:s?`${s.accountName} (${s.accountCode})`:"Select expense account"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Credit"}),e.jsx("span",{children:y==="cash"?"Cash on Hand":"Bank Account"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Amount"}),e.jsx("span",{children:n.amount?E(parseFloat(n.amount)||0):E(0)})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{type:"submit",className:"btn btn-primary flex items-center space-x-2",disabled:G||Q||W||Z,children:[e.jsx(ie,{className:"h-4 w-4"}),e.jsx("span",{children:m?"Update Expense":"Save Expense"})]})})]})]})})}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center space-x-2",children:[e.jsx(Te,{className:"h-5 w-5 text-primary-600"}),e.jsx("span",{children:"Recent Expense Entries"})]}),(O||L)&&e.jsx("span",{className:"text-xs text-gray-500",children:"Refreshing..."})]}),e.jsx("div",{className:"card-content",children:P.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:"Expenses recorded here will appear in this list for quick reference."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Voucher"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Expense Account"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-4 py-2 text-center text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Method"}),e.jsx("th",{className:"px-4 py-2 text-center text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:P.map(t=>{var a;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 whitespace-nowrap",children:M(t.date||t.createdAt)}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 whitespace-nowrap",children:t.voucherCode||t._id}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:(a=t.expenseAccount)!=null&&a.accountName?`${t.expenseAccount.accountName} (${t.expenseAccount.accountCode})`:"—"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:t.particular||"—"}),e.jsx("td",{className:"px-4 py-3 text-sm font-semibold text-gray-900 text-right whitespace-nowrap",children:E(t.amount||0)}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600 text-center capitalize whitespace-nowrap",children:q(t)}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600 text-center whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center justify-center gap-1.5",children:[e.jsxs("button",{type:"button",onClick:()=>me(t),className:"p-2 rounded-md text-blue-600 hover:bg-blue-50 transition-colors",title:"View Expense",children:[e.jsx(Le,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"View"})]}),e.jsxs("button",{type:"button",onClick:()=>ue(t),className:"p-2 rounded-md text-green-600 hover:bg-green-50 transition-colors",title:"Print Expense",children:[e.jsx(Fe,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Print"})]}),e.jsxs("button",{type:"button",onClick:()=>de(t),className:"p-2 rounded-md text-blue-600 hover:bg-blue-50 transition-colors",title:"Edit Expense",children:[e.jsx(Re,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Edit"})]}),e.jsxs("button",{type:"button",onClick:()=>oe(t),className:"p-2 rounded-md text-red-600 hover:bg-red-50 transition-colors",title:"Delete Expense",children:[e.jsx($e,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Delete"})]})]})})]},t._id)})})]})})})]}),e.jsx(qe,{expenseAccounts:N,onPaymentRecorded:t=>{t!=null&&t.payment&&p(a=>[{...t.payment,source:t.payment.bank?"bank":"cash"},...a].slice(0,25))}})]})]})};export{Je as default};
