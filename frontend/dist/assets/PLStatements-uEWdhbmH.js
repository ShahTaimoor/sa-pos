import{D as me,E as fe,r as R,p as e,a2 as ce,aI as xe,X as ue,T as S,q as n,aP as ae,y as ve,a_ as we,S as ye,Q as Se}from"./index-DaTQeIrM.js";import{C as ne}from"./chevron-up-B1QiEVPM.js";import{C as re}from"./chevron-down-5FLXPK9w.js";import{I as le}from"./info-geJWZ_yE.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=me("ArrowDownCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=me("ArrowUpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=me("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),Re=fe.injectEndpoints({endpoints:l=>({generateStatement:l.mutation({query:a=>({url:"pl-statements/generate",method:"post",data:a}),invalidatesTags:[{type:"Reports",id:"PL_STATEMENTS"}]}),getStatements:l.query({query:a=>({url:"pl-statements",method:"get",params:a}),providesTags:a=>{var r,c;return(r=a==null?void 0:a.data)!=null&&r.statements||a!=null&&a.statements?[...(((c=a.data)==null?void 0:c.statements)||a.statements).map(({_id:b,id:g})=>({type:"Reports",id:b||g})),{type:"Reports",id:"PL_STATEMENTS"}]:[{type:"Reports",id:"PL_STATEMENTS"}]}}),getStatement:l.query({query:a=>({url:`pl-statements/${a}`,method:"get"}),providesTags:(a,r,c)=>[{type:"Reports",id:c}]}),updateStatement:l.mutation({query:({id:a,...r})=>({url:`pl-statements/${a}`,method:"put",data:r}),invalidatesTags:(a,r,{id:c})=>[{type:"Reports",id:c},{type:"Reports",id:"PL_STATEMENTS"}]}),updateStatementStatus:l.mutation({query:({id:a,...r})=>({url:`pl-statements/${a}/status`,method:"put",data:r}),invalidatesTags:(a,r,{id:c})=>[{type:"Reports",id:c},{type:"Reports",id:"PL_STATEMENTS"}]}),deleteStatement:l.mutation({query:a=>({url:`pl-statements/${a}`,method:"delete"}),invalidatesTags:(a,r,c)=>[{type:"Reports",id:c},{type:"Reports",id:"PL_STATEMENTS"}]}),getSummary:l.query({query:a=>({url:"pl-statements/summary",method:"get",params:a}),providesTags:[{type:"Reports",id:"PL_STATEMENTS_SUMMARY"}]}),getTrends:l.query({query:a=>({url:"pl-statements/trends",method:"get",params:a}),providesTags:[{type:"Reports",id:"PL_STATEMENTS_TRENDS"}]}),getComparison:l.query({query:({id:a,type:r="previous"})=>({url:`pl-statements/${a}/comparison`,method:"get",params:{type:r}}),providesTags:(a,r,{id:c})=>[{type:"Reports",id:`COMPARISON_${c}`}]}),exportStatement:l.mutation({query:({id:a,...r})=>({url:`pl-statements/${a}/export`,method:"post",data:r,responseType:"blob"})}),getLatestStatement:l.query({query:a=>({url:"pl-statements/latest",method:"get",params:a}),providesTags:[{type:"Reports",id:"PL_STATEMENTS_LATEST"}]})}),overrideExisting:!1}),{useGetSummaryQuery:Ie}=Re,Pe=({isOpen:l,onClose:a,summaryData:r,fromDate:c,toDate:b})=>{var C,N,k,L,T,$,M,O,A,D,_,U,q,G,F,B,Y,z,V,H,Q,X,J,K,W,Z,ee,se,te,y,he,pe,ge,je,Ne;const[g,I]=R.useState(null);if(!l)return null;const s=(r==null?void 0:r.data)||r,u=((N=(C=s==null?void 0:s.revenue)==null?void 0:C.totalRevenue)==null?void 0:N.amount)||((T=(L=(k=s==null?void 0:s.statement)==null?void 0:k.revenue)==null?void 0:L.totalRevenue)==null?void 0:T.amount)||(s==null?void 0:s.totalRevenue)||0,oe=(($=s==null?void 0:s.grossProfit)==null?void 0:$.amount)||((O=(M=s==null?void 0:s.statement)==null?void 0:M.grossProfit)==null?void 0:O.amount)||(s==null?void 0:s.grossProfit)||0,m=((A=s==null?void 0:s.operatingIncome)==null?void 0:A.amount)||((_=(D=s==null?void 0:s.statement)==null?void 0:D.operatingIncome)==null?void 0:_.amount)||(s==null?void 0:s.operatingIncome)||0,d=((U=s==null?void 0:s.netIncome)==null?void 0:U.amount)||((G=(q=s==null?void 0:s.statement)==null?void 0:q.netIncome)==null?void 0:G.amount)||(s==null?void 0:s.netIncome)||0,P=u-d,j=o=>o?new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"",f=o=>o?new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",v=o=>{I(g===o?null:o)},i=(s==null?void 0:s.revenue)||((F=s==null?void 0:s.statement)==null?void 0:F.revenue)||{},h=(s==null?void 0:s.operatingExpenses)||((B=s==null?void 0:s.statement)==null?void 0:B.operatingExpenses)||{},p=(s==null?void 0:s.costOfGoodsSold)||((Y=s==null?void 0:s.statement)==null?void 0:Y.costOfGoodsSold)||{},t={grossSales:((z=i==null?void 0:i.grossSales)==null?void 0:z.amount)||0,salesReturns:((V=i==null?void 0:i.salesReturns)==null?void 0:V.amount)||0,salesDiscounts:((H=i==null?void 0:i.salesDiscounts)==null?void 0:H.amount)||0,otherRevenue:((Q=i==null?void 0:i.otherRevenue)==null?void 0:Q.amount)||0,salesByCategory:((X=i==null?void 0:i.grossSales)==null?void 0:X.details)||[]},x={sellingExpenses:((J=h==null?void 0:h.sellingExpenses)==null?void 0:J.total)||0,administrativeExpenses:((K=h==null?void 0:h.administrativeExpenses)==null?void 0:K.total)||0,sellingDetails:((W=h==null?void 0:h.sellingExpenses)==null?void 0:W.details)||[],adminDetails:((Z=h==null?void 0:h.administrativeExpenses)==null?void 0:Z.details)||[]},w={beginningInventory:(p==null?void 0:p.beginningInventory)||0,purchases:((ee=p==null?void 0:p.purchases)==null?void 0:ee.amount)||0,endingInventory:(p==null?void 0:p.endingInventory)||0,totalCOGS:((se=p==null?void 0:p.totalCOGS)==null?void 0:se.amount)||0};return e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:a,"aria-hidden":"true"}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-4 border-b border-blue-800",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ce,{className:"h-6 w-6 text-white mr-3"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Profit & Loss Summary Report"}),e.jsxs("div",{className:"flex items-center mt-1 text-blue-100 text-sm",children:[e.jsx(xe,{className:"h-4 w-4 mr-1"}),e.jsxs("span",{children:[j(c)," - ",j(b)]})]})]})]}),e.jsx("button",{onClick:a,className:"text-white hover:text-gray-200 transition-colors rounded-full p-1 hover:bg-blue-800","aria-label":"Close modal",children:e.jsx(ue,{className:"h-6 w-6"})})]})}),e.jsx("div",{className:"bg-white px-6 py-6 max-h-[70vh] overflow-y-auto overscroll-contain",children:e.jsxs("div",{className:"space-y-6 pb-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-lg border-2 border-green-300 shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"p-6 cursor-pointer hover:bg-green-100 transition-colors",onClick:()=>v("revenue"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-green-500 rounded-full p-2 mr-3",children:e.jsx(Ee,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-green-800 uppercase tracking-wide",children:"Total Revenue"}),e.jsx("p",{className:"text-xs text-green-600 mt-1",children:"All income from sales"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(S,{className:"h-6 w-6 text-green-600"}),g==="revenue"?e.jsx(ne,{className:"h-5 w-5 text-green-600"}):e.jsx(re,{className:"h-5 w-5 text-green-600"})]})]}),e.jsx("p",{className:"text-3xl font-bold text-green-900 ml-12",children:n(u)})]}),g==="revenue"&&e.jsxs("div",{className:"bg-white border-t border-green-200 p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-start space-x-2 mb-3",children:[e.jsx(le,{className:"h-4 w-4 text-green-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-green-800",children:"Data Source & Period"}),e.jsxs("p",{className:"text-xs text-gray-600",children:["Period: ",j(c)," to ",j(b)]}),e.jsxs("p",{className:"text-xs text-gray-600",children:["Last Updated: ",s!=null&&s.lastUpdated?f(s.lastUpdated):"N/A"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-green-50 rounded p-3",children:[e.jsx("p",{className:"text-xs text-green-700 font-medium mb-1",children:"Gross Sales"}),e.jsx("p",{className:"text-lg font-bold text-green-900",children:n(t.grossSales)})]}),e.jsxs("div",{className:"bg-red-50 rounded p-3",children:[e.jsx("p",{className:"text-xs text-red-700 font-medium mb-1",children:"Sales Returns"}),e.jsx("p",{className:"text-lg font-bold text-red-900",children:n(t.salesReturns)})]}),e.jsxs("div",{className:"bg-yellow-50 rounded p-3",children:[e.jsx("p",{className:"text-xs text-yellow-700 font-medium mb-1",children:"Sales Discounts"}),e.jsx("p",{className:"text-lg font-bold text-yellow-900",children:n(t.salesDiscounts)})]}),e.jsxs("div",{className:"bg-blue-50 rounded p-3",children:[e.jsx("p",{className:"text-xs text-blue-700 font-medium mb-1",children:"Other Revenue"}),e.jsx("p",{className:"text-lg font-bold text-blue-900",children:n(t.otherRevenue)})]})]}),t.salesByCategory&&t.salesByCategory.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Sales by Category"}),e.jsx("div",{className:"space-y-2",children:t.salesByCategory.map((o,E)=>e.jsxs("div",{className:"flex justify-between items-center bg-gray-50 rounded p-2",children:[e.jsx("span",{className:"text-xs text-gray-700",children:o.category||"Other"}),e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:n(o.amount||0)})]},E))})]}),e.jsx("div",{className:"mt-4 pt-3 border-t border-gray-200",children:e.jsxs("p",{className:"text-xs text-gray-600",children:[e.jsx("strong",{children:"Calculation:"})," Gross Sales - Sales Returns - Sales Discounts + Other Revenue = Total Revenue"]})})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-red-100 rounded-lg border-2 border-red-300 shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"p-6 cursor-pointer hover:bg-red-100 transition-colors",onClick:()=>v("expenses"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-red-500 rounded-full p-2 mr-3",children:e.jsx(ae,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-red-800 uppercase tracking-wide",children:"Total Expenses"}),e.jsx("p",{className:"text-xs text-red-600 mt-1",children:"All operating and non-operating expenses"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ae,{className:"h-6 w-6 text-red-600"}),g==="expenses"?e.jsx(ne,{className:"h-5 w-5 text-red-600"}):e.jsx(re,{className:"h-5 w-5 text-red-600"})]})]}),e.jsx("p",{className:"text-3xl font-bold text-red-900 ml-12",children:n(P)})]}),g==="expenses"&&e.jsxs("div",{className:"bg-white border-t border-red-200 p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-start space-x-2 mb-3",children:[e.jsx(le,{className:"h-4 w-4 text-red-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-red-800",children:"Data Source & Period"}),e.jsxs("p",{className:"text-xs text-gray-600",children:["Period: ",j(c)," to ",j(b)]}),e.jsxs("p",{className:"text-xs text-gray-600",children:["Last Updated: ",s!=null&&s.lastUpdated?f(s.lastUpdated):"N/A"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-orange-50 rounded p-3",children:[e.jsx("p",{className:"text-xs text-orange-700 font-medium mb-1",children:"Selling Expenses"}),e.jsx("p",{className:"text-lg font-bold text-orange-900",children:n(x.sellingExpenses)})]}),e.jsxs("div",{className:"bg-purple-50 rounded p-3",children:[e.jsx("p",{className:"text-xs text-purple-700 font-medium mb-1",children:"Administrative Expenses"}),e.jsx("p",{className:"text-lg font-bold text-purple-900",children:n(x.administrativeExpenses)})]}),e.jsxs("div",{className:"bg-gray-50 rounded p-3",children:[e.jsx("p",{className:"text-xs text-gray-700 font-medium mb-1",children:"COGS"}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:n(w.totalCOGS)})]}),e.jsxs("div",{className:"bg-pink-50 rounded p-3",children:[e.jsx("p",{className:"text-xs text-pink-700 font-medium mb-1",children:"Other Expenses"}),e.jsx("p",{className:"text-lg font-bold text-pink-900",children:n(P-x.sellingExpenses-x.administrativeExpenses-w.totalCOGS)})]})]}),x.sellingDetails&&x.sellingDetails.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Selling Expenses Breakdown"}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:x.sellingDetails.map((o,E)=>e.jsxs("div",{className:"flex justify-between items-center bg-gray-50 rounded p-2",children:[e.jsx("span",{className:"text-xs text-gray-700",children:o.category||o.description||"Other"}),e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:n(o.amount||0)})]},E))})]}),x.adminDetails&&x.adminDetails.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Administrative Expenses Breakdown"}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:x.adminDetails.map((o,E)=>e.jsxs("div",{className:"flex justify-between items-center bg-gray-50 rounded p-2",children:[e.jsx("span",{className:"text-xs text-gray-700",children:o.category||o.description||"Other"}),e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:n(o.amount||0)})]},E))})]}),e.jsx("div",{className:"mt-4 pt-3 border-t border-gray-200",children:e.jsxs("p",{className:"text-xs text-gray-600",children:[e.jsx("strong",{children:"Calculation:"})," COGS + Selling Expenses + Administrative Expenses + Other Expenses = Total Expenses"]})})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg border-2 border-blue-300 shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"p-6 cursor-pointer hover:bg-blue-100 transition-colors",onClick:()=>v("operating"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-blue-500 rounded-full p-2 mr-3",children:e.jsx(S,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-blue-800 uppercase tracking-wide",children:"Operating Income"}),e.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"Revenue minus operating expenses"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(S,{className:"h-6 w-6 text-blue-600"}),g==="operating"?e.jsx(ne,{className:"h-5 w-5 text-blue-600"}):e.jsx(re,{className:"h-5 w-5 text-blue-600"})]})]}),e.jsx("p",{className:`text-3xl font-bold ml-12 ${m>=0?"text-blue-900":"text-red-600"}`,children:n(m)})]}),g==="operating"&&e.jsxs("div",{className:"bg-white border-t border-blue-200 p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-start space-x-2 mb-3",children:[e.jsx(le,{className:"h-4 w-4 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-blue-800",children:"Data Source & Period"}),e.jsxs("p",{className:"text-xs text-gray-600",children:["Period: ",j(c)," to ",j(b)]}),e.jsxs("p",{className:"text-xs text-gray-600",children:["Last Updated: ",s!=null&&s.lastUpdated?f(s.lastUpdated):"N/A"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"bg-green-50 rounded p-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-green-700 font-medium",children:"Total Revenue"}),e.jsx("span",{className:"text-lg font-bold text-green-900",children:n(u)})]})}),e.jsx("div",{className:"text-center text-gray-400",children:"-"}),e.jsx("div",{className:"bg-red-50 rounded p-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-red-700 font-medium",children:"COGS"}),e.jsx("span",{className:"text-lg font-bold text-red-900",children:n(w.totalCOGS)})]})}),e.jsx("div",{className:"text-center text-gray-400",children:"="}),e.jsx("div",{className:"bg-blue-50 rounded p-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-blue-700 font-medium",children:"Gross Profit"}),e.jsx("span",{className:"text-lg font-bold text-blue-900",children:n(oe)})]})}),e.jsx("div",{className:"text-center text-gray-400",children:"-"}),e.jsx("div",{className:"bg-orange-50 rounded p-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-orange-700 font-medium",children:"Operating Expenses"}),e.jsx("span",{className:"text-lg font-bold text-orange-900",children:n(x.sellingExpenses+x.administrativeExpenses)})]})}),e.jsx("div",{className:"text-center text-gray-400",children:"="}),e.jsx("div",{className:`rounded p-3 ${m>=0?"bg-blue-50":"bg-red-50"}`,children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:`text-xs font-medium ${m>=0?"text-blue-700":"text-red-700"}`,children:"Operating Income"}),e.jsx("span",{className:`text-lg font-bold ${m>=0?"text-blue-900":"text-red-900"}`,children:n(m)})]})})]}),((te=s==null?void 0:s.operatingIncome)==null?void 0:te.margin)!==void 0&&e.jsx("div",{className:"mt-4 pt-3 border-t border-gray-200",children:e.jsxs("p",{className:"text-xs text-gray-600",children:[e.jsx("strong",{children:"Operating Margin:"})," ",s.operatingIncome.margin.toFixed(2),"%"]})})]})]}),e.jsxs("div",{className:`bg-gradient-to-br rounded-lg border-2 shadow-sm overflow-hidden ${d>=0?"from-teal-50 to-teal-100 border-teal-300":"from-red-50 to-red-100 border-red-300"}`,children:[e.jsxs("div",{className:`p-6 cursor-pointer transition-colors ${d>=0?"hover:bg-teal-100":"hover:bg-red-100"}`,onClick:()=>v("netIncome"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`rounded-full p-2 mr-3 ${d>=0?"bg-teal-500":"bg-red-500"}`,children:d>=0?e.jsx(S,{className:"h-5 w-5 text-white"}):e.jsx(ae,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:`text-sm font-semibold uppercase tracking-wide ${d>=0?"text-teal-800":"text-red-800"}`,children:"Net Profit / Loss"}),e.jsx("p",{className:`text-xs mt-1 ${d>=0?"text-teal-600":"text-red-600"}`,children:"Final profit or loss after all expenses"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[d>=0?e.jsx(S,{className:"h-6 w-6 text-teal-600"}):e.jsx(ae,{className:"h-6 w-6 text-red-600"}),g==="netIncome"?e.jsx(ne,{className:`h-5 w-5 ${d>=0?"text-teal-600":"text-red-600"}`}):e.jsx(re,{className:`h-5 w-5 ${d>=0?"text-teal-600":"text-red-600"}`})]})]}),e.jsx("p",{className:`text-3xl font-bold ml-12 ${d>=0?"text-teal-900":"text-red-900"}`,children:n(d)}),((y=s==null?void 0:s.netIncome)==null?void 0:y.margin)!==void 0&&e.jsxs("p",{className:`text-sm mt-2 ml-12 ${d>=0?"text-teal-600":"text-red-600"}`,children:["Net Margin: ",s.netIncome.margin.toFixed(1),"%"]})]}),g==="netIncome"&&e.jsxs("div",{className:`bg-white border-t p-4 space-y-4 ${d>=0?"border-teal-200":"border-red-200"}`,children:[e.jsxs("div",{className:"flex items-start space-x-2 mb-3",children:[e.jsx(le,{className:`h-4 w-4 mt-0.5 ${d>=0?"text-teal-600":"text-red-600"}`}),e.jsxs("div",{children:[e.jsx("p",{className:`text-xs font-semibold ${d>=0?"text-teal-800":"text-red-800"}`,children:"Data Source & Period"}),e.jsxs("p",{className:"text-xs text-gray-600",children:["Period: ",j(c)," to ",j(b)]}),e.jsxs("p",{className:"text-xs text-gray-600",children:["Last Updated: ",s!=null&&s.lastUpdated?f(s.lastUpdated):"N/A"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"bg-blue-50 rounded p-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-blue-700 font-medium",children:"Operating Income"}),e.jsx("span",{className:"text-lg font-bold text-blue-900",children:n(m)})]})}),e.jsx("div",{className:"text-center text-gray-400",children:"+"}),e.jsx("div",{className:"bg-green-50 rounded p-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-green-700 font-medium",children:"Other Income"}),e.jsx("span",{className:"text-lg font-bold text-green-900",children:n((((he=s==null?void 0:s.otherIncome)==null?void 0:he.interestIncome)||0)+(((pe=s==null?void 0:s.otherIncome)==null?void 0:pe.rentalIncome)||0)+(((je=(ge=s==null?void 0:s.otherIncome)==null?void 0:ge.other)==null?void 0:je.amount)||0))})]})}),e.jsx("div",{className:"text-center text-gray-400",children:"-"}),e.jsx("div",{className:"bg-red-50 rounded p-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-red-700 font-medium",children:"Other Expenses & Taxes"}),e.jsx("span",{className:"text-lg font-bold text-red-900",children:n(P-x.sellingExpenses-x.administrativeExpenses-w.totalCOGS)})]})}),e.jsx("div",{className:"text-center text-gray-400",children:"="}),e.jsx("div",{className:`rounded p-3 ${d>=0?"bg-teal-50":"bg-red-50"}`,children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:`text-xs font-medium ${d>=0?"text-teal-700":"text-red-700"}`,children:"Net Profit / Loss"}),e.jsx("span",{className:`text-lg font-bold ${d>=0?"text-teal-900":"text-red-900"}`,children:n(d)})]})})]}),((Ne=s==null?void 0:s.netIncome)==null?void 0:Ne.margin)!==void 0&&e.jsxs("div",{className:"mt-4 pt-3 border-t border-gray-200",children:[e.jsxs("p",{className:"text-xs text-gray-600",children:[e.jsx("strong",{children:"Net Margin:"})," ",s.netIncome.margin.toFixed(2),"%"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Net Margin = (Net Income / Total Revenue) Ã— 100"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200 mt-6",children:[e.jsx("h5",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Summary"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Total Revenue:"}),e.jsx("span",{className:"font-medium text-gray-900",children:n(u)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Total Expenses:"}),e.jsx("span",{className:"font-medium text-red-700",children:n(P)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Operating Income:"}),e.jsx("span",{className:`font-medium ${m>=0?"text-blue-700":"text-red-700"}`,children:n(m)})]}),e.jsxs("div",{className:"flex justify-between pt-2 border-t border-gray-300",children:[e.jsx("span",{className:"text-gray-900 font-semibold",children:"Net Profit / Loss:"}),e.jsx("span",{className:`font-bold text-lg ${d>=0?"text-teal-700":"text-red-700"}`,children:n(d)})]})]})]})]})}),e.jsx("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-200 flex justify-end",children:e.jsx("button",{onClick:a,className:"btn btn-primary px-6 py-2",children:"Close"})})]})]})})},de=(l=new Date)=>{const a=l.getFullYear(),r=String(l.getMonth()+1).padStart(2,"0"),c=String(l.getDate()).padStart(2,"0");return`${a}-${r}-${c}`},ie=l=>l?new Date(l).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"",Me=()=>{var $,M,O,A,D,_,U,q,G,F,B,Y,z,V,H,Q,X,J,K,W,Z,ee,se,te;const l=new Date,a=new Date(l.getFullYear(),l.getMonth(),1),[r,c]=R.useState(de(a)),[b,g]=R.useState(de(l)),[I,s]=R.useState(de(a)),[u,oe]=R.useState(de(l)),[m,d]=R.useState(!1),[P,j]=R.useState(!1),{data:f,isLoading:v,error:i,refetch:h}=Ie({startDate:I,endDate:u},{skip:!m,onError:y=>ve(y,"Profit & Loss Statement")}),p=()=>{if(!r||!b){alert("Please select both From Date and To Date");return}if(new Date(r)>new Date(b)){alert("From Date cannot be after To Date");return}s(r),oe(b),d(!0),h()},t=(f==null?void 0:f.data)||f,x=((M=($=t==null?void 0:t.revenue)==null?void 0:$.totalRevenue)==null?void 0:M.amount)||((D=(A=(O=t==null?void 0:t.statement)==null?void 0:O.revenue)==null?void 0:A.totalRevenue)==null?void 0:D.amount)||(t==null?void 0:t.totalRevenue)||0,w=((_=t==null?void 0:t.grossProfit)==null?void 0:_.amount)||((q=(U=t==null?void 0:t.statement)==null?void 0:U.grossProfit)==null?void 0:q.amount)||(t==null?void 0:t.grossProfit)||0,C=((G=t==null?void 0:t.operatingIncome)==null?void 0:G.amount)||((B=(F=t==null?void 0:t.statement)==null?void 0:F.operatingIncome)==null?void 0:B.amount)||(t==null?void 0:t.operatingIncome)||0,N=((Y=t==null?void 0:t.netIncome)==null?void 0:Y.amount)||((V=(z=t==null?void 0:t.statement)==null?void 0:z.netIncome)==null?void 0:V.amount)||(t==null?void 0:t.netIncome)||0,k=((H=t==null?void 0:t.grossProfit)==null?void 0:H.margin)||((X=(Q=t==null?void 0:t.statement)==null?void 0:Q.grossProfit)==null?void 0:X.margin)||(t==null?void 0:t.grossMargin),L=((J=t==null?void 0:t.operatingIncome)==null?void 0:J.margin)||((W=(K=t==null?void 0:t.statement)==null?void 0:K.operatingIncome)==null?void 0:W.margin)||(t==null?void 0:t.operatingMargin),T=((Z=t==null?void 0:t.netIncome)==null?void 0:Z.margin)||((se=(ee=t==null?void 0:t.statement)==null?void 0:ee.netIncome)==null?void 0:se.margin)||(t==null?void 0:t.netMargin);return e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[e.jsx(ce,{className:"h-7 w-7 mr-3 text-primary-600"}),"Profit & Loss Statement"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"View your business financial performance"})]}),m&&t&&e.jsxs("button",{onClick:()=>j(!0),className:"btn btn-primary flex items-center space-x-2 px-4 py-2",children:[e.jsx(we,{className:"h-5 w-5"}),e.jsx("span",{children:"View Summary Report"})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[e.jsx(xe,{className:"h-5 w-5 text-gray-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"From Date"}),e.jsx("input",{type:"date",value:r,onChange:y=>c(y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[e.jsx(xe,{className:"h-5 w-5 text-gray-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"To Date"}),e.jsx("input",{type:"date",value:b,onChange:y=>g(y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("button",{onClick:p,disabled:v,className:"btn btn-primary flex items-center space-x-2 px-6 py-2.5 h-fit disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ye,{className:"h-5 w-5"}),e.jsx("span",{children:v?"Loading...":"Search"})]})})]}),m&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Showing data from ",e.jsx("strong",{children:ie(I)})," to ",e.jsx("strong",{children:ie(u)})]})})]})]}),v&&m&&e.jsxs("div",{className:"flex justify-center items-center py-12",children:[e.jsx(Se,{}),e.jsx("p",{className:"ml-3 text-gray-600",children:"Loading Profit & Loss data..."})]}),i&&m&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3 flex-1",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error loading Profit & Loss data"}),e.jsxs("div",{className:"mt-2 text-sm text-red-700",children:[e.jsx("p",{children:((te=i==null?void 0:i.data)==null?void 0:te.message)||(i==null?void 0:i.message)||"An unexpected error occurred. Please try again."}),!1]}),e.jsx("div",{className:"mt-4",children:e.jsx("button",{onClick:()=>{d(!0),h()},className:"text-sm font-medium text-red-800 hover:text-red-900 underline",children:"Try again"})})]})]})}),!v&&!i&&m&&t&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-lg border-2 border-green-300 p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-green-800 uppercase tracking-wide",children:"Total Revenue"}),e.jsx(be,{className:"h-6 w-6 text-green-600"})]}),e.jsx("p",{className:"text-3xl font-bold text-green-900",children:n(x)}),e.jsx("p",{className:"text-xs text-green-700 mt-2",children:"All income from sales"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg border-2 border-blue-300 p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-blue-800 uppercase tracking-wide",children:"Gross Profit"}),e.jsx(S,{className:"h-6 w-6 text-blue-600"})]}),e.jsx("p",{className:`text-3xl font-bold ${w>=0?"text-blue-900":"text-red-600"}`,children:n(w)}),e.jsx("p",{className:"text-xs text-blue-700 mt-2",children:"Revenue - Cost of Goods Sold"}),k!==void 0&&e.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:["Margin: ",k.toFixed(1),"%"]})]}),e.jsxs("div",{className:`bg-gradient-to-br rounded-lg border-2 p-6 shadow-sm ${N>=0?"from-teal-50 to-teal-100 border-teal-300":"from-red-50 to-red-100 border-red-300"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:`text-sm font-semibold uppercase tracking-wide ${N>=0?"text-teal-800":"text-red-800"}`,children:"Net Profit / Loss"}),N>=0?e.jsx(S,{className:"h-6 w-6 text-teal-600"}):e.jsx(ae,{className:"h-6 w-6 text-red-600"})]}),e.jsx("p",{className:`text-3xl font-bold ${N>=0?"text-teal-900":"text-red-900"}`,children:n(N)}),e.jsx("p",{className:`text-xs mt-2 ${N>=0?"text-teal-700":"text-red-700"}`,children:"Gross Profit - Operating Expenses"}),T!==void 0&&e.jsxs("p",{className:`text-xs mt-1 ${N>=0?"text-teal-600":"text-red-600"}`,children:["Margin: ",T.toFixed(1),"%"]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Detailed Breakdown"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Period: ",ie(I)," to ",ie(u)]})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(be,{className:"h-5 w-5 text-green-600 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Revenue"})]}),e.jsx("div",{className:"bg-green-50 rounded-lg p-4 border border-green-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:"Total Revenue"}),e.jsx("span",{className:"text-xl font-bold text-green-700",children:n(x)})]})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(Te,{className:"h-5 w-5 text-red-600 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Expenses"})]}),e.jsx("div",{className:"bg-red-50 rounded-lg p-4 border border-red-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:"Total Expenses"}),e.jsx("span",{className:"text-xl font-bold text-red-700",children:n(x-w)})]})})]}),C!==void 0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(S,{className:"h-5 w-5 text-blue-600 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Operating Income"})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:"Operating Income"}),e.jsx("span",{className:`text-xl font-bold ${C>=0?"text-blue-700":"text-red-700"}`,children:n(C)})]}),L!==void 0&&e.jsxs("p",{className:"text-sm text-blue-600 mt-2",children:["Operating Margin: ",L.toFixed(1),"%"]})]})]}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-6 border-2 border-gray-300",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:"Net Profit / Loss"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Your final profit or loss for this period"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:`text-3xl font-bold ${N>=0?"text-teal-700":"text-red-700"}`,children:n(N)}),T!==void 0&&e.jsxs("p",{className:`text-sm mt-1 ${N>=0?"text-teal-600":"text-red-600"}`,children:["Net Margin: ",T.toFixed(1),"%"]})]})]})})]})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(ce,{className:"h-5 w-5 text-blue-600 mr-3 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-semibold text-blue-900 mb-1",children:"Understanding Your Profit & Loss Statement"}),e.jsxs("ul",{className:"text-xs text-blue-800 space-y-1 list-disc list-inside",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Total Revenue:"})," All money received from sales"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Gross Profit:"})," Revenue minus the cost of goods you sold"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Operating Income:"})," Gross profit minus operating expenses"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Net Profit/Loss:"})," Your final profit or loss after all expenses"]})]})]})]})})]}),!m&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[e.jsx(ce,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Select Date Range and Click Search"}),e.jsx("p",{className:"text-gray-600",children:"Choose your date range above and click the Search button to view your Profit & Loss statement."})]}),e.jsx(Pe,{isOpen:P,onClose:()=>j(!1),summaryData:f,fromDate:I,toDate:u})]})};export{Me as PLStatements,Me as default};
