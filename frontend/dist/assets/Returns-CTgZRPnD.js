import{D as Ve,E as Xe,r as R,aG as Je,b as Ke,a3 as Ze,p as e,X as I,S as Be,Q as ue,a$ as et,z as we,B as Re,y as xe,P as se,a2 as Ie,U as Ue,aH as De,T as Te,C as Ae,ad as tt,H as st,R as at,J as nt,x as Qe,K as rt,b0 as lt}from"./index-QHzcgHe1.js";import{u as Ye}from"./settingsApi-D-e2N-LC.js";import{A as Se}from"./alert-circle-Zvregbhl.js";import{P as Pe}from"./plus-wthIFHeq.js";import{P as We}from"./printer-Dmqc0NC_.js";import{C as te}from"./check-circle-pdbRLUjc.js";import{X as Ce}from"./x-circle-DZheaYy1.js";import{M as Ge}from"./message-square-DH13qjhm.js";import{P as ke}from"./phone-DmhyAe7y.js";import{P as it}from"./pen-square-D_ZZfkE6.js";import{E as ot}from"./eye-D8xIUmp0.js";import{T as dt}from"./trash-2-G7GOGhVq.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=Ve("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),mt=Xe.injectEndpoints({endpoints:l=>({getReturns:l.query({query:r=>{const c={};return Object.keys(r||{}).forEach(o=>{const j=r[o];j!==""&&j!==null&&j!==void 0&&(c[o]=j)}),{url:"returns",method:"get",params:c}},providesTags:r=>{var c;return(c=r==null?void 0:r.data)!=null&&c.returns||r!=null&&r.data?[...(r.data.returns||r.data).map(({_id:o,id:j})=>({type:"Returns",id:o||j})),{type:"Returns",id:"LIST"}]:[{type:"Returns",id:"LIST"}]}}),getReturn:l.query({query:r=>({url:`returns/${r}`,method:"get"}),providesTags:(r,c,o)=>[{type:"Returns",id:o}]}),createReturn:l.mutation({query:r=>({url:"returns",method:"post",data:r}),invalidatesTags:[{type:"Returns",id:"LIST"}]}),updateReturnStatus:l.mutation({query:({returnId:r,...c})=>({url:`returns/${r}/status`,method:"put",data:c}),invalidatesTags:(r,c,{returnId:o})=>[{type:"Returns",id:o},{type:"Returns",id:"LIST"}]}),updateInspection:l.mutation({query:({returnId:r,...c})=>({url:`returns/${r}/inspection`,method:"put",data:c}),invalidatesTags:(r,c,{returnId:o})=>[{type:"Returns",id:o},{type:"Returns",id:"LIST"}]}),addNote:l.mutation({query:({returnId:r,...c})=>({url:`returns/${r}/notes`,method:"post",data:c}),invalidatesTags:(r,c,{returnId:o})=>[{type:"Returns",id:o}]}),addCommunication:l.mutation({query:({returnId:r,...c})=>({url:`returns/${r}/communication`,method:"post",data:c}),invalidatesTags:(r,c,{returnId:o})=>[{type:"Returns",id:o}]}),getReturnStats:l.query({query:r=>({url:"returns/stats",method:"get",params:r}),providesTags:[{type:"Returns",id:"STATS"}]}),getReturnTrends:l.query({query:r=>({url:"returns/trends",method:"get",params:r}),providesTags:[{type:"Returns",id:"TRENDS"}]}),getEligibleItems:l.query({query:({orderId:r,isPurchase:c=!1})=>({url:c?`returns/purchase-order/${r}/eligible-items`:`returns/order/${r}/eligible-items`,method:"get"}),providesTags:(r,c,{orderId:o})=>[{type:"Returns",id:`ELIGIBLE_${o}`}]}),deleteReturn:l.mutation({query:r=>({url:`returns/${r}`,method:"delete"}),invalidatesTags:(r,c,o)=>[{type:"Returns",id:o},{type:"Returns",id:"LIST"}]})}),overrideExisting:!1}),{useGetReturnsQuery:xt,useGetReturnQuery:He,useCreateReturnMutation:ut,useUpdateReturnStatusMutation:pt,useAddNoteMutation:ht,useAddCommunicationMutation:gt,useGetReturnStatsQuery:bt,useGetEligibleItemsQuery:jt,useDeleteReturnMutation:yt}=mt,ft=({isOpen:l,onClose:r,onSuccess:c,defaultReturnType:o="sales"})=>{var me;const j=o==="purchase",[u,y]=R.useState({originalOrder:"",returnType:"return",priority:"normal",refundMethod:"original_payment",items:[],generalNotes:"",origin:o}),[x,v]=R.useState(null),[A,E]=R.useState(""),[$,P]=R.useState(!1),{data:_,isLoading:F}=Je({search:A,limit:10},{skip:j||A.length<1}),{data:w,isLoading:ie}=Ke({search:A,limit:10},{skip:j||A.length<1}),{data:L,isLoading:f}=Ze({search:A,limit:10},{skip:!j||A.length<1}),ae=j?f:F||ie,{data:U,isLoading:oe}=jt(x!=null&&x._id?{orderId:x._id,isPurchase:j}:null,{skip:!(x!=null&&x._id)}),[de,{isLoading:q}]=ut();R.useEffect(()=>{l&&(y({originalOrder:"",returnType:"return",priority:"normal",refundMethod:"original_payment",items:[],generalNotes:"",origin:o}),v(null),E(""),P(!1))},[l,o]);const Y=t=>{v(t),y(a=>({...a,originalOrder:t._id})),P(!1),E("")},z=(t,a)=>{const g=t.price||t.unitPrice||t.unitCost||t.totalCost/(t.quantity||1)||0,N={product:t.product._id,originalOrderItem:t._id,quantity:1,originalPrice:g,returnReason:"changed_mind",condition:"good",action:"refund",returnReasonDetail:"",refundAmount:0,restockingFee:0};y(C=>({...C,items:[...C.items,{...N,maxQuantity:a}]}))},W=t=>{y(a=>({...a,items:a.items.filter((g,N)=>N!==t)}))},m=(t,a,g)=>{y(N=>({...N,items:N.items.map((C,b)=>b===t?{...C,[a]:g}:C)}))},p=async t=>{if(t.preventDefault(),!x){we("Please select an order");return}if(u.items.length===0){we("Please add at least one item to return");return}for(const a of u.items){if(!a.returnReason){we("Please select a return reason for all items");return}if(!a.condition){we("Please select a condition for all items");return}if(a.quantity<1||a.quantity>a.maxQuantity){we("Invalid quantity for one or more items");return}}try{await de(u).unwrap(),Re("Return request created successfully"),c()}catch(a){xe(a,"Create Return")}},ce=R.useMemo(()=>{var C,b,S;if(j)return L?((C=L.data)==null?void 0:C.purchaseInvoices)||L.purchaseInvoices||L.data||[]:[];const t=(_==null?void 0:_.items)||((b=_==null?void 0:_.data)==null?void 0:b.items)||(_==null?void 0:_.data)||[],a=((S=w==null?void 0:w.data)==null?void 0:S.salesOrders)||(w==null?void 0:w.salesOrders)||(w==null?void 0:w.data)||[];return[...t,...a].filter((M,G,n)=>G===n.findIndex(h=>h._id===M._id))},[_,w,L,j]),ne=((me=U==null?void 0:U.data)==null?void 0:me.eligibleItems)||(U==null?void 0:U.eligibleItems)||[];return l?e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsxs("div",{className:`relative top-20 mx-auto p-0 border w-11/12 max-w-4xl shadow-lg rounded-md bg-white flex flex-col ${x?"max-h-[90vh]":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between p-5 border-b border-gray-200 flex-shrink-0",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Create Return Request"}),e.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:e.jsx(I,{className:"h-6 w-6"})})]}),e.jsx("div",{className:`${x?"overflow-y-auto flex-1":""} p-5`,children:e.jsxs("form",{id:"return-form",onSubmit:p,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Original Order *"}),x?e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:x.orderNumber||x.soNumber||x.invoiceNumber||x.poNumber||"N/A"}),e.jsx("div",{className:"text-sm text-gray-500",children:(()=>{var b,S,M;const t=x.supplier||((b=x.purchaseInvoice)==null?void 0:b.supplier),a=x.customer||((S=x.salesOrder)==null?void 0:S.customer),g=j?(t==null?void 0:t.companyName)||(t==null?void 0:t.name)||(t==null?void 0:t.businessName)||((M=t==null?void 0:t.contactPerson)==null?void 0:M.name)||"Unknown supplier":(a==null?void 0:a.businessName)||[a==null?void 0:a.firstName,a==null?void 0:a.lastName].filter(Boolean).join(" ")||(a==null?void 0:a.email)||"Unknown customer",N=x.total??x.grandTotal??x.amount??0,C=x.createdAt||x.invoiceDate||x.orderDate;return`${g} • $${N.toFixed(2)} • ${C?new Date(C).toLocaleDateString():"—"}`})()})]}),e.jsx("button",{type:"button",onClick:()=>{v(null),y(t=>({...t,originalOrder:""}))},className:"text-gray-400 hover:text-gray-600",children:e.jsx(I,{className:"h-4 w-4"})})]})}):e.jsxs("div",{className:"relative",children:[e.jsx(Be,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:j?"Search purchase orders by order number, supplier name...":"Search orders by order number, customer name...",value:A,onChange:t=>{E(t.target.value),P(!0)},onFocus:()=>P(!0),className:"input pl-10"}),$&&A&&e.jsx("div",{className:"absolute z-10 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base ring-1 ring-black ring-opacity-5 overflow-auto focus:outline-none",children:ae?e.jsx("div",{className:"px-4 py-2 text-gray-500",children:"Searching..."}):ce.length===0?e.jsx("div",{className:"px-4 py-2 text-gray-500",children:"No orders found"}):ce.map(t=>{var M,G,n;const a=t.supplier||((M=t.purchaseInvoice)==null?void 0:M.supplier),g=t.customer||((G=t.salesOrder)==null?void 0:G.customer),N=j?(a==null?void 0:a.companyName)||(a==null?void 0:a.name)||(a==null?void 0:a.businessName)||((n=a==null?void 0:a.contactPerson)==null?void 0:n.name)||"Unknown supplier":(g==null?void 0:g.businessName)||[g==null?void 0:g.firstName,g==null?void 0:g.lastName].filter(Boolean).join(" ")||(g==null?void 0:g.email)||"Unknown customer",C=t.total??t.grandTotal??t.amount??0,b=t.createdAt||t.invoiceDate||t.orderDate,S=t.orderNumber||t.soNumber||t.invoiceNumber||t.poNumber||"N/A";return e.jsx("button",{type:"button",onClick:()=>Y(t),className:"w-full text-left px-4 py-2 hover:bg-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("span",{className:"text-sm text-gray-500",children:b?new Date(b).toLocaleDateString():"—"}),e.jsx("span",{className:"font-medium flex-1",children:N}),e.jsx("span",{className:"text-sm text-gray-600",children:S}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["$",C.toFixed(2)]})]})},t._id)})})]})]}),x&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Return Type *"}),e.jsxs("select",{value:u.returnType,onChange:t=>y(a=>({...a,returnType:t.target.value})),className:"input",required:!0,children:[e.jsx("option",{value:"return",children:"Return"}),e.jsx("option",{value:"exchange",children:"Exchange"}),e.jsx("option",{value:"warranty",children:"Warranty"}),e.jsx("option",{value:"recall",children:"Recall"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),e.jsxs("select",{value:u.priority,onChange:t=>y(a=>({...a,priority:t.target.value})),className:"input",children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"normal",children:"Normal"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"urgent",children:"Urgent"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Items to Return *"}),oe?e.jsx(ue,{message:"Loading eligible items..."}):ne.length===0?e.jsxs("div",{className:"p-4 text-center text-gray-500 bg-gray-50 rounded-lg",children:[e.jsx(Se,{className:"mx-auto h-8 w-8 text-gray-400 mb-2"}),e.jsx("p",{children:"No items are eligible for return from this order"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Available Items"}),e.jsx("div",{className:"space-y-2",children:ne.map((t,a)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:t.orderItem.product.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available: ",t.availableQuantity," • Price: $",(t.orderItem.price||t.orderItem.unitPrice||t.orderItem.unitCost||0).toFixed(2)]})]}),e.jsxs("button",{type:"button",onClick:()=>z(t.orderItem,t.availableQuantity),className:"btn btn-primary btn-sm",disabled:u.items.some(g=>g.originalOrderItem===t.orderItem._id),children:[e.jsx(Pe,{className:"h-4 w-4 mr-1"}),"Add"]})]},t.orderItem._id))})]}),u.items.length>0&&e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Selected Items"}),e.jsx("div",{className:"space-y-4",children:u.items.map((t,a)=>{var g;return e.jsxs("div",{className:"p-3 bg-gray-50 rounded border",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:(g=ne.find(N=>N.orderItem._id===t.originalOrderItem))==null?void 0:g.orderItem.product.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Max quantity: ",t.maxQuantity]})]}),e.jsx("button",{type:"button",onClick:()=>W(a),className:"text-red-500 hover:text-red-700",children:e.jsx(et,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Quantity *"}),e.jsx("input",{type:"number",min:"1",max:t.maxQuantity,value:t.quantity,onChange:N=>m(a,"quantity",parseInt(N.target.value)||1),className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Return Reason *"}),e.jsxs("select",{value:t.returnReason,onChange:N=>m(a,"returnReason",N.target.value),className:"input",required:!0,children:[e.jsx("option",{value:"",children:"Select reason"}),e.jsx("option",{value:"defective",children:"Defective"}),e.jsx("option",{value:"wrong_item",children:"Wrong Item"}),e.jsx("option",{value:"not_as_described",children:"Not as Described"}),e.jsx("option",{value:"damaged_shipping",children:"Damaged in Shipping"}),e.jsx("option",{value:"changed_mind",children:"Changed Mind"}),e.jsx("option",{value:"duplicate_order",children:"Duplicate Order"}),e.jsx("option",{value:"size_issue",children:"Size Issue"}),e.jsx("option",{value:"quality_issue",children:"Quality Issue"}),e.jsx("option",{value:"late_delivery",children:"Late Delivery"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Condition *"}),e.jsxs("select",{value:t.condition,onChange:N=>m(a,"condition",N.target.value),className:"input",required:!0,children:[e.jsx("option",{value:"",children:"Select condition"}),e.jsx("option",{value:"new",children:"New"}),e.jsx("option",{value:"like_new",children:"Like New"}),e.jsx("option",{value:"good",children:"Good"}),e.jsx("option",{value:"fair",children:"Fair"}),e.jsx("option",{value:"poor",children:"Poor"}),e.jsx("option",{value:"damaged",children:"Damaged"})]})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Return Reason Details"}),e.jsx("textarea",{value:t.returnReasonDetail,onChange:N=>m(a,"returnReasonDetail",N.target.value),placeholder:"Additional details about the return reason...",className:"input",rows:2})]})]},a)})})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Refund Method"}),e.jsxs("select",{value:u.refundMethod,onChange:t=>y(a=>({...a,refundMethod:t.target.value})),className:"input",children:[e.jsx("option",{value:"original_payment",children:"Original Payment Method"}),e.jsx("option",{value:"store_credit",children:"Store Credit"}),e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"check",children:"Check"}),e.jsx("option",{value:"bank_transfer",children:"Bank Transfer"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),e.jsx("textarea",{value:u.generalNotes,onChange:t=>y(a=>({...a,generalNotes:t.target.value})),placeholder:"Additional notes about this return request...",className:"input",rows:3})]})]})]})}),x&&e.jsxs("div",{className:"flex justify-end space-x-3 p-5 border-t border-gray-200 bg-gray-50 flex-shrink-0",children:[e.jsx("button",{type:"button",onClick:r,className:"btn btn-secondary",children:"Cancel"}),e.jsx("button",{type:"submit",form:"return-form",disabled:q||!x||u.items.length===0,className:"btn btn-primary",children:q?e.jsx(ue,{size:"sm"}):"Create Return Request"})]})]})}):null},Nt=({return:l,isOpen:r,onClose:c,onStatusUpdate:o,onAddNote:j,onAddCommunication:u,isLoading:y})=>{var M,G,n,h,d,T,re,H,V,X,J,K,Z;const[x,v]=R.useState("details"),[A,E]=R.useState(!1),[$,P]=R.useState(!1),[_,F]=R.useState(!1),[w,ie]=R.useState(""),[L,f]=R.useState(""),[ae,U]=R.useState(""),[oe,de]=R.useState(!1),[q,Y]=R.useState({type:"email",message:"",recipient:""}),{data:z,isLoading:W}=He(l==null?void 0:l._id,{skip:!(l!=null&&l._id)||!r}),{data:m}=Ye(),p=(z==null?void 0:z.data)||z||l,ce=s=>{switch(s){case"pending":return e.jsx(Ae,{className:"h-5 w-5 text-yellow-500"});case"approved":return e.jsx(te,{className:"h-5 w-5 text-blue-500"});case"rejected":return e.jsx(Ce,{className:"h-5 w-5 text-red-500"});case"processing":return e.jsx(se,{className:"h-5 w-5 text-blue-500"});case"received":return e.jsx(se,{className:"h-5 w-5 text-green-500"});case"completed":return e.jsx(te,{className:"h-5 w-5 text-green-600"});case"cancelled":return e.jsx(Ce,{className:"h-5 w-5 text-gray-500"});default:return e.jsx(Se,{className:"h-5 w-5 text-gray-500"})}},ne=s=>{switch(s){case"pending":return"bg-yellow-100 text-yellow-800";case"approved":return"bg-blue-100 text-blue-800";case"rejected":return"bg-red-100 text-red-800";case"processing":return"bg-blue-100 text-blue-800";case"received":return"bg-green-100 text-green-800";case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},me=s=>{switch(s){case"urgent":return"bg-red-100 text-red-800";case"high":return"bg-orange-100 text-orange-800";case"normal":return"bg-blue-100 text-blue-800";case"low":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},t=()=>{o(w,L),E(!1),ie(""),f("")},a=()=>{j(ae,oe),P(!1),U(""),de(!1)},g=()=>{u(q.type,q.message,q.recipient),F(!1),Y({type:"email",message:"",recipient:""})},N=()=>{var ee,pe,he,ge,be,je,ye,fe,k,O,Ne,ve,_e,Fe,Le,ze,Me,Oe;const s=window.open("","_blank"),i=p,Q=((ee=m==null?void 0:m.data)==null?void 0:ee.companyName)||(m==null?void 0:m.companyName)||"Your Company Name",le=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Return Document - ${i.returnNumber}</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 10px; font-size: 12px; }
          .header { text-align: center; margin-bottom: 15px; border-bottom: 1px solid #333; padding-bottom: 10px; }
          .company-name { font-size: 16px; font-weight: bold; color: #333; }
          .document-title { font-size: 14px; color: #666; margin-top: 5px; }
          .return-info { margin-bottom: 15px; }
          .info-row { display: flex; justify-content: space-between; margin-bottom: 3px; padding: 2px 0; border-bottom: 1px solid #eee; font-size: 11px; }
          .info-label { font-weight: bold; color: #333; }
          .info-value { color: #666; }
          .items-table { width: 100%; border-collapse: collapse; margin: 10px 0; font-size: 10px; }
          .items-table th, .items-table td { border: 1px solid #ddd; padding: 4px; text-align: left; }
          .items-table th { background-color: #f5f5f5; font-weight: bold; font-size: 10px; }
          .items-table tr:nth-child(even) { background-color: #f9f9f9; }
          .totals { margin-top: 15px; text-align: right; }
          .total-row { display: flex; justify-content: space-between; margin-bottom: 3px; padding: 2px 0; font-size: 11px; }
          .total-label { font-weight: bold; }
          .total-value { font-weight: bold; font-size: 12px; }
          .footer { margin-top: 20px; text-align: center; color: #666; font-size: 10px; }
          @media print {
            body { margin: 5px; font-size: 10px; }
            .no-print { display: none; }
          }
        </style>
      </head>
      <body>
        <div class="header">
          <div class="company-name">${Q}</div>
          <div class="company-details" style="font-size: 10px; color: #666; margin-top: 5px;">
            ${((pe=m==null?void 0:m.data)==null?void 0:pe.address)||(m==null?void 0:m.address)||""} | ${((he=m==null?void 0:m.data)==null?void 0:he.contactNumber)||(m==null?void 0:m.contactNumber)||""} | ${((ge=m==null?void 0:m.data)==null?void 0:ge.email)||(m==null?void 0:m.email)||""}
          </div>
          <div class="document-title">RETURN DOCUMENT</div>
        </div>
        
        <div class="return-info" style="display: flex; gap: 20px; margin-bottom: 15px;">
          <div style="flex: 1;">
            <h3 style="color: #333; margin-bottom: 8px; font-size: 12px; border-bottom: 1px solid #ddd; padding-bottom: 3px;">CUSTOMER DETAILS</h3>
            <div class="info-row">
              <span class="info-label">Customer Name:</span>
              <span class="info-value">${(be=i.customer)!=null&&be.firstName&&((je=i.customer)!=null&&je.lastName)?`${i.customer.firstName} ${i.customer.lastName}`:((ye=i.customer)==null?void 0:ye.name)||((fe=i.customer)==null?void 0:fe.businessName)||"N/A"}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Email:</span>
              <span class="info-value">${((k=i.customer)==null?void 0:k.email)||"N/A"}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Phone:</span>
              <span class="info-value">${((O=i.customer)==null?void 0:O.phone)||"N/A"}</span>
            </div>
          </div>
          <div style="flex: 1;">
            <h3 style="color: #333; margin-bottom: 8px; font-size: 12px; border-bottom: 1px solid #ddd; padding-bottom: 3px;">RETURN DETAILS</h3>
            <div class="info-row">
              <span class="info-label">Return Number:</span>
              <span class="info-value">${i.returnNumber}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Original Order:</span>
              <span class="info-value">${((Ne=i.originalOrder)==null?void 0:Ne.orderNumber)||"N/A"}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Status:</span>
              <span class="info-value">${((ve=i.status)==null?void 0:ve.toUpperCase())||"PENDING"}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Priority:</span>
              <span class="info-value">${((_e=i.priority)==null?void 0:_e.toUpperCase())||"NORMAL"}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Return Date:</span>
              <span class="info-value">${new Date(i.returnDate).toLocaleDateString()}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Refund Method:</span>
              <span class="info-value">${((Fe=i.refundMethod)==null?void 0:Fe.replace("_"," ").toUpperCase())||"ORIGINAL PAYMENT"}</span>
            </div>
          </div>
        </div>
        
        <table class="items-table">
          <thead>
            <tr>
              <th>Product</th>
              <th>Quantity</th>
              <th>Original Price</th>
              <th>Return Reason</th>
              <th>Condition</th>
              <th>Refund Amount</th>
              <th>Restocking Fee</th>
            </tr>
          </thead>
          <tbody>
            ${((Le=i.items)==null?void 0:Le.map(D=>{var B,Ee,qe;return`
              <tr>
                <td>${((B=D.product)==null?void 0:B.name)||"N/A"}</td>
                <td>${D.quantity||0}</td>
                <td>$${(D.originalPrice||0).toFixed(2)}</td>
                <td>${((Ee=D.returnReason)==null?void 0:Ee.replace("_"," ").toUpperCase())||"N/A"}</td>
                <td>${((qe=D.condition)==null?void 0:qe.toUpperCase())||"N/A"}</td>
                <td>$${(D.refundAmount||0).toFixed(2)}</td>
                <td>$${(D.restockingFee||0).toFixed(2)}</td>
              </tr>
            `}).join(""))||'<tr><td colspan="7">No items found</td></tr>'}
          </tbody>
        </table>
        
        <div class="totals">
          <div class="total-row">
            <span class="total-label">Total Refund Amount:</span>
            <span class="total-value">$${i.totalRefundAmount?i.totalRefundAmount.toFixed(2):i.items?i.items.reduce((D,B)=>D+(B.refundAmount||0),0).toFixed(2):"0.00"}</span>
          </div>
          <div class="total-row">
            <span class="total-label">Total Restocking Fee:</span>
            <span class="total-value">$${i.totalRestockingFee?i.totalRestockingFee.toFixed(2):i.items?i.items.reduce((D,B)=>D+(B.restockingFee||0),0).toFixed(2):"0.00"}</span>
          </div>
          <div class="total-row">
            <span class="total-label">Net Refund Amount:</span>
            <span class="total-value">$${i.netRefundAmount?i.netRefundAmount.toFixed(2):i.items?(i.items.reduce((D,B)=>D+(B.refundAmount||0),0)-i.items.reduce((D,B)=>D+(B.restockingFee||0),0)).toFixed(2):"0.00"}</span>
          </div>
        </div>
        
        ${i.generalNotes?`
          <div style="margin-top: 30px;">
            <h3 style="color: #333; margin-bottom: 10px;">Notes:</h3>
            <p style="color: #666; line-height: 1.5;">${i.generalNotes}</p>
          </div>
        `:""}
        
        <div class="footer">
          <p>Generated on ${new Date().toLocaleString()}</p>
          <p>This is a computer-generated document.</p>
          <p style="margin-top: 10px; font-weight: bold;">${Q}</p>
          <p>${((ze=m==null?void 0:m.data)==null?void 0:ze.address)||""}</p>
          <p>Phone: ${((Me=m==null?void 0:m.data)==null?void 0:Me.contactNumber)||""} | Email: ${((Oe=m==null?void 0:m.data)==null?void 0:Oe.email)||""}</p>
        </div>
      </body>
      </html>
    `;s.document.write(le),s.document.close(),s.onload=()=>{s.print(),s.close()}},C=s=>{switch(s){case"pending":return["approved","rejected"];case"approved":return["processing","rejected"];case"processing":return["received","rejected"];case"received":return["completed","rejected"];default:return[]}};if(!r||!p)return null;const b=[{id:"details",label:"Details",icon:Ie},{id:"items",label:"Items",icon:se},{id:"notes",label:"Notes",icon:Ge},{id:"communication",label:"Communication",icon:ke}],S=C(p.status);return e.jsxs("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:[e.jsxs("div",{className:"relative top-10 mx-auto p-5 border w-11/12 max-w-6xl shadow-lg rounded-md bg-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-medium text-gray-900",children:["Return ",p.returnNumber]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Created ",new Date(p.returnDate).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:N,className:"text-gray-400 hover:text-gray-600",title:"Print Return Document",children:e.jsx(We,{className:"h-6 w-6"})}),e.jsx("button",{onClick:c,className:"text-gray-400 hover:text-gray-600",children:e.jsx(I,{className:"h-6 w-6"})})]})]}),e.jsxs("div",{className:"flex items-center justify-between mb-6 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${ne(p.status)}`,children:[ce(p.status),e.jsx("span",{className:"ml-2 capitalize",children:p.status})]}),e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${me(p.priority)}`,children:[p.priority||"normal"," priority"]})]}),S.length>0&&e.jsx("div",{className:"flex space-x-2",children:S.map(s=>e.jsxs("button",{onClick:()=>{ie(s),E(!0)},disabled:y,className:`btn btn-sm ${s==="approved"||s==="completed"?"btn-primary":s==="rejected"?"btn-danger":"btn-secondary"}`,children:[s==="approved"&&e.jsx(te,{className:"h-4 w-4 mr-1"}),s==="rejected"&&e.jsx(Ce,{className:"h-4 w-4 mr-1"}),s==="processing"&&e.jsx(se,{className:"h-4 w-4 mr-1"}),s==="received"&&e.jsx(se,{className:"h-4 w-4 mr-1"}),s==="completed"&&e.jsx(te,{className:"h-4 w-4 mr-1"}),s.charAt(0).toUpperCase()+s.slice(1)]},s))})]}),e.jsx("div",{className:"border-b border-gray-200 mb-6",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:b.map(s=>{const i=s.icon;return e.jsxs("button",{onClick:()=>v(s.id),className:`flex items-center py-2 px-1 border-b-2 font-medium text-sm ${x===s.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(i,{className:"h-4 w-4 mr-2"}),s.label]},s.id)})})}),e.jsxs("div",{className:"min-h-[400px]",children:[x==="details"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Customer Information"})}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ue,{className:"h-5 w-5 text-gray-400 mr-3"}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:[(M=p.customer)==null?void 0:M.firstName," ",(G=p.customer)==null?void 0:G.lastName]}),e.jsx("div",{className:"text-sm text-gray-500",children:(n=p.customer)==null?void 0:n.email})]})]}),((h=p.customer)==null?void 0:h.phone)&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(ke,{className:"h-5 w-5 text-gray-400 mr-3"}),e.jsx("span",{children:p.customer.phone})]})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Order Information"})}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ie,{className:"h-5 w-5 text-gray-400 mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:(d=p.originalOrder)==null?void 0:d.orderNumber}),e.jsx("div",{className:"text-sm text-gray-500",children:"Original order"})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(De,{className:"h-5 w-5 text-gray-400 mr-3"}),e.jsx("span",{children:new Date((T=p.originalOrder)==null?void 0:T.createdAt).toLocaleDateString()})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Te,{className:"h-5 w-5 text-gray-400 mr-3"}),e.jsx("span",{children:(H=(re=p.originalOrder)==null?void 0:re.total)==null?void 0:H.toFixed(2)})]})]})})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Return Details"})}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Return Type"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900 capitalize",children:p.returnType})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Refund Method"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900 capitalize",children:(V=p.refundMethod)==null?void 0:V.replace("_"," ")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Total Refund"}),e.jsxs("p",{className:"mt-1 text-lg font-semibold text-gray-900",children:["$",((X=p.netRefundAmount)==null?void 0:X.toFixed(2))||"0.00"]})]})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Timeline"})}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx(Ae,{className:"h-4 w-4 text-blue-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Return Requested"}),e.jsx("p",{className:"text-sm text-gray-500",children:new Date(p.returnDate).toLocaleString()})]})]}),p.approvalDate&&e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"h-8 w-8 rounded-full bg-green-100 flex items-center justify-center",children:e.jsx(te,{className:"h-4 w-4 text-green-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Approved"}),e.jsx("p",{className:"text-sm text-gray-500",children:new Date(p.approvalDate).toLocaleString()})]})]}),p.completionDate&&e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"h-8 w-8 rounded-full bg-green-100 flex items-center justify-center",children:e.jsx(te,{className:"h-4 w-4 text-green-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Completed"}),e.jsx("p",{className:"text-sm text-gray-500",children:new Date(p.completionDate).toLocaleString()})]})]})]})})]})]}),x==="items"&&e.jsx("div",{className:"space-y-4",children:(J=p.items)==null?void 0:J.map((s,i)=>{var Q,le,ee;return e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:(Q=s.product)==null?void 0:Q.name})}),e.jsxs("div",{className:"card-content",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Quantity"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:s.quantity})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Return Reason"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900 capitalize",children:(le=s.returnReason)==null?void 0:le.replace("_"," ")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Condition"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900 capitalize",children:s.condition})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Refund Amount"}),e.jsxs("p",{className:"mt-1 text-sm font-semibold text-gray-900",children:["$",((ee=s.refundAmount)==null?void 0:ee.toFixed(2))||"0.00"]})]})]}),s.returnReasonDetail&&e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Reason Details"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:s.returnReasonDetail})]})]})]},i)})}),x==="notes"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Notes"}),e.jsxs("button",{onClick:()=>P(!0),className:"btn btn-primary btn-sm",children:[e.jsx(it,{className:"h-4 w-4 mr-1"}),"Add Note"]})]}),((K=p.notes)==null?void 0:K.length)>0?e.jsx("div",{className:"space-y-3",children:p.notes.map((s,i)=>e.jsxs("div",{className:`p-3 rounded-lg ${s.isInternal?"bg-blue-50":"bg-gray-50"}`,children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("p",{className:"text-sm text-gray-900",children:s.note}),e.jsx("div",{className:"text-xs text-gray-500 ml-3",children:new Date(s.addedAt).toLocaleDateString()})]}),s.addedBy&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Added by ",s.addedBy.firstName," ",s.addedBy.lastName,s.isInternal&&" (Internal)"]})]},i))}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Ge,{className:"mx-auto h-12 w-12 text-gray-400 mb-2"}),e.jsx("p",{children:"No notes added yet"})]})]}),x==="communication"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Communication Log"}),e.jsxs("button",{onClick:()=>F(!0),className:"btn btn-primary btn-sm",children:[e.jsx(ct,{className:"h-4 w-4 mr-1"}),"Log Communication"]})]}),((Z=p.communication)==null?void 0:Z.length)>0?e.jsx("div",{className:"space-y-3",children:p.communication.map((s,i)=>e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[s.type==="email"&&e.jsx(tt,{className:"h-4 w-4 text-gray-400"}),s.type==="phone"&&e.jsx(ke,{className:"h-4 w-4 text-gray-400"}),s.type==="in_person"&&e.jsx(Ue,{className:"h-4 w-4 text-gray-400"}),s.type==="system"&&e.jsx(Se,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 capitalize",children:s.type.replace("_"," ")}),s.recipient&&e.jsxs("span",{className:"text-sm text-gray-500",children:["to ",s.recipient]})]}),e.jsx("p",{className:"text-sm text-gray-900 mt-1",children:s.message})]}),e.jsx("div",{className:"text-xs text-gray-500 ml-3",children:new Date(s.sentAt).toLocaleDateString()})]}),s.sentBy&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Sent by ",s.sentBy.firstName," ",s.sentBy.lastName]})]},i))}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(ke,{className:"mx-auto h-12 w-12 text-gray-400 mb-2"}),e.jsx("p",{children:"No communication logged yet"})]})]})]}),e.jsx("div",{className:"flex justify-end space-x-3 pt-6 border-t",children:e.jsx("button",{onClick:c,className:"btn btn-secondary",children:"Close"})})]}),A&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-60",children:e.jsxs("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h4",{className:"text-lg font-medium text-gray-900",children:["Update Status to ",w.charAt(0).toUpperCase()+w.slice(1)]}),e.jsx("button",{onClick:()=>E(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(I,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes (Optional)"}),e.jsx("textarea",{value:L,onChange:s=>f(s.target.value),placeholder:"Add any notes about this status change...",className:"input",rows:3})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>E(!1),className:"btn btn-secondary",children:"Cancel"}),e.jsx("button",{onClick:t,disabled:y,className:`btn ${w==="approved"||w==="completed"?"btn-primary":w==="rejected"?"btn-danger":"btn-secondary"}`,children:y?e.jsx(ue,{size:"sm"}):"Update Status"})]})]})}),$&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-60",children:e.jsxs("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Add Note"}),e.jsx("button",{onClick:()=>P(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(I,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Note"}),e.jsx("textarea",{value:ae,onChange:s=>U(s.target.value),placeholder:"Enter your note...",className:"input",rows:4,required:!0})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:oe,onChange:s=>de(s.target.checked),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Internal note (not visible to customer)"})]})}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>P(!1),className:"btn btn-secondary",children:"Cancel"}),e.jsx("button",{onClick:a,disabled:y||!ae.trim(),className:"btn btn-primary",children:y?e.jsx(ue,{size:"sm"}):"Add Note"})]})]})}),_&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-60",children:e.jsxs("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Log Communication"}),e.jsx("button",{onClick:()=>F(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(I,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type"}),e.jsxs("select",{value:q.type,onChange:s=>Y(i=>({...i,type:s.target.value})),className:"input",children:[e.jsx("option",{value:"email",children:"Email"}),e.jsx("option",{value:"phone",children:"Phone"}),e.jsx("option",{value:"in_person",children:"In Person"}),e.jsx("option",{value:"system",children:"System"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message"}),e.jsx("textarea",{value:q.message,onChange:s=>Y(i=>({...i,message:s.target.value})),placeholder:"Enter communication details...",className:"input",rows:4,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Recipient (Optional)"}),e.jsx("input",{type:"text",value:q.recipient,onChange:s=>Y(i=>({...i,recipient:s.target.value})),placeholder:"e.g., customer email or phone",className:"input"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{onClick:()=>F(!1),className:"btn btn-secondary",children:"Cancel"}),e.jsx("button",{onClick:g,disabled:y||!q.message.trim(),className:"btn btn-primary",children:y?e.jsx(ue,{size:"sm"}):"Log Communication"})]})]})})]})},$e=({title:l,value:r,icon:c,color:o="blue",subtitle:j,trend:u})=>{const y={blue:"bg-blue-50 text-blue-600",green:"bg-green-50 text-green-600",yellow:"bg-yellow-50 text-yellow-600",red:"bg-red-50 text-red-600",purple:"bg-purple-50 text-purple-600",indigo:"bg-indigo-50 text-indigo-600",pink:"bg-pink-50 text-pink-600",gray:"bg-gray-50 text-gray-600"};return e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:`p-3 rounded-md ${y[o]}`,children:c})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:l}),e.jsxs("dd",{className:"flex items-baseline",children:[e.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:r}),u&&e.jsxs("div",{className:`ml-2 flex items-baseline text-sm font-semibold ${u.direction==="up"?"text-green-600":"text-red-600"}`,children:[u.direction==="up"?e.jsx("svg",{className:"self-center flex-shrink-0 h-5 w-5 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 9.707a1 1 0 010-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 01-1.414 1.414L11 7.414V15a1 1 0 11-2 0V7.414L6.707 9.707a1 1 0 01-1.414 0z",clipRule:"evenodd"})}):e.jsx("svg",{className:"self-center flex-shrink-0 h-5 w-5 text-red-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M14.707 10.293a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 111.414-1.414L9 12.586V5a1 1 0 012 0v7.586l2.293-2.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),e.jsxs("span",{className:"sr-only",children:[u.direction==="up"?"Increased":"Decreased"," by"]}),u.percentage,"%"]})]}),j&&e.jsx("dd",{className:"text-sm text-gray-500",children:j})]})})]})})})},vt=({filters:l,onFilterChange:r,isLoading:c})=>{const[o,j]=R.useState(!1),u=(v,A)=>{r({[v]:A})},y=()=>{r({status:"",returnType:"",priority:"",search:"",startDate:"",endDate:"",page:1})},x=l.status||l.returnType||l.priority||l.search||l.startDate||l.endDate;return e.jsx("div",{className:"bg-white shadow rounded-lg",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Filters"}),x&&e.jsxs("button",{onClick:y,className:"text-sm text-gray-500 hover:text-gray-700 flex items-center",children:[e.jsx(I,{className:"h-4 w-4 mr-1"}),"Clear filters"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(Be,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Return #, customer...",value:l.search,onChange:v=>u("search",v.target.value),className:"input pl-10",disabled:c})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:l.status,onChange:v=>u("status",v.target.value),className:"input",disabled:c,children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"}),e.jsx("option",{value:"processing",children:"Processing"}),e.jsx("option",{value:"received",children:"Received"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),e.jsxs("select",{value:l.returnType,onChange:v=>u("returnType",v.target.value),className:"input",disabled:c,children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"return",children:"Return"}),e.jsx("option",{value:"exchange",children:"Exchange"}),e.jsx("option",{value:"warranty",children:"Warranty"}),e.jsx("option",{value:"recall",children:"Recall"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),e.jsxs("select",{value:l.priority,onChange:v=>u("priority",v.target.value),className:"input",disabled:c,children:[e.jsx("option",{value:"",children:"All Priorities"}),e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"normal",children:"Normal"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"urgent",children:"Urgent"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4 border-t pt-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[e.jsx(De,{className:"inline h-4 w-4 mr-1"}),"From Date"]}),e.jsx("input",{type:"date",value:l.startDate,onChange:v=>u("startDate",v.target.value),className:"input",disabled:c})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[e.jsx(De,{className:"inline h-4 w-4 mr-1"}),"To Date"]}),e.jsx("input",{type:"date",value:l.endDate,onChange:v=>u("endDate",v.target.value),className:"input",disabled:c})]})]}),x&&e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[l.status&&e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:["Status: ",l.status,e.jsx("button",{onClick:()=>u("status",""),className:"ml-1.5 inline-flex items-center justify-center w-4 h-4 rounded-full text-blue-400 hover:bg-blue-200 hover:text-blue-500",children:e.jsx(I,{className:"h-3 w-3"})})]}),l.returnType&&e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:["Type: ",l.returnType,e.jsx("button",{onClick:()=>u("returnType",""),className:"ml-1.5 inline-flex items-center justify-center w-4 h-4 rounded-full text-green-400 hover:bg-green-200 hover:text-green-500",children:e.jsx(I,{className:"h-3 w-3"})})]}),l.priority&&e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800",children:["Priority: ",l.priority,e.jsx("button",{onClick:()=>u("priority",""),className:"ml-1.5 inline-flex items-center justify-center w-4 h-4 rounded-full text-orange-400 hover:bg-orange-200 hover:text-orange-500",children:e.jsx(I,{className:"h-3 w-3"})})]}),l.search&&e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:["Search: ",l.search,e.jsx("button",{onClick:()=>u("search",""),className:"ml-1.5 inline-flex items-center justify-center w-4 h-4 rounded-full text-purple-400 hover:bg-purple-200 hover:text-purple-500",children:e.jsx(I,{className:"h-3 w-3"})})]}),(l.startDate||l.endDate)&&e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:["Date: ",l.startDate||"Start"," - ",l.endDate||"End",e.jsx("button",{onClick:()=>{u("startDate",""),u("endDate","")},className:"ml-1.5 inline-flex items-center justify-center w-4 h-4 rounded-full text-gray-400 hover:bg-gray-200 hover:text-gray-500",children:e.jsx(I,{className:"h-3 w-3"})})]})]})]})})},wt=(l=new Date)=>{const r=l.getFullYear(),c=String(l.getMonth()+1).padStart(2,"0"),o=String(l.getDate()).padStart(2,"0");return`${r}-${c}-${o}`},zt=()=>{var M,G;const l=wt(),[r,c]=R.useState({page:1,limit:10,status:"",returnType:"",priority:"",search:"",startDate:l,endDate:l}),[o,j]=R.useState(null),[u,y]=R.useState(!1),[x,v]=R.useState("sales"),[A,E]=R.useState(!1);st();const{data:$,isLoading:P,error:_,refetch:F}=xt(r,{onError:n=>{xe(n,"Fetch Returns")}}),{data:w,isLoading:ie}=bt(r.startDate&&r.endDate?{startDate:r.startDate,endDate:r.endDate}:{}),{data:L}=Ye(),f=(L==null?void 0:L.data)||L,[ae]=pt(),[U]=yt(),oe=async(n,h,d)=>{try{await ae({returnId:n,status:h,notes:d}).unwrap(),Re(`Return status updated to ${h}`),E(!1),j(null),F()}catch(T){xe(T,"Update Return Status")}},[de]=ht(),q=async(n,h,d)=>{try{await de({returnId:n,note:h,isInternal:d}).unwrap(),Re("Note added successfully"),F()}catch(T){xe(T,"Add Note")}},Y=async n=>{try{await U(n).unwrap(),Re("Return deleted successfully"),F()}catch(h){xe(h,"Delete Return")}},z=n=>{c(h=>({...h,...n,page:1}))},{data:W}=He(o==null?void 0:o._id,{skip:!(o!=null&&o._id)}),m=n=>{j({_id:n}),E(!0)};at.useEffect(()=>{W!=null&&W.data&&j(W.data)},[W]);const p=async(n,h="")=>{o&&await oe(o._id,n,h)},[ce]=gt(),ne=async(n,h,d=null)=>{if(o)try{await ce({returnId:o._id,type:n,message:h,recipient:d}).unwrap(),Re("Communication logged successfully"),F()}catch(T){xe(T,"Add Communication")}},me=async n=>{window.confirm("Are you sure you want to delete this return? This action cannot be undone.")&&await Y(n)},t=n=>{var H,V,X,J,K,Z,s,i,Q,le,ee,pe,he,ge,be,je,ye,fe;const h=window.open("","_blank"),d=n,T=((H=f==null?void 0:f.data)==null?void 0:H.companyName)||"Your Company Name",re=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Return Document - ${d.returnNumber}</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 10px; font-size: 12px; }
          .header { text-align: center; margin-bottom: 15px; border-bottom: 1px solid #333; padding-bottom: 10px; }
          .company-name { font-size: 16px; font-weight: bold; color: #333; }
          .document-title { font-size: 14px; color: #666; margin-top: 5px; }
          .return-info { margin-bottom: 15px; }
          .info-row { display: flex; justify-content: space-between; margin-bottom: 3px; padding: 2px 0; border-bottom: 1px solid #eee; font-size: 11px; }
          .info-label { font-weight: bold; color: #333; }
          .info-value { color: #666; }
          .items-table { width: 100%; border-collapse: collapse; margin: 10px 0; font-size: 10px; }
          .items-table th, .items-table td { border: 1px solid #ddd; padding: 4px; text-align: left; }
          .items-table th { background-color: #f5f5f5; font-weight: bold; font-size: 10px; }
          .items-table tr:nth-child(even) { background-color: #f9f9f9; }
          .totals { margin-top: 15px; text-align: right; }
          .total-row { display: flex; justify-content: space-between; margin-bottom: 3px; padding: 2px 0; font-size: 11px; }
          .total-label { font-weight: bold; }
          .total-value { font-weight: bold; font-size: 12px; }
          .footer { margin-top: 20px; text-align: center; color: #666; font-size: 10px; }
          @media print {
            body { margin: 5px; font-size: 10px; }
            .no-print { display: none; }
          }
        </style>
      </head>
      <body>
        <div class="header">
          <div class="company-name">${T}</div>
          <div class="company-details" style="font-size: 10px; color: #666; margin-top: 5px;">
            ${((V=f==null?void 0:f.data)==null?void 0:V.address)||""} | ${((X=f==null?void 0:f.data)==null?void 0:X.contactNumber)||""} | ${((J=f==null?void 0:f.data)==null?void 0:J.email)||""}
          </div>
          <div class="document-title">RETURN DOCUMENT</div>
        </div>
        
        <div class="return-info" style="display: flex; gap: 20px; margin-bottom: 15px;">
          <div style="flex: 1;">
            <h3 style="color: #333; margin-bottom: 8px; font-size: 12px; border-bottom: 1px solid #ddd; padding-bottom: 3px;">CUSTOMER DETAILS</h3>
            <div class="info-row">
              <span class="info-label">Customer Name:</span>
              <span class="info-value">${(K=d.customer)!=null&&K.firstName&&((Z=d.customer)!=null&&Z.lastName)?`${d.customer.firstName} ${d.customer.lastName}`:((s=d.customer)==null?void 0:s.name)||((i=d.customer)==null?void 0:i.businessName)||"N/A"}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Email:</span>
              <span class="info-value">${((Q=d.customer)==null?void 0:Q.email)||"N/A"}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Phone:</span>
              <span class="info-value">${((le=d.customer)==null?void 0:le.phone)||"N/A"}</span>
            </div>
          </div>
          <div style="flex: 1;">
            <h3 style="color: #333; margin-bottom: 8px; font-size: 12px; border-bottom: 1px solid #ddd; padding-bottom: 3px;">RETURN DETAILS</h3>
            <div class="info-row">
              <span class="info-label">Return Number:</span>
              <span class="info-value">${d.returnNumber}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Original Order:</span>
              <span class="info-value">${((ee=d.originalOrder)==null?void 0:ee.orderNumber)||"N/A"}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Status:</span>
              <span class="info-value">${((pe=d.status)==null?void 0:pe.toUpperCase())||"PENDING"}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Priority:</span>
              <span class="info-value">${((he=d.priority)==null?void 0:he.toUpperCase())||"NORMAL"}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Return Date:</span>
              <span class="info-value">${new Date(d.returnDate).toLocaleDateString()}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Refund Method:</span>
              <span class="info-value">${((ge=d.refundMethod)==null?void 0:ge.replace("_"," ").toUpperCase())||"ORIGINAL PAYMENT"}</span>
            </div>
          </div>
        </div>
        
        <table class="items-table">
          <thead>
            <tr>
              <th>Product</th>
              <th>Quantity</th>
              <th>Original Price</th>
              <th>Return Reason</th>
              <th>Condition</th>
              <th>Refund Amount</th>
              <th>Restocking Fee</th>
            </tr>
          </thead>
          <tbody>
            ${((be=d.items)==null?void 0:be.map(k=>{var O,Ne,ve;return`
              <tr>
                <td>${((O=k.product)==null?void 0:O.name)||"N/A"}</td>
                <td>${k.quantity||0}</td>
                <td>$${(k.originalPrice||0).toFixed(2)}</td>
                <td>${((Ne=k.returnReason)==null?void 0:Ne.replace("_"," ").toUpperCase())||"N/A"}</td>
                <td>${((ve=k.condition)==null?void 0:ve.toUpperCase())||"N/A"}</td>
                <td>$${(k.refundAmount||0).toFixed(2)}</td>
                <td>$${(k.restockingFee||0).toFixed(2)}</td>
              </tr>
            `}).join(""))||'<tr><td colspan="7">No items found</td></tr>'}
          </tbody>
        </table>
        
        <div class="totals">
          <div class="total-row">
            <span class="total-label">Total Refund Amount:</span>
            <span class="total-value">$${d.totalRefundAmount?d.totalRefundAmount.toFixed(2):d.items?d.items.reduce((k,O)=>k+(O.refundAmount||0),0).toFixed(2):"0.00"}</span>
          </div>
          <div class="total-row">
            <span class="total-label">Total Restocking Fee:</span>
            <span class="total-value">$${d.totalRestockingFee?d.totalRestockingFee.toFixed(2):d.items?d.items.reduce((k,O)=>k+(O.restockingFee||0),0).toFixed(2):"0.00"}</span>
          </div>
          <div class="total-row">
            <span class="total-label">Net Refund Amount:</span>
            <span class="total-value">$${d.netRefundAmount?d.netRefundAmount.toFixed(2):d.items?(d.items.reduce((k,O)=>k+(O.refundAmount||0),0)-d.items.reduce((k,O)=>k+(O.restockingFee||0),0)).toFixed(2):"0.00"}</span>
          </div>
        </div>
        
        ${d.generalNotes?`
          <div style="margin-top: 30px;">
            <h3 style="color: #333; margin-bottom: 10px;">Notes:</h3>
            <p style="color: #666; line-height: 1.5;">${d.generalNotes}</p>
          </div>
        `:""}
        
        <div class="footer">
          <p>Generated on ${new Date().toLocaleString()}</p>
          <p>This is a computer-generated document.</p>
          <p style="margin-top: 10px; font-weight: bold;">${T}</p>
          <p>${((je=f==null?void 0:f.data)==null?void 0:je.address)||""}</p>
          <p>Phone: ${((ye=f==null?void 0:f.data)==null?void 0:ye.contactNumber)||""} | Email: ${((fe=f==null?void 0:f.data)==null?void 0:fe.email)||""}</p>
        </div>
      </body>
      </html>
    `;h.document.write(re),h.document.close(),h.onload=()=>{h.print(),h.close()}},a=n=>{switch(n){case"pending":return e.jsx(Ae,{className:"h-4 w-4 text-yellow-500"});case"approved":return e.jsx(te,{className:"h-4 w-4 text-blue-500"});case"rejected":return e.jsx(Ce,{className:"h-4 w-4 text-red-500"});case"processing":return e.jsx(Qe,{className:"h-4 w-4 text-blue-500"});case"received":return e.jsx(se,{className:"h-4 w-4 text-green-500"});case"completed":return e.jsx(te,{className:"h-4 w-4 text-green-600"});case"cancelled":return e.jsx(Ce,{className:"h-4 w-4 text-gray-500"});default:return e.jsx(Se,{className:"h-4 w-4 text-gray-500"})}},g=n=>{switch(n){case"pending":return"bg-yellow-100 text-yellow-800";case"approved":return"bg-blue-100 text-blue-800";case"rejected":return"bg-red-100 text-red-800";case"processing":return"bg-blue-100 text-blue-800";case"received":return"bg-green-100 text-green-800";case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},N=n=>{switch(n){case"urgent":return"bg-red-100 text-red-800";case"high":return"bg-orange-100 text-orange-800";case"normal":return"bg-blue-100 text-blue-800";case"low":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}};if(P&&!$)return e.jsx(ue,{message:"Loading returns..."});const C=((M=$==null?void 0:$.data)==null?void 0:M.returns)||($==null?void 0:$.returns)||[],b=((G=$==null?void 0:$.data)==null?void 0:G.pagination)||($==null?void 0:$.pagination)||{},S=(w==null?void 0:w.data)||w||{totalReturns:0,pendingReturns:0,totalRefundAmount:0,returnRate:0};return e.jsxs(nt,{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Return Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage returns, exchanges, and refunds"})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("button",{onClick:()=>F(),className:"btn btn-secondary",children:[e.jsx(Qe,{className:"h-4 w-4 mr-2"}),"Refresh"]}),e.jsxs("button",{onClick:()=>{v("sales"),y(!0)},className:"btn btn-primary btn-md",children:[e.jsx(Pe,{className:"h-4 w-4 mr-2"}),"Create Sales Return"]}),e.jsxs("button",{onClick:()=>{v("purchase"),y(!0)},className:"btn btn-primary btn-md",children:[e.jsx(Pe,{className:"h-4 w-4 mr-2"}),"Create Purchase Return"]})]})]}),!ie&&e.jsxs(rt,{cols:{default:1,md:2,lg:4},gap:6,children:[e.jsx($e,{title:"Total Returns",value:S.totalReturns||0,icon:e.jsx(se,{className:"h-5 w-5"}),color:"blue"}),e.jsx($e,{title:"Pending Returns",value:S.pendingReturns||0,icon:e.jsx(Ae,{className:"h-5 w-5"}),color:"yellow"}),e.jsx($e,{title:"Total Refunds",value:`${(S.totalRefundAmount||0).toFixed(2)}`,icon:e.jsx(Te,{className:"h-5 w-5"}),color:"green"}),e.jsx($e,{title:"Return Rate",value:`${(S.returnRate||0).toFixed(1)}%`,icon:e.jsx(Te,{className:"h-5 w-5"}),color:"purple"})]}),e.jsx(vt,{filters:r,onFilterChange:z,isLoading:P}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Returns"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[b.total||0," total returns"]})]})}),e.jsx("div",{className:"card-content p-0",children:P?e.jsx(lt,{rows:5,cols:6}):C.length===0?e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsx(se,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("p",{className:"mt-2",children:"No returns found"}),e.jsx("p",{className:"text-sm",children:"Try adjusting your filters or create a new return"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Invoice Number"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Return #"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Priority"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:C.map(n=>{var h,d,T,re,H,V,X,J,K,Z,s,i,Q;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:new Date(n.returnDate).toLocaleDateString()}),e.jsx("div",{className:"text-sm text-gray-500",children:new Date(n.returnDate).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:n.origin==="purchase"?((h=n.supplier)==null?void 0:h.companyName)||((d=n.supplier)==null?void 0:d.name)||((T=n.supplier)==null?void 0:T.businessName)||"N/A":((re=n.customer)==null?void 0:re.name)||((H=n.customer)==null?void 0:H.businessName)||"N/A"}),e.jsx("div",{className:"text-sm text-gray-500",children:n.origin==="purchase"?((V=n.supplier)==null?void 0:V.email)||"N/A":((X=n.customer)==null?void 0:X.email)||"N/A"})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:((J=n.originalOrder)==null?void 0:J.orderNumber)||((K=n.originalOrder)==null?void 0:K.soNumber)||((Z=n.originalOrder)==null?void 0:Z.invoiceNumber)||((s=n.originalOrder)==null?void 0:s.poNumber)||"N/A"}),e.jsxs("div",{className:"text-sm text-gray-500",children:[((i=n.items)==null?void 0:i.length)||0," items"]})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:["$",((Q=n.netRefundAmount)==null?void 0:Q.toFixed(2))||"0.00"]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:n.returnNumber}),e.jsx("div",{className:"text-sm text-gray-500 capitalize",children:n.returnType})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${g(n.status)}`,children:[a(n.status),e.jsx("span",{className:"ml-1 capitalize",children:n.status})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${N(n.priority)}`,children:n.priority||"normal"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx("button",{onClick:()=>m(n._id),className:"text-blue-600 hover:text-blue-900",title:"View Return Details",children:e.jsx(ot,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>t(n),className:"text-gray-600 hover:text-gray-900",title:"Print Return Document",children:e.jsx(We,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>me(n._id),className:"text-red-600 hover:text-red-900",title:"Delete Return",disabled:!["pending","cancelled"].includes(n.status),children:e.jsx(dt,{className:"h-4 w-4"})})]})})]},n._id)})})]})})}),b.pages>1&&e.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[e.jsx("button",{onClick:()=>z({page:b.current-1}),disabled:!b.hasPrev,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),e.jsx("button",{onClick:()=>z({page:b.current+1}),disabled:!b.hasNext,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Showing"," ",e.jsx("span",{className:"font-medium",children:(b.current-1)*r.limit+1})," ","to"," ",e.jsx("span",{className:"font-medium",children:Math.min(b.current*r.limit,b.total)})," ","of"," ",e.jsx("span",{className:"font-medium",children:b.total})," ","results"]})}),e.jsx("div",{children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:[e.jsx("button",{onClick:()=>z({page:b.current-1}),disabled:!b.hasPrev,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),[...Array(b.pages)].map((n,h)=>e.jsx("button",{onClick:()=>z({page:h+1}),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${b.current===h+1?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:h+1},h+1)),e.jsx("button",{onClick:()=>z({page:b.current+1}),disabled:!b.hasNext,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})})]})]})]}),u&&e.jsx(ft,{isOpen:u,onClose:()=>y(!1),onSuccess:()=>{y(!1),F()},defaultReturnType:x}),A&&o&&e.jsx(Nt,{return:o,isOpen:A,onClose:()=>{E(!1),j(null)},onStatusUpdate:p,onAddNote:q,onAddCommunication:ne,isLoading:!1})]})};export{zt as default};
