import{r as i,bB as Fe,R as Q,d as Ue,bE as Oe,p as e,S as V,ad as H,a1 as Ie,U as ze,aH as Ke,s as qe,w as Z,x as he,y as ee,A as ae,B as ge,z as M}from"./index-QHzcgHe1.js";import{P as Ge}from"./PrintModal-C-XpLZIw.js";import{u as Qe}from"./suppliersApi-TtAmQji1.js";import{u as Ve}from"./chartOfAccountsApi-CmNpcq75.js";import{u as He}from"./banksApi-JqBGwRpS.js";import{D as Je}from"./download-ULFDWFy_.js";import{P as Ye}from"./plus-wthIFHeq.js";import{P as se}from"./phone-DmhyAe7y.js";import{S as We}from"./save-CQRiczmt.js";import{F as Xe}from"./filter-DkEczEi5.js";import{P as Ze}from"./printer-Dmqc0NC_.js";import{E as ea}from"./eye-D8xIUmp0.js";import{P as aa}from"./pen-square-D_ZZfkE6.js";import{T as sa}from"./trash-2-G7GOGhVq.js";import"./useCompanyInfo-CJ-A3-l8.js";import"./settingsApi-D-e2N-LC.js";const Ne=(S=new Date)=>{const h=S.getFullYear(),J=String(S.getMonth()+1).padStart(2,"0"),U=String(S.getDate()).padStart(2,"0");return`${h}-${J}-${U}`},Ca=()=>{var xe,ue,pe;const S=Ne(),[h,J]=i.useState({fromDate:S,toDate:S,voucherCode:"",amount:"",particular:""}),[U,be]=i.useState({page:1,limit:50}),[te,je]=i.useState({key:"date",direction:"desc"}),[fe,ne]=i.useState(!1),[B,re]=i.useState(null),[l,o]=i.useState({date:S,amount:"",particular:"",bank:"",transactionReference:"",supplier:"",customer:"",notes:""}),[n,E]=i.useState(null),[r,P]=i.useState(null),[x,_]=i.useState(null),[N,y]=i.useState(""),[b,v]=i.useState(""),[$,j]=i.useState(""),[d,O]=i.useState("supplier"),[I,L]=i.useState(-1),[z,A]=i.useState(-1),[K,D]=i.useState(-1),{data:c,isLoading:ye,error:le,refetch:Y}=Fe({...h,...U,sortConfig:te},{refetchOnMountOrArgChange:!0}),{data:w,isLoading:ta,error:na,refetch:ve}=Qe({search:"",limit:100},{refetchOnMountOrArgChange:!0}),R=Q.useMemo(()=>{var a;return((a=w==null?void 0:w.data)==null?void 0:a.suppliers)||(w==null?void 0:w.suppliers)||w||[]},[w]),{data:p,isLoading:ra,error:la,refetch:we}=Ue({search:"",limit:100},{refetchOnMountOrArgChange:!0}),q=Q.useMemo(()=>{var a;return((a=p==null?void 0:p.data)==null?void 0:a.customers)||(p==null?void 0:p.customers)||p||[]},[p]),{data:C,isLoading:Ce,error:ke}=He({isActive:!0},{refetchOnMountOrArgChange:!0}),Se=Q.useMemo(()=>{var a;return((a=C==null?void 0:C.data)==null?void 0:a.banks)||(C==null?void 0:C.banks)||C||[]},[C]),{data:g,isLoading:ca}=Ve({accountType:"expense",isActive:"true"},{refetchOnMountOrArgChange:!0}),f=Q.useMemo(()=>Array.isArray(g)?g:Array.isArray(g==null?void 0:g.data)?g.data:Array.isArray(g==null?void 0:g.accounts)?g.accounts:[],[g]);i.useEffect(()=>{if(n&&R.length>0){const a=R.find(t=>t._id===n._id);a&&(a.pendingBalance!==n.pendingBalance||a.advanceBalance!==n.advanceBalance||a.currentBalance!==n.currentBalance)&&E(a)}},[R]),i.useEffect(()=>{if(r&&q){const a=q.find(t=>t._id===r._id);a&&(a.pendingBalance!==r.pendingBalance||a.advanceBalance!==r.advanceBalance||a.currentBalance!==r.currentBalance)&&P(a)}},[p]);const[Be,{isLoading:ce}]=Oe(),W=()=>{o({date:Ne(),amount:"",particular:"",bank:"",transactionReference:"",supplier:"",customer:"",notes:""}),E(null),P(null),_(null),y(""),v(""),j(""),O("supplier"),L(-1),A(-1),D(-1)},ie=a=>{const t=R.find(s=>s._id===a);E(t),o(s=>({...s,supplier:a,customer:""})),P(null),v("")},de=a=>{const t=p==null?void 0:p.find(s=>s._id===a);P(t),o(s=>({...s,customer:a,supplier:""})),E(null),y("")},Ee=a=>{y(a),L(-1),a===""&&(E(null),o(t=>({...t,supplier:""})))},Pe=a=>{v(a),A(-1),a===""&&(P(null),o(t=>({...t,customer:""})))},oe=a=>{const t=f==null?void 0:f.find(s=>s._id===a);t&&(_(t),j(t.accountName||""),o(s=>({...s,particular:t.accountName||""})))},$e=a=>{j(a),D(-1),a===""&&(_(null),o(t=>({...t,particular:""})))},Le=a=>{const t=(f==null?void 0:f.filter(s=>(s.accountName||"").toLowerCase().includes($.toLowerCase())||(s.accountCode||"").includes($)))||[];if(!(!$||t.length===0))switch(a.key){case"ArrowDown":a.preventDefault(),D(s=>s<t.length-1?s+1:0);break;case"ArrowUp":a.preventDefault(),D(s=>s>0?s-1:t.length-1);break;case"Enter":if(a.preventDefault(),K>=0&&K<t.length){const s=t[K];oe(s._id),j(s.accountName||""),D(-1)}break;case"Escape":a.preventDefault(),j(""),D(-1);break}},Ae=a=>{const t=R.filter(s=>(s.companyName||s.name||s.displayName||"").toLowerCase().includes(N.toLowerCase())||(s.phone||"").includes(N)||(s.email||"").toLowerCase().includes(N.toLowerCase()));if(!(!N||t.length===0))switch(a.key){case"ArrowDown":a.preventDefault(),L(s=>s<t.length-1?s+1:0);break;case"ArrowUp":a.preventDefault(),L(s=>s>0?s-1:t.length-1);break;case"Enter":if(a.preventDefault(),I>=0&&I<t.length){const s=t[I];ie(s._id),y(s.displayName||s.companyName||s.name||""),L(-1)}break;case"Escape":a.preventDefault(),y(""),L(-1);break}},De=a=>{const t=(q||[]).filter(s=>(s.displayName||s.businessName||s.name||`${s.firstName||""} ${s.lastName||""}`.trim()||s.email||"").toLowerCase().includes(b.toLowerCase())||(s.phone||"").includes(b)||(s.email||"").toLowerCase().includes(b.toLowerCase()))||[];if(!(!b||t.length===0))switch(a.key){case"ArrowDown":a.preventDefault(),A(s=>s<t.length-1?s+1:0);break;case"ArrowUp":a.preventDefault(),A(s=>s>0?s-1:t.length-1);break;case"Enter":if(a.preventDefault(),z>=0&&z<t.length){const s=t[z],m=s.displayName||s.businessName||s.name||`${s.firstName||""} ${s.lastName||""}`.trim()||s.email||"";de(s._id),v(m),A(-1)}break;case"Escape":a.preventDefault(),v(""),A(-1);break}},F=(a,t)=>{J(s=>({...s,[a]:t})),be(s=>({...s,page:1}))},X=a=>{je(t=>({key:a,direction:t.key===a&&t.direction==="asc"?"desc":"asc"}))},Me=()=>{if(!l.amount||l.amount<=0){M("Please enter a valid amount");return}if(!l.bank){M("Please select a bank account");return}if(d==="expense"&&!x){M("Please select an expense account");return}if(d==="supplier"&&!n){M("Please select a supplier");return}if(d==="customer"&&!r){M("Please select a customer");return}const a={date:l.date,amount:parseFloat(l.amount),particular:l.particular||void 0,bank:l.bank,transactionReference:l.transactionReference||void 0,notes:l.notes||void 0};d==="supplier"&&l.supplier?a.supplier=l.supplier:d==="customer"&&l.customer&&(a.customer=l.customer),d==="expense"&&(x!=null&&x._id)&&(a.expenseAccount=x._id),Be(a).unwrap().then(()=>{W(),ge("Bank payment created successfully"),Y(),d==="customer"&&l.customer?we():d==="supplier"&&l.supplier&&ve()}).catch(t=>{M(ee(t))})},Re=async(a="csv")=>{try{const t={...h,...U,sortConfig:te};let s;a==="excel"?s=await exportExcelMutation(t).unwrap():a==="pdf"?s=await exportPDFMutation(t).unwrap():a==="json"?s=await exportJSONMutation(t).unwrap():s=await exportCSVMutation(t).unwrap();const m=(s==null?void 0:s.filename)||(a==="excel"?"bank_payments.xlsx":a==="pdf"?"bank_payments.pdf":a==="json"?"bank_payments.json":"bank_payments.csv"),u=await downloadFileMutation(m).unwrap(),T=u instanceof Blob?u:new Blob([u],{type:a==="excel"?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":a==="pdf"?"application/pdf":a==="json"?"application/json":"text/csv"}),G=URL.createObjectURL(T),k=document.createElement("a");k.href=G,k.download=m,document.body.appendChild(k),k.click(),document.body.removeChild(k),URL.revokeObjectURL(G),ge(`Exported bank payments as ${a.toUpperCase()}`)}catch(t){M(ee(t,"Bank Payments Export"))}},Te=a=>{const t={invoiceNumber:a.voucherCode,orderNumber:a.voucherCode,createdAt:a.date,invoiceDate:a.date,customer:a.customer||null,customerInfo:a.customer||null,supplier:a.supplier||null,pricing:{subtotal:a.amount||0,total:a.amount||0,discountAmount:0,taxAmount:0},total:a.amount||0,subtotal:a.amount||0,items:[],payment:{method:"Bank Transfer",status:"Paid",amountPaid:a.amount||0},notes:a.notes||a.particular||"",bankAccount:a.bank?`${a.bank.bankName} - ${a.bank.accountNumber}`:"",transactionReference:a.transactionReference||""};re(t),ne(!0)},me=((xe=c==null?void 0:c.data)==null?void 0:xe.bankPayments)||(c==null?void 0:c.bankPayments)||((ue=c==null?void 0:c.data)==null?void 0:ue.payments)||(c==null?void 0:c.payments)||[],_e=((pe=c==null?void 0:c.data)==null?void 0:pe.pagination)||(c==null?void 0:c.pagination)||{};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Bank Payments"}),e.jsx("p",{className:"text-gray-600",children:"Manage and view all bank payment transactions"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{onClick:Re,className:"btn btn-secondary flex items-center space-x-2",children:[e.jsx(Je,{className:"h-4 w-4"}),e.jsx("span",{children:"Export"})]}),e.jsxs("button",{onClick:W,className:"btn btn-primary btn-md",children:[e.jsx(Ye,{className:"h-4 w-4 mr-2"}),"New Payment"]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Payment Details"})}),e.jsxs("div",{className:"card-content",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Type"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",value:"supplier",checked:d==="supplier",onChange:a=>{O(a.target.value),P(null),_(null),v(""),j(""),o(t=>({...t,customer:"",particular:""}))},className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Supplier"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",value:"customer",checked:d==="customer",onChange:a=>{O(a.target.value),E(null),_(null),y(""),j(""),o(t=>({...t,supplier:"",particular:""}))},className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Customer"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",value:"expense",checked:d==="expense",onChange:a=>{O(a.target.value),E(null),P(null),y(""),v(""),o(t=>({...t,supplier:"",customer:"",particular:""}))},className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Expense"})]})]})]}),d==="supplier"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Supplier"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:N,onChange:a=>Ee(a.target.value),onKeyDown:Ae,className:"input w-full pr-10",placeholder:"Search or select supplier..."}),e.jsx(V,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"})]}),N&&e.jsx("div",{className:"mt-2 max-h-40 overflow-y-auto border border-gray-200 rounded-md bg-white shadow-lg",children:R.filter(a=>(a.companyName||a.name||a.displayName||"").toLowerCase().includes(N.toLowerCase())||(a.phone||"").includes(N)||(a.email||"").toLowerCase().includes(N.toLowerCase())).map((a,t)=>e.jsxs("div",{onClick:()=>{ie(a._id),y(a.displayName||a.companyName||a.name||""),L(-1)},className:`px-3 py-2 hover:bg-gray-100 cursor-pointer border-b border-gray-100 last:border-b-0 ${I===t?"bg-blue-50":""}`,children:[e.jsx("div",{className:"font-medium text-gray-900",children:a.displayName||a.companyName||a.name||"Unknown"}),e.jsx("div",{className:"text-sm text-gray-600 capitalize mt-0.5",children:a.businessType&&a.reliability?`${a.businessType} • ${a.reliability}`:a.businessType||a.reliability||""}),e.jsxs("div",{className:"flex items-center space-x-3 mt-1",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"text-gray-500",children:"Outstanding Balance:"})," ",e.jsxs("span",{className:`font-medium ${(a.pendingBalance||0)>0?"text-red-600":"text-green-600"}`,children:["$",Math.round(a.pendingBalance||0)]})]}),a.phone&&e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[e.jsx(se,{className:"h-3 w-3"}),e.jsx("span",{children:a.phone})]}),a.email&&e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[e.jsx(H,{className:"h-3 w-3"}),e.jsx("span",{children:a.email})]})]})]},a._id))}),n&&e.jsx("div",{className:"mt-3 bg-gray-50 border border-gray-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ie,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:n.displayName||n.companyName||n.name||"Unknown Supplier"}),e.jsx("p",{className:"text-sm text-gray-600 capitalize",children:n.businessType&&n.reliability?`${n.businessType} • ${n.reliability}`:n.businessType||n.reliability||"Supplier Information"}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Outstanding Balance:"}),e.jsxs("span",{className:`text-sm font-medium ${(n.pendingBalance||0)>0?"text-red-600":"text-green-600"}`,children:["$",Math.round(n.pendingBalance||0)]})]}),n.phone&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(se,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{className:"text-xs text-gray-500",children:n.phone})]}),n.email&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(H,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{className:"text-xs text-gray-500",children:n.email})]})]})]})]})})]}),d==="customer"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Customer"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:b,onChange:a=>Pe(a.target.value),onKeyDown:De,className:"input w-full pr-10",placeholder:"Search customers by name, email, or business..."}),e.jsx(V,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"})]}),b&&e.jsx("div",{className:"mt-2 max-h-40 overflow-y-auto border border-gray-200 rounded-md bg-white shadow-lg",children:(q||[]).filter(a=>(a.displayName||a.businessName||a.name||`${a.firstName||""} ${a.lastName||""}`.trim()||a.email||"").toLowerCase().includes(b.toLowerCase())||(a.phone||"").includes(b)||(a.email||"").toLowerCase().includes(b.toLowerCase())).map((a,t)=>{const s=a.pendingBalance||0,m=a.advanceBalance||0,u=s-m,T=u<0,G=s>0||m>0,k=a.displayName||a.businessName||a.name||`${a.firstName||""} ${a.lastName||""}`.trim()||a.email||"Unknown";return e.jsxs("div",{onClick:()=>{de(a._id),v(k),A(-1)},className:`px-3 py-2 hover:bg-gray-100 cursor-pointer border-b border-gray-100 last:border-b-0 ${z===t?"bg-blue-50":""}`,children:[e.jsx("div",{className:"font-medium text-gray-900",children:k}),e.jsx("div",{className:"text-sm text-gray-600 capitalize mt-0.5",children:a.businessType||""}),e.jsxs("div",{className:"flex items-center space-x-3 mt-1",children:[G&&e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"text-gray-500",children:T?"Payables:":"Receivables:"})," ",e.jsxs("span",{className:`font-medium ${T?"text-red-600":"text-green-600"}`,children:["$",Math.abs(u).toFixed(2)]})]}),a.phone&&e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[e.jsx(se,{className:"h-3 w-3"}),e.jsx("span",{children:a.phone})]}),a.email&&e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[e.jsx(H,{className:"h-3 w-3"}),e.jsx("span",{children:a.email})]})]})]},a._id)})}),r&&e.jsx("div",{className:"mt-3 bg-gray-50 border border-gray-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ze,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:r.displayName||r.businessName||r.name||`${r.firstName||""} ${r.lastName||""}`.trim()||r.email||"Unknown Customer"}),e.jsxs("p",{className:"text-sm text-gray-600 capitalize",children:[r.businessType?`${r.businessType} • `:"",r.phone||"No phone"]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[(()=>{const a=r.pendingBalance||0,t=r.advanceBalance||0,s=a-t,m=s<0,u=s>0;return a>0||t>0?e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:m?"Payables:":"Receivables:"}),e.jsxs("span",{className:`text-sm font-medium ${m?"text-red-600":u?"text-green-600":"text-gray-600"}`,children:["$",Math.abs(s).toFixed(2)]})]}):null})(),r.email&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(H,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{className:"text-xs text-gray-500",children:r.email})]})]})]})]})})]}),d==="expense"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Expense Account *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:x?x.accountName:$,onChange:a=>$e(a.target.value),onKeyDown:Le,onFocus:()=>{x&&j(x.accountName||"")},className:"input w-full pr-10",placeholder:"Search expense account (e.g., Rent Expense, Utilities Expense, etc.)",required:!0}),e.jsx(V,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"})]}),$&&!x&&e.jsx("div",{className:"mt-2 max-h-40 overflow-y-auto border border-gray-200 rounded-md bg-white shadow-lg",children:f==null?void 0:f.filter(a=>(a.accountName||"").toLowerCase().includes($.toLowerCase())||(a.accountCode||"").includes($)).map((a,t)=>e.jsxs("div",{onClick:()=>{oe(a._id),j(a.accountName||""),D(-1)},className:`px-3 py-2 hover:bg-gray-100 cursor-pointer border-b border-gray-100 last:border-b-0 ${K===t?"bg-blue-50":""}`,children:[e.jsx("div",{className:"font-medium text-gray-900",children:a.accountName||"Unknown"}),a.accountCode&&e.jsxs("div",{className:"text-sm text-gray-500",children:["Code: ",a.accountCode]})]},a._id))})]}),d==="expense"&&x&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Selected Expense Account"}),e.jsxs("div",{className:"px-3 py-2 bg-blue-50 border border-blue-200 rounded",children:[e.jsx("div",{className:"font-medium text-blue-900",children:x.accountName||"Unknown"}),x.accountCode&&e.jsxs("div",{className:"text-sm text-blue-700",children:["Code: ",x.accountCode]})]})]}),(n||r)&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Balance"}),e.jsxs("div",{className:"space-y-1",children:[d==="supplier"&&n&&e.jsxs(e.Fragment,{children:[n.pendingBalance>0&&e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-red-50 border border-red-200 rounded",children:[e.jsx("span",{className:"text-sm font-medium text-red-700",children:"Payables:"}),e.jsx("span",{className:"text-sm font-bold text-red-700",children:n.pendingBalance.toFixed(2)})]}),n.advanceBalance>0&&e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-green-50 border border-green-200 rounded",children:[e.jsx("span",{className:"text-sm font-medium text-green-700",children:"Advance:"}),e.jsx("span",{className:"text-sm font-bold text-green-700",children:n.advanceBalance.toFixed(2)})]}),n.pendingBalance===0&&n.advanceBalance===0&&e.jsx("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded text-sm text-gray-600 text-center",children:"No balance"}),n.pendingBalance>0&&n.advanceBalance>0&&e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-blue-50 border-2 border-blue-300 rounded",children:[e.jsx("span",{className:"text-sm font-bold text-blue-700",children:"Net Balance:"}),e.jsx("span",{className:`text-sm font-bold ${n.pendingBalance-n.advanceBalance>0?"text-red-700":"text-green-700"}`,children:(n.pendingBalance-n.advanceBalance).toFixed(2)})]})]}),d==="customer"&&r&&e.jsx(e.Fragment,{children:(()=>{const a=r.pendingBalance||0,t=r.advanceBalance||0,s=a-t,m=s<0,u=s>0;return a>0||t>0?e.jsxs("div",{className:`flex items-center justify-between px-3 py-2 rounded ${m?"bg-red-50 border border-red-200":u?"bg-green-50 border border-green-200":"bg-gray-50 border border-gray-200"}`,children:[e.jsx("span",{className:`text-sm font-medium ${m?"text-red-700":u?"text-green-700":"text-gray-700"}`,children:m?"Payables:":u?"Receivables:":"Balance:"}),e.jsx("span",{className:`text-sm font-bold ${m?"text-red-700":u?"text-green-700":"text-gray-700"}`,children:Math.abs(s).toFixed(2)})]}):e.jsx("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded text-sm text-gray-600 text-center",children:"No balance"})})()})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Amount *"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:l.amount,onChange:a=>{const t=a.target.value===""?"":parseFloat(a.target.value)||"";o(s=>({...s,amount:t}))},className:"input w-full",placeholder:"0.00",required:!0})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Date"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"date",value:l.date,onChange:a=>o(t=>({...t,date:a.target.value})),className:"input w-full pr-10"}),e.jsx(Ke,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bank Account *"}),e.jsxs("select",{value:l.bank,onChange:a=>o(t=>({...t,bank:a.target.value})),className:"input w-full",required:!0,children:[e.jsx("option",{value:"",children:"Select bank account..."}),(Se||[]).map(a=>e.jsxs("option",{value:a._id,children:[a.bankName," - ",a.accountNumber," ",a.accountName?`(${a.accountName})`:""]},a._id))]}),Ce&&e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Loading banks..."}),ke&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:"Error loading banks"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Transaction Reference"}),e.jsx("input",{type:"text",value:l.transactionReference,onChange:a=>o(t=>({...t,transactionReference:a.target.value})),className:"input w-full",placeholder:"Enter transaction reference..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("input",{type:"text",value:l.particular,onChange:a=>o(t=>({...t,particular:a.target.value})),className:"input w-full",placeholder:"Enter payment description or notes..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes (Optional)"}),e.jsx("textarea",{value:l.notes,onChange:a=>o(t=>({...t,notes:a.target.value})),className:"input w-full h-20 resize-none",placeholder:"Additional notes..."})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6 pt-4 border-t border-gray-200",children:[e.jsxs("button",{onClick:W,className:"btn btn-secondary flex items-center space-x-2",children:[e.jsx(qe,{className:"h-4 w-4"}),e.jsx("span",{children:"Reset"})]}),e.jsxs("button",{onClick:Me,disabled:ce,className:"btn btn-primary flex items-center space-x-2",children:[e.jsx(We,{className:"h-4 w-4"}),e.jsx("span",{children:ce?"Saving...":"Save Payment"})]})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Xe,{className:"h-5 w-5 text-gray-400"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Filters"})]})}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"From Date"}),e.jsx("input",{type:"date",value:h.fromDate,onChange:a=>F("fromDate",a.target.value),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"To Date"}),e.jsx("input",{type:"date",value:h.toDate,onChange:a=>F("toDate",a.target.value),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Voucher Code"}),e.jsx("input",{type:"text",placeholder:"Contains...",value:h.voucherCode,onChange:a=>F("voucherCode",a.target.value),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Amount"}),e.jsx("input",{type:"number",placeholder:"Equals...",value:h.amount,onChange:a=>F("amount",a.target.value),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Particular"}),e.jsx("input",{type:"text",placeholder:"Contains...",value:h.particular,onChange:a=>F("particular",a.target.value),className:"input"})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("button",{onClick:()=>Y(),className:"btn btn-primary w-full flex items-center justify-center space-x-2",children:[e.jsx(V,{className:"h-4 w-4"}),e.jsx("span",{children:"Search"})]})})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Bank Payments From: ",Z(h.fromDate)," To: ",Z(h.toDate)]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm text-gray-500",children:[_e.totalItems||0," records"]}),e.jsx("button",{onClick:()=>Y(),className:"p-2 text-gray-400 hover:text-gray-600",title:"Refresh",children:e.jsx(he,{className:"h-4 w-4"})})]})]})}),e.jsx("div",{className:"card-content p-0",children:ye?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(he,{className:"h-8 w-8 animate-spin mx-auto text-gray-400"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"Loading bank payments..."})]}):le?e.jsx("div",{className:"p-8 text-center text-red-600",children:e.jsxs("p",{children:["Error loading bank payments: ",ee(le).message]})}):me.length===0?e.jsx("div",{className:"p-8 text-center text-gray-500",children:e.jsx("p",{children:"No bank payments found for the selected criteria."})}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>X("date"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Date"}),e.jsx(ae,{className:"h-3 w-3"})]})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>X("voucherCode"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Voucher Code"}),e.jsx(ae,{className:"h-3 w-3"})]})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>X("amount"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Amount"}),e.jsx(ae,{className:"h-3 w-3"})]})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Particular"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Bank Account"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Supplier/Customer/Expense"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:me.map((a,t)=>e.jsxs("tr",{className:t%2===0?"bg-white":"bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Z(a.date)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:a.voucherCode}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Math.round(a.amount)}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900 max-w-xs truncate",children:a.particular}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a.bank?e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:a.bank.bankName}),e.jsx("div",{className:"text-gray-500 text-xs",children:a.bank.accountNumber})]}):a.bankAccount||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a.supplier?e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:a.supplier.displayName||a.supplier.companyName||a.supplier.name||"Unknown Supplier"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Supplier"})]}):a.customer?e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:a.customer.displayName||a.customer.businessName||a.customer.name||`${a.customer.firstName||""} ${a.customer.lastName||""}`.trim()||a.customer.email||"Unknown Customer"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Customer"})]}):a.paymentType==="expense"?e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-orange-600",children:"Expense"}),e.jsx("div",{className:"text-gray-500 text-xs",children:a.particular||"N/A"})]}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>Te(a),className:"text-green-600 hover:text-green-900",title:"Print",children:e.jsx(Ze,{className:"h-4 w-4"})}),e.jsx("button",{className:"text-blue-600 hover:text-blue-900",title:"View",children:e.jsx(ea,{className:"h-4 w-4"})}),e.jsx("button",{className:"text-indigo-600 hover:text-indigo-900",title:"Edit",children:e.jsx(aa,{className:"h-4 w-4"})}),e.jsx("button",{className:"text-red-600 hover:text-red-900",title:"Delete",children:e.jsx(sa,{className:"h-4 w-4"})})]})})]},a._id))})]})})})})]}),e.jsx(Ge,{isOpen:fe,onClose:()=>{ne(!1),re(null)},orderData:B,documentTitle:"Bank Payment",partyLabel:B!=null&&B.supplier?"Supplier":B!=null&&B.customer?"Customer":"Payee"}),!1]})};export{Ca as default};
