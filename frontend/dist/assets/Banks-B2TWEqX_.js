import{r as p,R as D,p as e,ap as L,S as O,bT as j,O as x,aw as I,X as U,T as P,L as _}from"./index-DaTQeIrM.js";import{u as $,a as G,b as Q,c as W}from"./banksApi-BjGxgmxs.js";import{u as R}from"./useFuzzySearch-BgntWuv8.js";import{D as V}from"./ConfirmationDialog-DxRMdj0p.js";import{a as X}from"./useConfirmation-C3qnwA_z.js";import{P as y}from"./plus-CH9F90nm.js";import{C as Z}from"./check-circle-C7Swk4iC.js";import{P as H}from"./pen-square-CD6kqgaB.js";import{T as J}from"./trash-2-NO2IJ0Re.js";import"./shield-DyTx0jkP.js";import"./info-geJWZ_yE.js";const K=({bank:t,onSave:h,onCancel:u,isSubmitting:r})=>{const{register:a,handleSubmit:m,formState:{errors:n},reset:o}=I({defaultValues:{accountName:"",accountNumber:"",bankName:"",branchName:"",branchAddress:{street:"",city:"",state:"",zipCode:"",country:"US"},accountType:"checking",routingNumber:"",swiftCode:"",iban:"",openingBalance:0,isActive:!0,notes:""}});p.useEffect(()=>{o(t?{accountName:t.accountName||"",accountNumber:t.accountNumber||"",bankName:t.bankName||"",branchName:t.branchName||"",branchAddress:t.branchAddress||{street:"",city:"",state:"",zipCode:"",country:"US"},accountType:t.accountType||"checking",routingNumber:t.routingNumber||"",swiftCode:t.swiftCode||"",iban:t.iban||"",openingBalance:t.openingBalance||0,isActive:t.isActive!==void 0?t.isActive:!0,notes:t.notes||""}:{accountName:"",accountNumber:"",bankName:"",branchName:"",branchAddress:{street:"",city:"",state:"",zipCode:"",country:"US"},accountType:"checking",routingNumber:"",swiftCode:"",iban:"",openingBalance:0,isActive:!0,notes:""})},[t,o]);const N=g=>{h(g)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:t?"Edit Bank Account":"Add New Bank Account"}),e.jsx("button",{onClick:u,className:"p-2 text-gray-400 hover:text-gray-600",children:e.jsx(U,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:m(N),className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bank Name *"}),e.jsxs("div",{className:"relative",children:[e.jsx(j,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{...a("bankName",{required:"Bank name is required"}),className:"input pl-10",placeholder:"Enter bank name"})]}),n.bankName&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:n.bankName.message})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Account Name *"}),e.jsx("input",{...a("accountName",{required:"Account name is required"}),className:"input",placeholder:"e.g., Main Operating Account"}),n.accountName&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:n.accountName.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Account Number *"}),e.jsx("input",{...a("accountNumber",{required:"Account number is required"}),className:"input",placeholder:"Enter account number"}),n.accountNumber&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:n.accountNumber.message})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Branch Name"}),e.jsx("input",{...a("branchName"),className:"input",placeholder:"Enter branch name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Account Type *"}),e.jsxs("select",{...a("accountType",{required:"Account type is required"}),className:"input",children:[e.jsx("option",{value:"checking",children:"Checking"}),e.jsx("option",{value:"savings",children:"Savings"}),e.jsx("option",{value:"current",children:"Current"}),e.jsx("option",{value:"other",children:"Other"})]}),n.accountType&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:n.accountType.message})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Opening Balance"}),e.jsxs("div",{className:"relative",children:[e.jsx(P,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"number",step:"0.01",...a("openingBalance",{valueAsNumber:!0,min:{value:0,message:"Balance must be positive"}}),className:"input pl-10",placeholder:"0.00"})]}),n.openingBalance&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:n.openingBalance.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Routing Number"}),e.jsx("input",{...a("routingNumber"),className:"input",placeholder:"Enter routing number"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"SWIFT Code"}),e.jsx("input",{...a("swiftCode"),className:"input",placeholder:"Enter SWIFT code"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"IBAN"}),e.jsx("input",{...a("iban"),className:"input",placeholder:"Enter IBAN"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Branch Address"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{...a("branchAddress.street"),className:"input",placeholder:"Street Address"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsx("input",{...a("branchAddress.city"),className:"input",placeholder:"City"}),e.jsx("input",{...a("branchAddress.state"),className:"input",placeholder:"State"}),e.jsx("input",{...a("branchAddress.zipCode"),className:"input",placeholder:"Zip Code"})]}),e.jsx("input",{...a("branchAddress.country"),className:"input",placeholder:"Country"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),e.jsx("textarea",{...a("notes"),className:"input",rows:3,placeholder:"Additional notes about this bank account..."})]}),t&&e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",...a("isActive"),className:"checkbox"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Active"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Inactive bank accounts won't appear in dropdown menus for new transactions"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:u,className:"btn btn-secondary",disabled:r,children:"Cancel"}),e.jsxs(_,{type:"submit",isLoading:r,className:"btn btn-primary",disabled:r,children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),t?"Update Bank":"Add Bank"]})]})]})]})})})},oe=()=>{var w,k;const[t,h]=p.useState(""),[u,r]=p.useState(!1),[a,m]=p.useState(null),{confirmation:n,confirmDelete:o,handleConfirm:N,handleCancel:g}=X(),{data:c,isLoading:A,error:B,refetch:b}=$(void 0),C=D.useMemo(()=>{var s,i,l;return c?(i=(s=c==null?void 0:c.data)==null?void 0:s.data)!=null&&i.banks?c.data.data.banks:(l=c==null?void 0:c.data)!=null&&l.banks?c.data.banks:c!=null&&c.banks?c.banks:Array.isArray(c)?c:[]:[]},[c]),[S]=G(),[T]=Q(),[E]=W(),q=async s=>{var l;const i=a?s:{...s,isActive:!0};try{a?(await T({id:a._id,...i}).unwrap(),x.success("Bank account updated successfully")):(await S(i).unwrap(),x.success("Bank account added successfully")),r(!1),m(null),b()}catch(d){x.error(((l=d==null?void 0:d.data)==null?void 0:l.message)||"Failed to save bank account")}},z=s=>{const i=`${s.bankName} - ${s.accountNumber}`;o(i,"Bank Account",async()=>{var l;try{await E(s._id).unwrap(),x.success("Bank account deleted successfully"),b()}catch(d){x.error(((l=d==null?void 0:d.data)==null?void 0:l.message)||"Failed to delete bank account")}})},f=()=>{m(null),r(!0)},M=s=>{m(s),r(!0)},v=R(C,t,["bankName","accountName","accountNumber","branchName"],{threshold:.4,minScore:.3,limit:null}).filter(s=>s?s.isActive!==!1:!1),F=!1;return A?e.jsx(L,{message:"Loading banks..."}):B?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-600 mb-4",children:"Error loading banks"}),e.jsx("button",{onClick:()=>queryClient.invalidateQueries("banks"),className:"btn btn-primary",children:"Retry"})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Bank Accounts"}),e.jsx("p",{className:"text-gray-600",children:"Manage your bank accounts"})]}),e.jsxs("button",{onClick:f,className:"btn btn-primary",children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),"Add Bank Account"]})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(O,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search banks...",value:t,onChange:s=>h(s.target.value),className:"input pl-10"})]})}),v.length===0?e.jsxs("div",{className:"card text-center py-12",children:[e.jsx(j,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"No banks found"}),e.jsx("p",{className:"mt-2 text-gray-500",children:t?"Try adjusting your search terms":"Get started by adding your first bank account"}),!t&&e.jsxs("button",{onClick:f,className:"btn btn-primary mt-4",children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),"Add Bank Account"]})]}):e.jsx("div",{className:"card overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Bank Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Account Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Account Number"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Account Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Branch"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Opening Balance"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Routing Number"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:v.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.isActive!==!1?e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[e.jsx(Z,{className:"h-3 w-3 mr-1"}),"Active"]}):e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"Inactive"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(j,{className:"h-4 w-4 text-blue-600 mr-2"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.bankName})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm text-gray-900",children:s.accountName})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm text-gray-900",children:s.accountNumber})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm text-gray-900 capitalize",children:s.accountType||"N/A"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm text-gray-900",children:s.branchName||"N/A"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:"text-sm font-medium text-green-600",children:["$",(s.openingBalance||0).toFixed(2)]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm text-gray-900",children:s.routingNumber||"N/A"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx("button",{onClick:()=>M(s),className:"text-blue-600 hover:text-blue-900 p-1 rounded hover:bg-blue-50 transition-colors",title:"Edit",children:e.jsx(H,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>z(s),className:"text-red-600 hover:text-red-900 p-1 rounded hover:bg-red-50 transition-colors",disabled:!1,title:"Delete",children:e.jsx(J,{className:"h-4 w-4"})})]})})]},s._id))})]})})}),u&&e.jsx(K,{bank:a,onSave:q,onCancel:()=>{r(!1),m(null)},isSubmitting:F}),e.jsx(V,{isOpen:n.isOpen,onClose:g,onConfirm:N,itemName:((k=(w=n.message)==null?void 0:w.match(/"([^"]*)"/))==null?void 0:k[1])||"",itemType:"Bank Account",isLoading:!1})]})};export{oe as default};
