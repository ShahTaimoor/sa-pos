import{u as Vt,r as o,R as Z,V as Gt,W as Wt,Y as Yt,Z as Ht,_ as Xt,$ as Zt,a0 as Jt,p as e,S as De,a1 as es,P as ts,A as ss,v as as,w as I,x as mt,O as N,C as ns,a2 as rs}from"./index-DaTQeIrM.js";import{u as ls,a as is}from"./suppliersApi-DE3TTIcG.js";import{a as cs}from"./productsApi-CuUSDwZw.js";import{u as xt}from"./useFuzzySearch-BgntWuv8.js";import"./SearchableDropdown-OW0MXnv1.js";import{u as os}from"./useCompanyInfo-x6rWwbVQ.js";import{D as ds}from"./download-sNUxQ2Ce.js";import{P as ut}from"./plus-CH9F90nm.js";import{P as ms}from"./phone-CmUVKviX.js";import{T as Te}from"./trash-2-NO2IJ0Re.js";import{S as xs}from"./save-s6YX8dXx.js";import{F as us}from"./filter-Dd-_7AND.js";import{E as ps}from"./eye-DQ0qHB88.js";import{P as pt}from"./printer-sSBWtYCz.js";import{P as hs}from"./pen-square-CD6kqgaB.js";import{C as Oe}from"./check-circle-C7Swk4iC.js";import{X as Me}from"./x-circle-CEJfwNq8.js";import"./chevron-down-5FLXPK9w.js";import"./check-D4trJhmm.js";import"./settingsApi-B2ylrE_e.js";const ht=(b=new Date)=>{const h=b.getFullYear(),p=String(b.getMonth()+1).padStart(2,"0"),oe=String(b.getDate()).padStart(2,"0");return`${h}-${p}-${oe}`},y=b=>b==null?"":typeof b=="string"||typeof b=="number"?b:typeof b=="object"?b.name||b.title||b.fullName||b.companyName||JSON.stringify(b):String(b),gs=({status:b})=>{const h={draft:{color:"bg-gray-100 text-gray-800",icon:rs,label:"Pending"},confirmed:{color:"bg-blue-100 text-blue-800",icon:Oe,label:"Confirmed"},partially_received:{color:"bg-yellow-100 text-yellow-800",icon:ns,label:"Partially Received"},fully_received:{color:"bg-green-100 text-green-800",icon:Oe,label:"Fully Received"},cancelled:{color:"bg-red-100 text-red-800",icon:Me,label:"Cancelled"},closed:{color:"bg-gray-100 text-gray-800",icon:Me,label:"Closed"}},p=h[b]||h.draft,oe=p.icon;return e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${p.color}`,children:[e.jsx(oe,{className:"h-3 w-3 mr-1"}),p.label]})},Ws=({tabId:b})=>{var We,Ye,He,Xe,Ze,Je,et,tt,st,at;const{updateTabTitle:h,getActiveTab:p,openTab:oe}=Vt(),{companyInfo:de}=os(),Ee=de.companyName||"Company Name",me=de.address||de.billingAddress||"",xe=de.contactNumber||"",gt=ht(),je=new Date;je.setDate(je.getDate()-14);const bt=ht(je),[f,ft]=o.useState({fromDate:bt,toDate:gt,poNumber:"",supplier:"",status:"",paymentStatus:""}),[$e,yt]=o.useState({page:1,limit:999999}),[bs,fs]=o.useState({key:"createdAt",direction:"desc"}),[J,ue]=o.useState(!1),[jt,Ne]=o.useState(!1),[l,_]=o.useState(null),[d,U]=o.useState(null),[E,w]=o.useState(""),[pe,K]=o.useState(-1),[q,he]=o.useState(!0),[ee,L]=o.useState(1),[te,z]=o.useState(0),[i,u]=o.useState({supplier:"",items:[],invoiceNumber:"",expectedDelivery:new Date().toISOString().split("T")[0],notes:"",terms:"",isTaxExempt:!0}),[P,se]=o.useState(null),[$,ae]=o.useState(""),[ne,ve]=o.useState(1),[we,V]=o.useState(""),[Q,re]=o.useState(-1),[le,R]=o.useState(""),[ge,G]=o.useState(null),[be,T]=o.useState(-1),ie=o.useRef(null),[ys,js]=o.useState(null);o.useEffect(()=>{ie.current&&ie.current.focus()},[]),o.useEffect(()=>{if(J){document.body.style.overflow="hidden";const t=setTimeout(()=>{const s=document.querySelector(".modal-product-search input");s&&s.focus()},100);return()=>{clearTimeout(t),document.body.style.overflow="unset"}}else R(""),G(null),L(1),z(0),T(-1)},[J]);const Nt=Z.useMemo(()=>{const t={...$e};return f.fromDate&&(t.dateFrom=f.fromDate),f.toDate&&(t.dateTo=f.toDate),f.poNumber&&(t.search=f.poNumber),f.status&&(t.status=f.status),f.supplier&&(t.supplier=f.supplier),t},[f,$e]),{data:m,isLoading:vt,error:Ae,refetch:B}=Gt(Nt,{refetchOnMountOrArgChange:!0}),{data:F,isLoading:Ns,refetch:W}=ls({search:"",limit:100},{skip:!1,staleTime:0,refetchOnMountOrArgChange:!0}),v=Z.useMemo(()=>{var t;return((t=F==null?void 0:F.data)==null?void 0:t.suppliers)||(F==null?void 0:F.suppliers)||[]},[F]),{data:ce,refetch:Ce}=is(d==null?void 0:d._id,{skip:!(d!=null&&d._id),staleTime:0,refetchOnMountOrArgChange:!0});o.useEffect(()=>{ce!=null&&ce.data&&U(ce.data)},[ce]);const{data:C,isLoading:vs}=cs({limit:999999,status:"active"},{keepPreviousData:!0,staleTime:3e4}),Y=Z.useMemo(()=>{var t,s,a;return(t=C==null?void 0:C.data)!=null&&t.products?C.data.products:C!=null&&C.products?C.products:(a=(s=C==null?void 0:C.data)==null?void 0:s.data)!=null&&a.products?C.data.data.products:[]},[C]),Ie=xt(Y,$,["name","description","brand"],{threshold:.4,minScore:.3,limit:50}),k=Z.useMemo(()=>!$||$.trim().length===0?Y.slice(0,30):Ie,[$,Y,Ie]),Ue=xt(Y,le,["name","description","brand"],{threshold:.4,minScore:.3,limit:50}),A=Z.useMemo(()=>!le||le.trim().length===0?Y.slice(0,30):Ue,[le,Y,Ue]);o.useEffect(()=>{if(Q>=0&&$&&k){const t=document.querySelector(".product-list-container"),s=t==null?void 0:t.querySelector(`[data-product-index="${Q}"]`);s&&t&&s.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"})}},[Q,$,k]);const[wt,{isLoading:Fe}]=Wt(),[Ct,{isLoading:_e}]=Yt(),[St,{isLoading:ws}]=Ht(),[Pt,{isLoading:Cs}]=Xt(),[kt,{isLoading:Ss}]=Zt(),[Ps,{isLoading:ks}]=Jt(),H=()=>{if(u({supplier:"",items:[],invoiceNumber:"",expectedDelivery:new Date().toISOString().split("T")[0],notes:"",terms:"",isTaxExempt:!0}),U(null),w(""),he(!0),K(-1),se(null),ae(""),ve(1),V(""),h&&p){const t=p();t&&h(t.id,"PO")}},qe=t=>{const s=v==null?void 0:v.find(a=>a._id===t);if(U(s),u(a=>({...a,supplier:t})),w(""),K(-1),he(!1),h&&p&&s){const a=p();a&&h(a.id,`PO - ${s.companyName||s.name||"Unknown"}`)}},Dt=t=>{if(w(t),K(-1),t===""&&(U(null),u(s=>({...s,supplier:""})),he(!0),h&&p)){const s=p();s&&h(s.id,"PO")}},Tt=t=>{if(!q||!E||!F)return;const s=v.filter(n=>(n.companyName||n.name||"").toLowerCase().includes(E.toLowerCase())||(n.phone||"").includes(E)),a=s.length-1;switch(t.key){case"ArrowDown":t.preventDefault(),K(n=>n<a?n+1:0);break;case"ArrowUp":t.preventDefault(),K(n=>n>0?n-1:a);break;case"Enter":t.preventDefault(),pe>=0&&pe<s.length&&qe(s[pe]._id);break;case"Escape":w(""),K(-1);break}},Le=t=>{var s;se(t),V(((s=t.pricing)==null?void 0:s.cost)||""),ae(t.name),re(-1)},Ot=t=>{ae(t),re(-1),P&&t!==P.name&&(se(null),V("")),t===""&&(se(null),V(""))},Mt=t=>{if(!$||!k)return;const s=k,a=s.length-1;switch(t.key){case"ArrowDown":t.preventDefault(),re(n=>n<a?n+1:0);break;case"ArrowUp":t.preventDefault(),re(n=>n>0?n-1:a);break;case"Enter":t.preventDefault(),Q>=0&&Q<s.length&&Le(s[Q]);break;case"Escape":ae(""),re(-1);break}},ze=t=>{t.key==="Enter"&&P&&(t.preventDefault(),Qe())},Qe=()=>{var n;if(!P||ne<=0){N.error("Please select a product and enter quantity");return}const t=parseFloat(we)||((n=P.pricing)==null?void 0:n.cost)||0,s=t*ne,a={product:P._id,productData:P,quantity:ne,costPerUnit:t,totalCost:s};u(r=>({...r,items:[...r.items,a]})),se(null),ae(""),ve(1),V(""),setTimeout(()=>{ie.current&&ie.current.focus()},100)},Re=t=>{u(s=>({...s,items:s.items.filter((a,n)=>n!==t)}))},Et=()=>{u(t=>{if(!t.items||t.items.length<2)return t;const s=n=>{const r=n.productData||n.product;return r?typeof r=="string"?r:r.name||r.title||r.displayName||r.businessName||r.fullName||"":""},a=[...t.items].sort((n,r)=>{const c=s(n).toString().toLowerCase(),g=s(r).toString().toLowerCase();return c<g?-1:c>g?1:0});return{...t,items:a}})},Be=()=>{const t=i.items.reduce((c,g)=>c+g.totalCost,0),s=i.isTaxExempt?0:t*.08,a=t+s,n=(d==null?void 0:d.pendingBalance)||0,r=a+n;return{subtotal:t,tax:s,total:a,supplierOutstanding:n,totalPayables:r}},X=(t,s)=>{ft(a=>({...a,[t]:s})),yt(a=>({...a,page:1}))},$t=()=>{if(i.items.length===0){N.error("Please add at least one item to the order");return}if(!i.supplier){N.error("Please select a supplier");return}const{subtotal:t,tax:s,total:a}=Be(),n={...i,subtotal:t,tax:s,total:a};wt(n).unwrap().then(()=>{if(N.success("Purchase order created successfully"),W&&typeof W=="function")try{W()}catch{}if(H(),h&&p){const r=p();r&&h(r.id,"PO")}B()}).catch(r=>{var c;N.error(((c=r==null?void 0:r.data)==null?void 0:c.message)||"Failed to create purchase order")})},At=()=>{const t={...i,items:i.items.map(s=>({product:s.product,quantity:s.quantity,costPerUnit:s.costPerUnit,totalCost:s.totalCost,receivedQuantity:s.receivedQuantity||0,remainingQuantity:s.remainingQuantity||s.quantity}))};Ct({id:l._id,...t}).unwrap().then(()=>{var s;if(ue(!1),_(null),d!=null&&d._id&&Ce&&typeof Ce=="function")try{Ce().then(a=>{var n;(n=a==null?void 0:a.data)!=null&&n.data&&U(a.data.data)}).catch(a=>{var n;(n=a==null?void 0:a.message)!=null&&n.includes("has not been started")})}catch(a){(s=a==null?void 0:a.message)!=null&&s.includes("has not been started")}if(W&&typeof W=="function")try{W()}catch{}if(H(),N.success("Purchase order updated successfully"),h&&p){const a=p();a&&h(a.id,"PO")}B()}).catch(s=>{var n;const a=((n=s==null?void 0:s.data)==null?void 0:n.message)||(s==null?void 0:s.message)||"Failed to update purchase order";N.error(a)})},It=t=>{window.confirm("Are you sure you want to delete this purchase order?")&&St(t).unwrap().then(()=>{N.success("Purchase order deleted successfully"),B()}).catch(s=>{var a;N.error(((a=s==null?void 0:s.data)==null?void 0:a.message)||"Failed to delete purchase order")})},Ut=t=>{window.confirm("Are you sure you want to confirm this pending purchase order? This will change its status to confirmed and make it ready for receiving.")&&Pt(t).unwrap().then(()=>{N.success("Purchase order confirmed successfully"),B()}).catch(s=>{var a;N.error(((a=s==null?void 0:s.data)==null?void 0:a.message)||"Failed to confirm purchase order")})},Ft=t=>{window.confirm("Are you sure you want to cancel this purchase order? This action cannot be undone.")&&kt(t).unwrap().then(()=>{N.success("Purchase order cancelled successfully"),B()}).catch(s=>{var a;N.error(((a=s==null?void 0:s.data)==null?void 0:a.message)||"Failed to cancel purchase order")})},_t=t=>{var n;_(t);const s=(t.items||[]).map(r=>{var g,O,x;let c=r.costPerUnit||0;return c===0&&((O=(g=r.product)==null?void 0:g.pricing)!=null&&O.cost)&&(c=r.product.pricing.cost),{product:((x=r.product)==null?void 0:x._id)||r.product,quantity:r.quantity,costPerUnit:c,totalCost:r.totalCost||r.quantity*c,receivedQuantity:r.receivedQuantity||0,remainingQuantity:r.remainingQuantity||r.quantity,productData:r.product||null}}),a={supplier:((n=t.supplier)==null?void 0:n._id)||"",items:s,expectedDelivery:t.expectedDelivery?new Date(t.expectedDelivery).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],notes:t.notes||"",terms:t.terms||"",isTaxExempt:t.isTaxExempt!==void 0?t.isTaxExempt:!0};if(u(a),t.supplier){if(U(t.supplier),w(t.supplier.companyName||t.supplier.name||""),h&&p){const r=p();r&&h(r.id,`PO - ${t.supplier.companyName||t.supplier.name||"Unknown"}`)}}else if(U(null),w(""),h&&p){const r=p();r&&h(r.id,"PO")}ue(!0)},qt=t=>{_(t),Ne(!0)},Se=t=>{var n,r,c,g,O,x,D,M,S;const s=`
      <html>
        <head>
          <title>Purchase Order - ${t.poNumber}</title>
          <style>
            @media print {
              @page { size: A4; margin: 0.5in; }
              body { font-family: Arial, sans-serif; font-size: 14px; line-height: 1.2; color: #000; margin: 0; padding: 0; }
              .container { max-width: 800px; margin: 0 auto; }
              .header { text-align: center; margin-bottom: 20px; }
              .header h1 { font-size: 24px; font-weight: bold; margin: 0 0 4px 0; color: #000; }
              .header p { margin: 2px 0; font-size: 14px; color: #6b7280; }
              .details-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-bottom: 20px; }
              .details-section h5 { font-size: 16px; font-weight: 600; color: #000; margin: 0 0 8px 0; }
              .details-section p { margin: 2px 0; font-size: 14px; color: #374151; }
              .details-section .font-medium { font-weight: 500; }
              .status-badge { display: inline-block; padding: 4px 8px; border-radius: 9999px; font-size: 12px; font-weight: 500; background-color: #f3f4f6; color: #374151; }
              .outstanding-balance { margin-top: 8px; padding-top: 6px; border-top: 1px solid #e5e7eb; }
              .outstanding-balance p { font-weight: 600; color: #dc2626; }
              .items-section { margin-bottom: 20px; }
              .items-section h5 { font-size: 16px; font-weight: 600; color: #000; margin: 0 0 8px 0; }
              .items-table { width: 100%; border-collapse: collapse; border: 1px solid #e5e7eb; border-radius: 8px; overflow: hidden; }
              .items-table thead { background-color: #f9fafb; }
              .items-table th { padding: 8px; text-align: left; font-size: 14px; font-weight: 600; color: #000; border-bottom: 1px solid #e5e7eb; }
              .items-table td { padding: 8px; font-size: 14px; color: #374151; border-bottom: 1px solid #e5e7eb; }
              .items-table tr:last-child td { border-bottom: none; }
              .items-table tr:nth-child(even) { background-color: #f9fafb; }
              .product-info { display: flex; flex-direction: column; }
              .product-name { font-weight: 500; color: #000; }
              .product-description { font-size: 12px; color: #6b7280; margin-top: 2px; }
              .text-right { text-align: right; }
              .totals-section { display: flex; justify-content: flex-end; margin-bottom: 20px; }
              .totals-container { width: 320px; }
              .totals-section .space-y-2 > * + * { margin-top: 4px; }
              .totals-section .flex { display: flex; justify-content: space-between; }
              .totals-section .text-sm { font-size: 14px; }
              .totals-section .text-gray-600 { color: #6b7280; }
              .totals-section .font-medium { font-weight: 500; }
              .totals-section .text-lg { font-size: 18px; }
              .totals-section .font-bold { font-weight: 700; }
              .totals-section .border-t { border-top: 1px solid #e5e7eb; }
              .totals-section .pt-2 { padding-top: 8px; }
              .totals-section .text-red-600 { color: #dc2626; }
              .notes-section { margin-bottom: 20px; }
              .notes-section h5 { font-size: 16px; font-weight: 600; color: #000; margin: 0 0 8px 0; }
              .notes-content { font-size: 14px; color: #374151; background-color: #f9fafb; padding: 8px; border-radius: 8px; border: 1px solid #e5e7eb; }
              .footer { display: flex; justify-content: space-between; align-items: center; padding-top: 12px; border-top: 1px solid #e5e7eb; }
              .footer .text-xs { font-size: 12px; line-height: 1.1; }
              .footer .text-gray-500 { color: #6b7280; }
              .footer .flex { display: flex; }
              .footer .space-x-3 > * + * { margin-left: 12px; }
              .footer .btn { padding: 8px 16px; border-radius: 6px; font-size: 14px; font-weight: 500; cursor: pointer; }
              .footer .btn-primary { background-color: #3b82f6; color: white; }
              .footer .btn-secondary { background-color: #6b7280; color: white; }
              .footer .flex .items-center { align-items: center; }
              .footer .mr-2 { margin-right: 8px; }
            }
          </style>
        </head>
        <body>
          <div class="container">
            <!-- Header -->
            <div class="header">
              <h1>${Ee}</h1>
              ${me?`<p>${me}</p>`:""}
              ${xe?`<p>Phone: ${xe}</p>`:""}
            </div>
            
            <!-- Details Section -->
            <div class="details-grid">
              <div class="details-section">
                <h5>Purchase Order Details</h5>
                <p><span class="font-medium">PO Number:</span> ${t.poNumber}</p>
                <p><span class="font-medium">Date:</span> ${I(t.createdAt)}</p>
                <p><span class="font-medium">Status:</span> 
                  <span class="status-badge">${t.status==="draft"?"Pending":t.status.replace("_"," ")}</span>
                </p>
                ${t.expectedDelivery?`<p><span class="font-medium">Expected Delivery:</span> ${I(t.expectedDelivery)}</p>`:""}
              </div>
              <div class="details-section">
                <!-- Empty middle column for spacing -->
              </div>
              <div class="details-section" style="text-align: right;">
                <h5>Supplier Details</h5>
                <p><span class="font-medium">Company:</span> ${y(((n=t.supplier)==null?void 0:n.companyName)||((r=t.supplier)==null?void 0:r.name))||"Unknown"}</p>
                ${(c=t.supplier)!=null&&c.email?`<p><span class="font-medium">Email:</span> ${y(t.supplier.email)}</p>`:""}
                ${(g=t.supplier)!=null&&g.phone?`<p><span class="font-medium">Phone:</span> ${y(t.supplier.phone)}</p>`:""}
                ${(O=t.supplier)!=null&&O.contactPerson?`<p><span class="font-medium">Contact:</span> ${y(t.supplier.contactPerson)}</p>`:""}
                <div class="outstanding-balance">
                  <p>
                    <span class="font-medium">Outstanding Balance:</span> ${Math.round(((x=t.supplier)==null?void 0:x.pendingBalance)||0)}
                  </p>
                </div>
              </div>
            </div>
            
            <!-- Items Section -->
            <div class="items-section">
              <h5>Items Ordered</h5>
              <table class="items-table">
                <thead>
                  <tr>
                    <th>#</th>
                    <th>PRODUCT</th>
                    <th class="text-right">QUANTITY</th>
                    <th class="text-right">UNIT COST</th>
                    <th class="text-right">TOTAL COST</th>
                  </tr>
                </thead>
                <tbody>
                  ${((D=t.items)==null?void 0:D.map((j,ke)=>{var fe,ye;return`
                    <tr>
                      <td>${ke+1}</td>
                      <td>
                        <div class="product-info">
                          <div class="product-name">${y((fe=j.product)==null?void 0:fe.name)||"Unknown Product"}</div>
                          ${(ye=j.product)!=null&&ye.description?`<div class="product-description">${j.product.description}</div>`:""}
                        </div>
                      </td>
                      <td class="text-right">${j.quantity}</td>
                      <td class="text-right">${Math.round(j.unitCost||j.cost||0)}</td>
                      <td class="text-right">${Math.round(j.totalCost||j.quantity*(j.unitCost||j.cost||0))}</td>
                    </tr>
                  `}).join(""))||""}
                </tbody>
              </table>
            </div>
            
            <!-- Totals Section -->
            <div class="totals-section">
              <div class="totals-container">
                <div class="space-y-2">
                  <div class="flex text-sm">
                    <span class="text-gray-600">Subtotal:</span>
                    <span class="font-medium">${Math.round(t.subtotal||0)}</span>
                  </div>
                  ${t.tax&&t.tax>0?`
                    <div class="flex text-sm">
                      <span class="text-gray-600">Tax:</span>
                      <span class="font-medium">${Math.round(t.tax)}</span>
                    </div>
                  `:""}
                  <div class="flex text-sm">
                    <span class="text-gray-600">PO Total:</span>
                    <span class="font-medium">${Math.round(t.total||0)}</span>
                  </div>
                  <div class="flex text-sm">
                    <span class="text-gray-600">Previous Outstanding:</span>
                    <span class="font-medium text-red-600">${Math.round(((M=t.supplier)==null?void 0:M.pendingBalance)||0)}</span>
                  </div>
                  <div class="flex text-lg font-bold border-t pt-2">
                    <span>Total Payables:</span>
                    <span class="text-red-600">${Math.round((t.total||0)+(((S=t.supplier)==null?void 0:S.pendingBalance)||0))}</span>
                  </div>
                </div>
              </div>
            </div>
            
            ${t.notes?`
              <div class="notes-section">
                <h5>Notes</h5>
                <div class="notes-content">${t.notes}</div>
              </div>
            `:""}
            
            ${t.terms?`
              <div class="notes-section">
                <h5>Terms</h5>
                <div class="notes-content">${t.terms}</div>
              </div>
            `:""}
            
            <!-- Footer -->
            <div class="footer">
              <div class="text-xs text-gray-500">
                Generated on ${new Date().toLocaleDateString()} at ${new Date().toLocaleTimeString()}
              </div>
            </div>
          </div>
        </body>
      </html>
    `,a=window.open("","_blank");a.document.write(s),a.document.close(),a.focus(),a.print(),a.close()},Lt=()=>{try{const t=Pe||[];if(t.length===0){N.error("No purchase orders to export");return}const a=[["Order Number","Date","Supplier","Status","Subtotal","Tax","Total","Items Count","Notes"].join(",")];t.forEach(x=>{var nt,rt,lt,it,ct,ot,dt;const D=((nt=x.supplier)==null?void 0:nt.companyName)||((rt=x.supplier)==null?void 0:rt.name)||((lt=x.supplierInfo)==null?void 0:lt.companyName)||"N/A",M=x.status||"N/A",S=x.subtotal||((it=x.pricing)==null?void 0:it.subtotal)||0,j=x.tax||((ct=x.pricing)==null?void 0:ct.taxAmount)||0,ke=x.total||((ot=x.pricing)==null?void 0:ot.total)||0,fe=((dt=x.items)==null?void 0:dt.length)||0,ye=(x.notes||"").replace(/"/g,'""'),Bt=x.createdAt?I(x.createdAt):I(new Date),Kt=[x.poNumber||x.orderNumber||"N/A",Bt,`"${D}"`,M,S.toFixed(2),j.toFixed(2),ke.toFixed(2),fe,`"${ye}"`];a.push(Kt.join(","))});const n=a.join(`
`),r=new Blob([n],{type:"text/csv;charset=utf-8;"}),c=document.createElement("a"),g=URL.createObjectURL(r),O=new Date().toISOString().split("T")[0];c.setAttribute("href",g),c.setAttribute("download",`purchase_orders_${O}.csv`),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(g),N.success(`Exported ${t.length} purchase order(s) to CSV`)}catch{N.error("Failed to export purchase orders")}},Pe=Z.useMemo(()=>{var t,s,a;return m?(t=m==null?void 0:m.data)!=null&&t.purchaseOrders?m.data.purchaseOrders:m!=null&&m.purchaseOrders?m.purchaseOrders:(a=(s=m==null?void 0:m.data)==null?void 0:s.data)!=null&&a.purchaseOrders?m.data.data.purchaseOrders:Array.isArray(m)?m:Array.isArray(m==null?void 0:m.data)?m.data:[]:[]},[m]),zt=((We=m==null?void 0:m.data)==null?void 0:We.pagination)||(m==null?void 0:m.pagination)||{},{subtotal:Ke,tax:Ve,total:Ge,supplierOutstanding:Qt,totalPayables:Rt}=Be();return e.jsxs("div",{className:"space-y-4 lg:space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Purchase Orders"}),e.jsx("p",{className:"text-gray-600",children:"Process purchase order transactions"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:Lt,className:"btn btn-secondary btn-md",children:[e.jsx(ds,{className:"h-4 w-4 mr-2"}),"Export"]}),e.jsxs("button",{onClick:H,className:"btn btn-primary btn-md",children:[e.jsx(ut,{className:"h-4 w-4 mr-2"}),"New Purchase Order"]})]})]}),e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsxs("div",{className:"w-[500px] flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Select Supplier"}),d&&e.jsx("button",{onClick:()=>{if(U(null),w(""),he(!0),u(t=>({...t,supplier:""})),h&&p){const t=p();t&&h(t.id,"PO")}},className:"text-xs text-blue-600 hover:text-blue-800 underline",children:"Change Supplier"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:q?E:d&&(d.companyName||d.name)||"",onChange:t=>{q&&Dt(t.target.value)},onKeyDown:Tt,className:`input w-full pr-10 ${q?"":"bg-gray-50 cursor-default"}`,placeholder:q?"Search suppliers by name, email, or business...":"",readOnly:!q}),e.jsx(De,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"})]}),q&&E&&e.jsx("div",{className:"mt-2 max-h-40 overflow-y-auto border border-gray-200 rounded-md bg-white shadow-lg",children:v==null?void 0:v.filter(t=>(t.companyName||t.name||"").toLowerCase().includes(E.toLowerCase())||(t.phone||"").includes(E)).map((t,s)=>e.jsxs("div",{onClick:()=>{qe(t._id),w(t.companyName||t.name||"")},className:`px-3 py-2 cursor-pointer border-b border-gray-100 last:border-b-0 ${s===pe?"bg-blue-100 text-blue-900":"hover:bg-gray-100"}`,children:[e.jsx("div",{className:"font-medium text-gray-900",children:y(t.companyName||t.name)||"Unknown"}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Outstanding Balance: $",(t.pendingBalance||0).toFixed(2)]})]},t._id))})]}),e.jsx("div",{className:"flex-1",children:d?e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(es,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:d.companyName||d.name||"Unknown"}),e.jsxs("p",{className:"text-sm text-gray-600 capitalize",children:[d.businessType||"Business"," • ",d.reliability||"Standard"]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Outstanding Balance:"}),e.jsx("span",{className:`text-sm font-medium ${(d.outstandingBalance||0)>0?"text-red-600":"text-green-600"}`,children:Math.round(d.outstandingBalance||0)})]}),d.phone&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ms,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{className:"text-xs text-gray-500",children:d.phone})]})]})]})]})}):e.jsx("div",{className:"hidden lg:block"})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Product Selection & Cart"})}),e.jsxs("div",{className:"card-content",children:[e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-12 gap-4 items-end",children:[e.jsxs("div",{className:"col-span-7",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product Search"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{ref:ie,type:"text",value:$,onChange:t=>Ot(t.target.value),onKeyDown:Mt,className:"input w-full pr-10 h-12",placeholder:"Search or select product..."}),e.jsx(De,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"})]}),k&&k.length>0&&e.jsx("div",{className:"product-list-container mt-2 max-h-40 overflow-y-auto border border-gray-200 rounded-md bg-white shadow-lg",children:k.length===0?e.jsx("div",{className:"px-3 py-2 text-sm text-gray-500 text-center",children:$?"No products found":"Start typing to search products"}):k.map((t,s)=>{var a,n;return e.jsx("div",{"data-product-index":s,onClick:()=>Le(t),className:`px-3 py-2 cursor-pointer border-b border-gray-100 last:border-b-0 ${s===Q?"bg-blue-100 text-blue-900":"hover:bg-gray-100"}`,children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("div",{className:"font-medium",children:y(t.name)}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Stock: ",((a=t.inventory)==null?void 0:a.currentStock)||0]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Cost: $",Math.round(((n=t.pricing)==null?void 0:n.cost)||0)]})]})]})},t._id)})})]}),e.jsxs("div",{className:"col-span-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Stock"}),e.jsx("span",{className:"text-sm font-semibold text-gray-700 bg-gray-100 px-2 py-1.5 rounded border border-gray-200 block text-center h-12 flex items-center justify-center",children:P?((Ye=P.inventory)==null?void 0:Ye.currentStock)||0:"0"})]}),e.jsxs("div",{className:"col-span-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quantity"}),e.jsx("input",{type:"number",min:"1",value:ne,onChange:t=>ve(parseInt(t.target.value)||1),onKeyDown:ze,className:"input text-center h-12",placeholder:"1 (Enter to add & focus search)"})]}),e.jsxs("div",{className:"col-span-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cost"}),e.jsx("input",{type:"number",step:"1",value:we,onChange:t=>V(t.target.value),onKeyDown:ze,className:"input text-center h-12",placeholder:"0 (Enter to add & focus search)",required:!0})]}),e.jsxs("div",{className:"col-span-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Amount"}),e.jsx("span",{className:"text-sm font-semibold text-gray-700 bg-gray-100 px-2 py-1.5 rounded border border-gray-200 block text-center h-12 flex items-center justify-center",children:P?Math.round(ne*parseFloat(we||0)):0})]}),e.jsxs("div",{className:"col-span-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "}),e.jsxs("button",{type:"button",onClick:Qe,className:"w-full btn btn-primary flex items-center justify-center px-3 h-12",disabled:!P,title:"Add to cart (or press Enter in Quantity/Cost fields - focus returns to search)",children:[e.jsx(ut,{className:"h-4 w-4 mr-2"}),"Add"]})]})]})})}),i.items.length===0?e.jsxs("div",{className:"p-8 text-center text-gray-500 border-t border-gray-200",children:[e.jsx(ts,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("p",{className:"mt-2",children:"No items in cart"})]}):e.jsxs("div",{className:"space-y-4 border-t border-gray-200 pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-md font-medium text-gray-700",children:"Cart Items"}),e.jsxs("button",{type:"button",onClick:Et,className:"btn btn-secondary btn-sm flex items-center space-x-2",title:"Sort products alphabetically",children:[e.jsx(ss,{className:"h-4 w-4"}),e.jsx("span",{children:"Sort A-Z"})]})]}),i.items.map((t,s)=>{var c,g,O;const a=t.productData||t.product,n=t.costPerUnit*t.quantity,r=((c=a==null?void 0:a.inventory)==null?void 0:c.currentStock)<=(((g=a==null?void 0:a.inventory)==null?void 0:g.reorderPoint)||0);return e.jsx("div",{className:`py-1 ${s%2===0?"bg-white":"bg-gray-50"}`,children:e.jsxs("div",{className:"grid grid-cols-12 gap-4 items-center",children:[e.jsx("div",{className:"col-span-1",children:e.jsx("span",{className:"text-sm font-medium text-gray-700 bg-gray-50 px-0.5 py-1 rounded border border-gray-200 block text-center h-8 flex items-center justify-center",children:s+1})}),e.jsx("div",{className:"col-span-6 flex items-center h-8",children:e.jsxs("span",{className:"font-medium text-sm truncate",children:[y(a==null?void 0:a.name)||"Unknown Product",r&&e.jsx("span",{className:"text-yellow-600 text-xs ml-2",children:"⚠️ Low"})]})}),e.jsx("div",{className:"col-span-1",children:e.jsx("span",{className:"text-sm font-semibold text-gray-700 bg-gray-100 px-2 py-1 rounded border border-gray-200 block text-center h-8 flex items-center justify-center",children:((O=a==null?void 0:a.inventory)==null?void 0:O.currentStock)||0})}),e.jsx("div",{className:"col-span-1",children:e.jsx("input",{type:"number",value:t.quantity,onChange:x=>{const D=parseInt(x.target.value)||1;if(D<=0){Re(s);return}u(M=>({...M,items:M.items.map((S,j)=>j===s?{...S,quantity:D,totalCost:D*S.costPerUnit}:S)}))},className:"input text-center h-8",min:"1"})}),e.jsx("div",{className:"col-span-1",children:e.jsx("input",{type:"number",step:"0.01",value:t.costPerUnit,onChange:x=>{const D=parseFloat(x.target.value)||0;u(M=>({...M,items:M.items.map((S,j)=>j===s?{...S,costPerUnit:D,totalCost:S.quantity*D}:S)}))},className:"input text-center h-8",min:"0"})}),e.jsx("div",{className:"col-span-1",children:e.jsx("span",{className:"text-sm font-semibold text-gray-700 bg-gray-100 px-2 py-1 rounded border border-gray-200 block text-center h-8 flex items-center justify-center",children:Math.round(n)})}),e.jsx("div",{className:"col-span-1",children:e.jsx("button",{onClick:()=>Re(s),className:"btn btn-danger btn-sm h-8 w-full",children:e.jsx(Te,{className:"h-4 w-4"})})})]})},s)})]})]})]}),i.items.length>0&&!J&&e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-lg max-w-5xl ml-auto mt-4",children:[e.jsx("div",{className:"px-6 py-4 border-b border-blue-200",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900 text-right",children:"Purchase Order Details"})}),e.jsxs("div",{className:"px-6 py-4",children:[e.jsxs("div",{className:"flex flex-nowrap gap-3 items-end justify-end",children:[e.jsxs("div",{className:"flex flex-col w-44",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Invoice Number"}),e.jsx("input",{type:"text",value:i.invoiceNumber||"Auto-generated",onChange:t=>u(s=>({...s,invoiceNumber:t.target.value})),className:"input h-8 text-sm",placeholder:"Auto-generated",disabled:!0})]}),e.jsxs("div",{className:"flex flex-col w-48",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Expected Delivery"}),e.jsx("input",{type:"date",value:i.expectedDelivery,onChange:t=>u(s=>({...s,expectedDelivery:t.target.value})),className:"input h-8 text-sm"})]}),e.jsxs("div",{className:"flex flex-col w-40",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Tax Status"}),e.jsxs("div",{className:"flex items-center space-x-1 px-2 py-1 border border-gray-200 rounded h-8",children:[e.jsx("input",{type:"checkbox",id:"taxExempt",checked:i.isTaxExempt,onChange:t=>u(s=>({...s,isTaxExempt:t.target.checked})),className:"h-3 w-3 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsx("div",{className:"flex-1",children:e.jsx("label",{htmlFor:"taxExempt",className:"text-xs font-medium text-gray-700 cursor-pointer",children:"Tax Exempt"})}),i.isTaxExempt&&e.jsx("div",{className:"text-green-600 text-xs font-medium",children:"✓"})]})]}),e.jsxs("div",{className:"flex flex-col w-[28rem]",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Notes"}),e.jsx("input",{type:"text",value:i.notes,onChange:t=>u(s=>({...s,notes:t.target.value})),className:"input h-8 text-sm",placeholder:"Additional notes..."})]})]}),e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-600 px-6 py-4 border-t border-blue-200 mt-6",children:e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Order Summary"})}),e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-800 font-semibold",children:"Subtotal:"}),e.jsx("span",{className:"text-xl font-bold text-gray-900",children:Math.round(Ke)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-800 font-semibold",children:i.isTaxExempt?"Tax (Exempt):":"Tax (8%):"}),e.jsx("span",{className:"text-xl font-bold text-gray-900",children:Math.round(Ve)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-800 font-semibold",children:"PO Total:"}),e.jsx("span",{className:"text-xl font-bold text-gray-900",children:Math.round(Ge)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-800 font-semibold",children:"Previous Outstanding:"}),e.jsx("span",{className:"text-xl font-bold text-red-600",children:Math.round(Qt)})]}),e.jsxs("div",{className:"flex justify-between items-center text-xl font-bold border-t-2 border-blue-400 pt-3 mt-2",children:[e.jsx("span",{className:"text-blue-900",children:"Total Payables:"}),e.jsx("span",{className:"text-blue-900 text-3xl",children:Math.round(Rt)})]})]})}),e.jsxs("div",{className:"flex space-x-3 mt-6 px-6 pb-6",children:[i.items.length>0&&!J&&e.jsxs("button",{onClick:H,className:"btn btn-secondary flex-1",children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),"Clear Cart"]}),i.items.length>0&&e.jsxs("button",{onClick:()=>{const t={poNumber:`PO-${Date.now()}`,supplier:d,items:i.items.map(s=>({product:k==null?void 0:k.find(n=>n._id===s.product),quantity:s.quantity,unitCost:s.costPerUnit,totalCost:s.quantity*s.costPerUnit})),subtotal:Ke,tax:Ve,total:Ge,expectedDelivery:i.expectedDelivery,notes:i.notes,terms:i.terms,createdAt:new Date().toISOString()};Se(t)},className:"btn btn-secondary flex-1",children:[e.jsx(as,{className:"h-4 w-4 mr-2"}),"Print Preview"]}),e.jsxs("button",{onClick:$t,disabled:Fe||i.items.length===0,className:"btn btn-primary btn-lg flex-2",children:[e.jsx(xs,{className:"h-4 w-4 mr-2"}),Fe?"Creating...":"Create Purchase Order"]})]})]})]}),J&&l&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:t=>t.stopPropagation(),children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full mx-4 max-h-[90vh] overflow-y-auto",onClick:t=>t.stopPropagation(),onKeyDown:t=>t.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Edit Purchase Order"}),e.jsx("button",{onClick:()=>{ue(!1),_(null),w(""),R(""),G(null),L(1),z(0),T(-1),H()},className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700",children:"Close"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-lg mb-6",children:[e.jsx("div",{className:"px-6 py-4 border-b border-blue-200",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900 text-right",children:"Edit Purchase Order Details"})}),e.jsxs("div",{className:"px-6 py-4",children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supplier Selection"}),e.jsx("input",{type:"text",placeholder:"Search suppliers...",value:E,onChange:t=>w(t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),E&&(v==null?void 0:v.length)>0&&e.jsx("div",{className:"mt-2 max-h-40 overflow-y-auto border border-gray-200 rounded-md bg-white shadow-lg",children:v.slice(0,5).map(t=>e.jsxs("div",{onClick:()=>{u(s=>({...s,supplier:t._id})),w(t.companyName||t.name)},className:"px-3 py-2 hover:bg-gray-100 cursor-pointer border-b border-gray-100 last:border-b-0",children:[e.jsx("div",{className:"font-medium",children:t.companyName||t.name}),e.jsx("div",{className:"text-sm text-gray-600",children:t.email})]},t._id))}),i.supplier&&e.jsxs("div",{className:"mt-2 p-2 bg-blue-50 rounded border",children:[e.jsxs("div",{className:"text-sm font-medium text-blue-900",children:["Selected: ",((He=l==null?void 0:l.supplierInfo)==null?void 0:He.companyName)||((Xe=l==null?void 0:l.supplierInfo)==null?void 0:Xe.name)||"Supplier"]}),e.jsx("button",{type:"button",onClick:()=>{u(t=>({...t,supplier:null})),w("")},className:"text-xs text-blue-600 hover:text-blue-800 mt-1",children:"Clear selection"})]})]})}),e.jsxs("div",{className:"flex flex-nowrap gap-3 items-end justify-end",children:[e.jsxs("div",{className:"flex flex-col w-44",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Invoice Number"}),e.jsx("input",{type:"text",value:i.invoiceNumber||"Auto-generated",onChange:t=>u(s=>({...s,invoiceNumber:t.target.value})),className:"input h-8 text-sm",placeholder:"Auto-generated",disabled:!0})]}),e.jsxs("div",{className:"flex flex-col w-48",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Expected Delivery"}),e.jsx("input",{type:"date",value:i.expectedDelivery,onChange:t=>u(s=>({...s,expectedDelivery:t.target.value})),className:"input h-8 text-sm"})]}),e.jsxs("div",{className:"flex flex-col w-40",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Tax Status"}),e.jsxs("div",{className:"flex items-center space-x-1 px-2 py-1 border border-gray-200 rounded h-8",children:[e.jsx("input",{type:"checkbox",id:"taxExemptEdit",checked:i.isTaxExempt,onChange:t=>u(s=>({...s,isTaxExempt:t.target.checked})),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("label",{htmlFor:"taxExemptEdit",className:"text-xs text-gray-700",children:"Tax Exempt"})]})]})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Notes"}),e.jsx("textarea",{value:i.notes,onChange:t=>u(s=>({...s,notes:t.target.value})),className:"input h-16 text-sm resize-none",placeholder:"Add any notes or comments..."})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Terms & Conditions"}),e.jsx("textarea",{value:i.terms,onChange:t=>u(s=>({...s,terms:t.target.value})),className:"input h-16 text-sm resize-none",placeholder:"Add terms and conditions..."})]})]})})]}),e.jsxs("div",{className:"px-6 py-4 border-t border-blue-200",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Product Selection & Cart Items"}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"grid grid-cols-12 gap-4 items-end",children:[e.jsxs("div",{className:"col-span-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product Search"}),e.jsx("input",{type:"text",placeholder:"Search or type product name...",value:le,onChange:t=>{t.stopPropagation(),R(t.target.value),T(-1)},onFocus:t=>t.stopPropagation(),onKeyDown:t=>{var a;if(t.stopPropagation(),!(A!=null&&A.length))return;const s=Math.min(A.length-1,4);switch(t.key){case"ArrowDown":t.preventDefault(),T(n=>n<s?n+1:0);break;case"ArrowUp":t.preventDefault(),T(n=>n>0?n-1:s);break;case"Enter":if(t.preventDefault(),be>=0&&A[be]){const n=A[be];G(n),z(((a=n.pricing)==null?void 0:a.costPrice)||0),L(1),R(n.name),T(-1),setTimeout(()=>{const r=document.querySelector(".modal-quantity-input");r&&r.focus()},100)}break;case"Escape":t.preventDefault(),T(-1);break}},className:"modal-product-search w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0}),A&&A.length>0&&e.jsx("div",{className:"mt-2 max-h-40 overflow-y-auto border border-gray-200 rounded-md bg-white shadow-lg",children:A.slice(0,5).map((t,s)=>{var a,n;return e.jsxs("div",{onClick:()=>{var r;G(t),z(((r=t.pricing)==null?void 0:r.costPrice)||0),L(1),R(t.name),T(-1),setTimeout(()=>{const c=document.querySelector(".modal-quantity-input");c&&c.focus()},100)},className:`px-3 py-2 cursor-pointer border-b border-gray-100 last:border-b-0 ${be===s?"bg-blue-100 border-blue-200":"hover:bg-gray-100"}`,children:[e.jsx("div",{className:"font-medium",children:t.name}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Stock: ",((a=t.inventory)==null?void 0:a.currentStock)||0," | Cost: ",((n=t.pricing)==null?void 0:n.costPrice)||0]})]},t._id)})})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quantity"}),e.jsx("input",{type:"number",min:"1",value:ee,onChange:t=>L(parseInt(t.target.value)||1),className:"modal-quantity-input w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"1"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cost Per Unit"}),e.jsx("input",{type:"number",step:"0.01",value:te,onChange:t=>z(parseFloat(t.target.value)||0),className:"modal-cost-input w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00"})]}),e.jsx("div",{className:"col-span-2",children:e.jsx("button",{type:"button",onClick:()=>{if(ge&&ee>0&&te>=0){const t={product:ge._id,quantity:ee,costPerUnit:te,totalCost:ee*te,productData:ge};u(s=>({...s,items:[...s.items,t]})),G(null),R(""),L(1),z(0),T(-1)}},disabled:!ge||ee<=0||te<0,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed",children:"Add Product"})})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Current Items:"}),i.items.length===0?e.jsx("p",{className:"text-sm text-gray-500 italic",children:"No items in this order"}):i.items.map((t,s)=>{var a;return e.jsxs("div",{className:"flex items-center p-3 bg-white border border-gray-200 rounded-lg",children:[e.jsx("div",{className:"font-medium text-gray-900 min-w-[200px] mr-4",children:((a=t.productData)==null?void 0:a.name)||"Unknown Product"}),e.jsxs("div",{className:"flex items-center space-x-3 ml-auto",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Qty:"}),e.jsx("input",{type:"number",min:"1",value:t.quantity,onChange:n=>{const r=[...i.items],c=Math.max(1,parseInt(n.target.value)||1);r[s].quantity=c,r[s].totalCost=c*r[s].costPerUnit,u(g=>({...g,items:r}))},className:"w-16 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("label",{className:"text-xs text-gray-600",children:"× Cost:"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:t.costPerUnit,onChange:n=>{const r=[...i.items],c=parseFloat(n.target.value)||0;r[s].costPerUnit=c,r[s].totalCost=r[s].quantity*c,u(g=>({...g,items:r}))},className:"w-20 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("label",{className:"text-xs text-gray-600",children:"="}),e.jsx("span",{className:"text-sm font-medium text-gray-900 min-w-[60px]",children:t.totalCost.toFixed(2)})]}),e.jsx("button",{type:"button",onClick:()=>{const n=i.items.filter((r,c)=>c!==s);u(r=>({...r,items:n}))},className:"px-2 py-1 text-sm bg-red-200 text-red-700 rounded hover:bg-red-300 ml-2",title:"Remove item",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},s)})]})]}),e.jsxs("div",{className:"px-6 py-4 border-t border-blue-200",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Order Items Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Total Items"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:i.items.length})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Total Quantity"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:i.items.reduce((t,s)=>t+s.quantity,0)})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Total Cost"}),e.jsx("div",{className:"text-lg font-semibold text-blue-600",children:Math.round(i.items.reduce((t,s)=>t+s.totalCost,0))})]})]})]}),e.jsx("div",{className:"px-6 py-4 border-t border-blue-200 bg-white rounded-b-lg",children:e.jsx("div",{className:"flex justify-end",children:e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Total Payables"}),e.jsx("div",{className:"text-2xl font-bold text-blue-900",children:Math.round(i.items.reduce((t,s)=>t+s.totalCost,0))})]})})}),e.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200",children:[e.jsx("button",{onClick:()=>{ue(!1),_(null),w(""),R(""),G(null),L(1),z(0),T(-1),H()},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:"Cancel"}),e.jsx("button",{onClick:At,disabled:_e||i.items.length===0,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-300 disabled:cursor-not-allowed",children:_e?"Updating...":"Update Purchase Order"})]})]})]})})}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(us,{className:"h-5 w-5 text-gray-400"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Filters"})]})}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-7 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"From Date"}),e.jsx("input",{type:"date",value:f.fromDate,onChange:t=>X("fromDate",t.target.value),className:"input h-[42px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"To Date"}),e.jsx("input",{type:"date",value:f.toDate,onChange:t=>X("toDate",t.target.value),className:"input h-[42px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"PO Number"}),e.jsx("input",{type:"text",placeholder:"Contains...",value:f.poNumber,onChange:t=>X("poNumber",t.target.value),className:"input h-[42px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:f.status,onChange:t=>X("status",t.target.value),className:"input h-[42px]",children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"draft",children:"Pending"}),e.jsx("option",{value:"confirmed",children:"Confirmed"}),e.jsx("option",{value:"partially_received",children:"Partially Received"}),e.jsx("option",{value:"fully_received",children:"Fully Received"}),e.jsx("option",{value:"cancelled",children:"Cancelled"}),e.jsx("option",{value:"closed",children:"Closed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Supplier"}),e.jsxs("select",{value:f.supplier,onChange:t=>X("supplier",t.target.value),className:"input h-[42px]",children:[e.jsx("option",{value:"",children:"All Suppliers"}),v==null?void 0:v.map(t=>e.jsx("option",{value:t._id,children:t.companyName||t.name||"Unknown"},t._id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Status"}),e.jsxs("select",{value:f.paymentStatus,onChange:t=>X("paymentStatus",t.target.value),className:"input h-[42px]",children:[e.jsx("option",{value:"",children:"All Payment Statuses"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"partial",children:"Partial"}),e.jsx("option",{value:"refunded",children:"Refunded"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("button",{onClick:()=>B(),className:"btn btn-primary w-full flex items-center justify-center space-x-2 h-[42px]",children:[e.jsx(De,{className:"h-4 w-4"}),e.jsx("span",{children:"Search"})]})})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Purchase Orders From: ",I(f.fromDate)," To: ",I(f.toDate)]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm text-gray-500",children:[zt.totalItems||0," records"]}),e.jsx("button",{onClick:()=>B(),className:"p-2 text-gray-400 hover:text-gray-600",title:"Refresh",children:e.jsx(mt,{className:"h-4 w-4"})})]})]})}),e.jsx("div",{className:"card-content p-0",children:vt?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(mt,{className:"h-8 w-8 animate-spin mx-auto text-gray-400"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"Loading purchase orders..."})]}):Ae?e.jsx("div",{className:"p-8 text-center text-red-600",children:e.jsxs("p",{children:["Error loading purchase orders: ",Ae.message]})}):Pe.length===0?e.jsx("div",{className:"p-8 text-center text-gray-500",children:e.jsx("p",{children:"No purchase orders found for the selected criteria."})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"PO #"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Supplier"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Pe.map((t,s)=>e.jsxs("tr",{className:s%2===0?"bg-white":"bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:I(t.createdAt)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t.poNumber}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:y(t.supplier)||"Unknown"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.jsx(gs,{status:t.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Math.round(t.total||0)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>qt(t),className:"text-blue-600 hover:text-blue-900",title:"View",children:e.jsx(ps,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>Se(t),className:"text-gray-600 hover:text-gray-900",title:"Print",children:e.jsx(pt,{className:"h-4 w-4"})}),(t.status==="draft"||t.status==="confirmed"||t.status==="partially_received"||t.status==="cancelled")&&e.jsx("button",{onClick:()=>_t(t),className:"text-indigo-600 hover:text-indigo-900",title:"Edit",children:e.jsx(hs,{className:"h-4 w-4"})}),t.status==="draft"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>Ut(t._id),className:"text-green-600 hover:text-green-900",title:"Confirm Order",children:e.jsx(Oe,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>Ft(t._id),className:"text-red-600 hover:text-red-900",title:"Cancel Order",children:e.jsx(Me,{className:"h-4 w-4"})})]}),(t.status==="draft"||t.status==="cancelled"||t.status==="confirmed"||t.status==="partially_received"||!t.supplier)&&e.jsx("button",{onClick:()=>It(t._id),className:"text-red-600 hover:text-red-900",title:"Delete",children:e.jsx(Te,{className:"h-4 w-4"})})]})})]},t._id))})]})})})]}),jt&&l&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsx("div",{className:"relative top-10 mx-auto p-5 border w-4/5 max-w-4xl shadow-lg rounded-md bg-white",children:e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Purchase Order"}),e.jsx("button",{onClick:()=>{Ne(!1),_(null)},className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:Ee}),me&&e.jsx("p",{className:"text-sm text-gray-600",children:me}),xe&&e.jsxs("p",{className:"text-sm text-gray-600",children:["Phone: ",xe]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-gray-900 mb-2",children:"Purchase Order Details"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"PO Number:"})," ",l.poNumber]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Date:"})," ",I(l.createdAt)]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Status:"}),e.jsx("span",{className:`ml-2 px-2 py-1 rounded-full text-xs font-medium ${l.status==="draft"?"bg-gray-100 text-gray-800":l.status==="confirmed"?"bg-blue-100 text-blue-800":l.status==="partially_received"?"bg-yellow-100 text-yellow-800":l.status==="fully_received"?"bg-green-100 text-green-800":l.status==="cancelled"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:l.status==="draft"?"Pending":l.status.replace("_"," ")})]}),l.expectedDelivery&&e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Expected Delivery:"})," ",I(l.expectedDelivery)]})]})]}),e.jsx("div",{}),e.jsxs("div",{className:"text-right",children:[e.jsx("h5",{className:"font-semibold text-gray-900 mb-2",children:"Supplier Details"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Company:"})," ",y(l.supplier)||"Unknown"]}),((Ze=l.supplier)==null?void 0:Ze.email)&&e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Email:"})," ",y(l.supplier.email)]}),((Je=l.supplier)==null?void 0:Je.phone)&&e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Phone:"})," ",y(l.supplier.phone)]}),((et=l.supplier)==null?void 0:et.contactPerson)&&e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Contact:"})," ",y(l.supplier.contactPerson)]}),e.jsx("div",{className:"mt-3 pt-2 border-t border-gray-200",children:e.jsxs("p",{className:"font-semibold text-red-600",children:[e.jsx("span",{className:"font-medium",children:"Outstanding Balance:"})," ",Math.round(((tt=l.supplier)==null?void 0:tt.pendingBalance)||0)]})})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h5",{className:"font-semibold text-gray-900 mb-3",children:"Items Ordered"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full border border-gray-200 rounded-lg",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b border-gray-200",children:"#"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b border-gray-200",children:"Product"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider border-b border-gray-200",children:"Quantity"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider border-b border-gray-200",children:"Unit Cost"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider border-b border-gray-200",children:"Total Cost"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.items&&l.items.map((t,s)=>{var a;return e.jsxs("tr",{className:s%2===0?"bg-white":"bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 border-b border-gray-200",children:s+1}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 border-b border-gray-200",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:y(t.product)||"Unknown Product"}),((a=t.product)==null?void 0:a.description)&&e.jsx("div",{className:"text-gray-500 text-xs",children:y(t.product.description)})]})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 text-right border-b border-gray-200",children:t.quantity}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 text-right border-b border-gray-200",children:Math.round(t.costPerUnit||0)}),e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900 text-right border-b border-gray-200",children:Math.round(t.totalCost||0)})]},s)})})]})})]}),e.jsx("div",{className:"flex justify-end mb-6",children:e.jsx("div",{className:"w-80",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Subtotal:"}),e.jsx("span",{className:"font-medium",children:Math.round(l.subtotal||0)})]}),l.tax&&l.tax>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Tax:"}),e.jsx("span",{className:"font-medium",children:Math.round(l.tax)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"PO Total:"}),e.jsx("span",{className:"font-medium",children:Math.round(l.total||0)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Previous Outstanding:"}),e.jsx("span",{className:"font-medium text-red-600",children:Math.round(((st=l.supplier)==null?void 0:st.pendingBalance)||0)})]}),e.jsxs("div",{className:"flex justify-between text-lg font-bold border-t pt-2",children:[e.jsx("span",{children:"Total Payables:"}),e.jsx("span",{className:"text-red-600",children:Math.round((l.total||0)+(((at=l.supplier)==null?void 0:at.pendingBalance)||0))})]})]})})}),l.notes&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h5",{className:"font-semibold text-gray-900 mb-2",children:"Notes"}),e.jsx("p",{className:"text-sm text-gray-600 bg-gray-50 p-3 rounded border",children:y(l.notes)})]}),l.terms&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h5",{className:"font-semibold text-gray-900 mb-2",children:"Terms & Conditions"}),e.jsx("p",{className:"text-sm text-gray-600 bg-gray-50 p-3 rounded border",children:y(l.terms)})]}),e.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[e.jsxs("div",{className:"text-xs text-gray-500",children:["Generated on ",new Date().toLocaleDateString()," at ",new Date().toLocaleTimeString()]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{onClick:()=>Se(l),className:"btn btn-primary flex items-center",children:[e.jsx(pt,{className:"h-4 w-4 mr-2"}),"Print"]}),e.jsx("button",{onClick:()=>{Ne(!1),_(null)},className:"btn btn-secondary",children:"Close"})]})]})]})})})]})};export{Ws as PurchaseOrders};
