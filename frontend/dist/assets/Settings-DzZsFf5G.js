import{a as ps,r as u,O as m,R as Ee,bK as hs,p as e,x as D,a1 as b,az as F,ad as se,a2 as te,ae,L as $,Q as Re,X as I,U as _s,a_ as ys,aZ as Le,C as Te,T as vs,y as H}from"./index-QHzcgHe1.js";import{u as gs,a as bs}from"./settingsApi-D-e2N-LC.js";import{u as ws,a as js,b as Ns,c as fs,d as ks,e as Cs,f as Ps}from"./usersApi-CgCX1t1y.js";import{P as Ie}from"./printer-Dmqc0NC_.js";import{P as re}from"./phone-DmhyAe7y.js";import{U as Ue}from"./upload-D2S2_33i.js";import{C as Me}from"./check-CWpXnlSq.js";import{S as ie}from"./save-CQRiczmt.js";import{U as Ss}from"./user-check-BIx6duV-.js";import{P as ne}from"./plus-wthIFHeq.js";import{L as Oe}from"./lock-8uvSbQ7f.js";import{P as qe}from"./pen-square-D_ZZfkE6.js";import{T as Ds}from"./trash-2-G7GOGhVq.js";import{E as A}from"./eye-off-rYnT668Z.js";import{E}from"./eye-D8xIUmp0.js";const Ks=()=>{var ke,Ce,Pe,Se;const{user:i}=ps(),[U,Be]=u.useState("company"),[a,j]=u.useState({companyName:"",address:"",contactNumber:"",email:"",logo:null,taxRegistrationNumber:""}),[ce,le]=u.useState(!1),[G,Y]=u.useState([]),[n,z]=u.useState(null),[l,R]=u.useState({firstName:"",lastName:"",email:"",password:"",role:"cashier",status:"active",permissions:{}}),[Q,Ve]=u.useState(!1),[Fe,J]=u.useState(!1),[$e,oe]=u.useState(!1),[L,M]=u.useState(null),[y,K]=u.useState(""),[O,X]=u.useState(""),[de,He]=u.useState(""),[N,me]=u.useState(!1),[f,ue]=u.useState(!1),[Z,Ge]=u.useState(!1),[xe,Ye]=u.useState({}),[x,W]=u.useState(null),[ze,pe]=u.useState(!1),[c,Qe]=u.useState({showLogo:!0,showDiscount:!0,showTax:!0,showDate:!0,headerText:"",footerText:"",invoiceLayout:"standard"}),Je={products:{name:"Product Management",permissions:[{key:"view_products",name:"View Products",subcategories:[{key:"view_product_list",name:"Product List"},{key:"view_product_details",name:"Product Details"},{key:"view_product_categories",name:"Categories"},{key:"view_product_inventory",name:"Inventory Levels"}]},{key:"create_products",name:"Create Products"},{key:"edit_products",name:"Edit Products"},{key:"delete_products",name:"Delete Products"}]},customers:{name:"Customer Management",permissions:[{key:"view_customers",name:"View Customers",subcategories:[{key:"view_customer_list",name:"Customer List"},{key:"view_customer_details",name:"Customer Details"},{key:"view_customer_history",name:"Purchase History"},{key:"view_customer_balance",name:"Account Balance"}]},{key:"create_customers",name:"Create Customers"},{key:"edit_customers",name:"Edit Customers"},{key:"delete_customers",name:"Delete Customers"}]},suppliers:{name:"Supplier Management",permissions:[{key:"view_suppliers",name:"View Suppliers",subcategories:[{key:"view_supplier_list",name:"Supplier List"},{key:"view_supplier_details",name:"Supplier Details"},{key:"view_supplier_orders",name:"Purchase Orders"},{key:"view_supplier_balance",name:"Account Balance"}]},{key:"create_suppliers",name:"Create Suppliers"},{key:"edit_suppliers",name:"Edit Suppliers"},{key:"delete_suppliers",name:"Delete Suppliers"}]},orders:{name:"Order Management",permissions:[{key:"view_orders",name:"View Orders",subcategories:[{key:"view_sales_orders",name:"Sales Orders"},{key:"view_purchase_orders",name:"Purchase Orders"},{key:"view_sales_invoices",name:"Sales Invoices"},{key:"view_purchase_invoices",name:"Purchase Invoices"}]},{key:"create_orders",name:"Create Orders"},{key:"edit_orders",name:"Edit Orders"},{key:"cancel_orders",name:"Cancel Orders"},{key:"view_cost_prices",name:"View Cost Prices"},{key:"create_purchase_orders",name:"Create Purchase Orders"},{key:"edit_purchase_orders",name:"Edit Purchase Orders"},{key:"delete_purchase_orders",name:"Delete Purchase Orders"},{key:"approve_purchase_orders",name:"Approve Purchase Orders"},{key:"reject_purchase_orders",name:"Reject Purchase Orders"},{key:"receive_purchase_orders",name:"Receive Purchase Orders"},{key:"create_purchase_invoices",name:"Create Purchase Invoices"},{key:"edit_purchase_invoices",name:"Edit Purchase Invoices"},{key:"delete_purchase_invoices",name:"Delete Purchase Invoices"},{key:"create_sales_orders",name:"Create Sales Orders"},{key:"edit_sales_orders",name:"Edit Sales Orders"},{key:"delete_sales_orders",name:"Delete Sales Orders"},{key:"approve_sales_orders",name:"Approve Sales Orders"},{key:"reject_sales_orders",name:"Reject Sales Orders"},{key:"create_sales_invoices",name:"Create Sales Invoices"},{key:"edit_sales_invoices",name:"Edit Sales Invoices"},{key:"void_sales_invoices",name:"Void Sales Invoices"},{key:"apply_discounts",name:"Apply Discounts"},{key:"override_prices",name:"Override Prices"}]},inventory:{name:"Inventory Management",permissions:[{key:"view_inventory",name:"View Inventory",subcategories:[{key:"view_inventory_levels",name:"Inventory Levels"},{key:"view_stock_movements",name:"Stock Movements"},{key:"view_inventory_reports",name:"Inventory Reports"},{key:"view_low_stock_alerts",name:"Low Stock Alerts"}]},{key:"update_inventory",name:"Update Inventory",subcategories:[{key:"update_stock_quantities",name:"Stock Quantities"},{key:"create_stock_adjustments",name:"Stock Adjustments"},{key:"process_receipts",name:"Process Receipts"}]},{key:"generate_purchase_orders",name:"Generate Purchase Orders"},{key:"acknowledge_inventory_alerts",name:"Acknowledge Inventory Alerts"},{key:"export_inventory_reports",name:"Export Inventory Reports"},{key:"import_inventory_data",name:"Import Inventory Data"}]},returns:{name:"Returns Management",permissions:[{key:"view_returns",name:"View Returns",subcategories:[{key:"view_return_requests",name:"Return Requests"},{key:"view_return_history",name:"Return History"},{key:"view_return_reasons",name:"Return Reasons"}]},{key:"create_returns",name:"Create Returns"},{key:"edit_returns",name:"Edit Returns"},{key:"approve_returns",name:"Approve Returns"},{key:"process_returns",name:"Process Returns"}]},discounts:{name:"Discount Management",permissions:[{key:"view_discounts",name:"View Discounts",subcategories:[{key:"view_discount_list",name:"Discount List"},{key:"view_discount_rules",name:"Discount Rules"},{key:"view_discount_history",name:"Discount History"}]},{key:"manage_discounts",name:"Manage Discounts",subcategories:[{key:"create_discounts",name:"Create Discounts"},{key:"edit_discounts",name:"Edit Discounts"},{key:"delete_discounts",name:"Delete Discounts"}]}]},reports:{name:"Reports & Analytics",permissions:[{key:"view_reports",name:"View Reports",subcategories:[{key:"view_pl_statements",name:"P&L Statements"},{key:"view_balance_sheets",name:"Balance Sheets"},{key:"view_sales_performance",name:"Sales Performance"},{key:"view_inventory_reports",name:"Inventory Reports"},{key:"view_general_reports",name:"Reports"},{key:"view_backdate_report",name:"Backdate Report"}]},{key:"view_analytics",name:"View Analytics"},{key:"view_customer_analytics",name:"Customer Analytics"},{key:"view_anomaly_detection",name:"Anomaly Detection & Fraud Prevention"},{key:"view_recommendations",name:"View Recommendations"},{key:"export_reports",name:"Export Reports"},{key:"share_reports",name:"Share Reports"},{key:"schedule_reports",name:"Schedule Reports"},{key:"view_advanced_analytics",name:"View Advanced Analytics"}]},admin:{name:"System Administration",permissions:[{key:"manage_users",name:"Manage Users",subcategories:[{key:"create_users",name:"Create Users"},{key:"edit_users",name:"Edit Users"},{key:"delete_users",name:"Delete Users"},{key:"assign_roles",name:"Assign Roles"}]},{key:"manage_settings",name:"Manage Settings",subcategories:[{key:"company_settings",name:"Company Settings"},{key:"system_settings",name:"System Settings"},{key:"print_settings",name:"Print Settings"},{key:"security_settings",name:"Security Settings"}]},{key:"view_backups",name:"View Backups",subcategories:[{key:"view_backup_list",name:"Backup List"},{key:"view_backup_logs",name:"Backup Logs"}]},{key:"manage_backups",name:"Manage Backups",subcategories:[{key:"create_backups",name:"Create Backups"},{key:"restore_backups",name:"Restore Backups"},{key:"delete_backups",name:"Delete Backups"}]},{key:"view_audit_logs",name:"View Audit Logs"},{key:"export_data",name:"Export Data"},{key:"import_data",name:"Import Data"},{key:"manage_integrations",name:"Manage Integrations"},{key:"configure_notifications",name:"Configure Notifications"}]},financial:{name:"Financial Operations",permissions:[{key:"view_cash_receipts",name:"Cash Receipts",subcategories:[{key:"view_cash_receipts",name:"View Cash Receipts"},{key:"create_cash_receipts",name:"Create Cash Receipts"},{key:"edit_cash_receipts",name:"Edit Cash Receipts"},{key:"delete_cash_receipts",name:"Delete Cash Receipts"}]},{key:"view_cash_payments",name:"Cash Payments",subcategories:[{key:"view_cash_payments",name:"View Cash Payments"},{key:"create_cash_payments",name:"Create Cash Payments"},{key:"edit_cash_payments",name:"Edit Cash Payments"},{key:"delete_cash_payments",name:"Delete Cash Payments"}]},{key:"view_bank_receipts",name:"Bank Receipts",subcategories:[{key:"view_bank_receipts",name:"View Bank Receipts"},{key:"create_bank_receipts",name:"Create Bank Receipts"},{key:"edit_bank_receipts",name:"Edit Bank Receipts"},{key:"delete_bank_receipts",name:"Delete Bank Receipts"}]},{key:"view_bank_payments",name:"Bank Payments",subcategories:[{key:"view_bank_payments",name:"View Bank Payments"},{key:"create_bank_payments",name:"Create Bank Payments"},{key:"edit_bank_payments",name:"Edit Bank Payments"},{key:"delete_bank_payments",name:"Delete Bank Payments"}]},{key:"view_expenses",name:"Expenses",subcategories:[{key:"view_expenses",name:"View Expenses"},{key:"create_expenses",name:"Create Expenses"},{key:"edit_expenses",name:"Edit Expenses"},{key:"delete_expenses",name:"Delete Expenses"},{key:"approve_expenses",name:"Approve Expenses"}]}]},accounting:{name:"Accounting",permissions:[{key:"view_accounting_transactions",name:"View Transactions"},{key:"view_accounting_accounts",name:"View Accounts"},{key:"view_trial_balance",name:"View Trial Balance"},{key:"update_balance_sheet",name:"Update Balance Sheet"},{key:"view_chart_of_accounts",name:"View Chart of Accounts"},{key:"view_accounting_summary",name:"View Financial Summary"}]},attendance:{name:"Attendance Management",permissions:[{key:"clock_attendance",name:"Clock Attendance"},{key:"clock_in",name:"Clock In"},{key:"clock_out",name:"Clock Out"},{key:"manage_attendance_breaks",name:"Manage Breaks"},{key:"view_own_attendance",name:"View Own Attendance"},{key:"view_team_attendance",name:"View Team Attendance"}]},till:{name:"Till Management",permissions:[{key:"open_till",name:"Open Till"},{key:"close_till",name:"Close Till"},{key:"view_till",name:"View Till"}]},investors:{name:"Investor Management",permissions:[{key:"view_investors",name:"View Investors"},{key:"manage_investors",name:"Manage Investors"},{key:"create_investors",name:"Create Investors"},{key:"edit_investors",name:"Edit Investors"},{key:"payout_investors",name:"Payout Investors"}]}},he={admin:{view_products:!0,create_products:!0,edit_products:!0,delete_products:!0,view_product_list:!0,view_product_details:!0,view_product_categories:!0,view_product_inventory:!0,view_customers:!0,create_customers:!0,edit_customers:!0,delete_customers:!0,view_customer_list:!0,view_customer_details:!0,view_customer_history:!0,view_customer_balance:!0,view_suppliers:!0,create_suppliers:!0,edit_suppliers:!0,delete_suppliers:!0,view_supplier_list:!0,view_supplier_details:!0,view_supplier_orders:!0,view_supplier_balance:!0,view_orders:!0,create_orders:!0,edit_orders:!0,cancel_orders:!0,view_sales_orders:!0,view_purchase_orders:!0,view_sales_invoices:!0,view_purchase_invoices:!0,view_cost_prices:!0,view_inventory:!0,update_inventory:!0,view_inventory_levels:!0,view_stock_movements:!0,view_low_stock_alerts:!0,update_stock_quantities:!0,create_stock_adjustments:!0,process_receipts:!0,view_returns:!0,create_returns:!0,edit_returns:!0,approve_returns:!0,process_returns:!0,view_return_requests:!0,view_return_history:!0,view_return_reasons:!0,view_discounts:!0,manage_discounts:!0,view_discount_list:!0,view_discount_rules:!0,view_discount_history:!0,create_discounts:!0,edit_discounts:!0,delete_discounts:!0,view_reports:!0,view_analytics:!0,view_recommendations:!0,view_pl_statements:!0,view_balance_sheets:!0,view_sales_performance:!0,view_inventory_reports:!0,view_general_reports:!0,view_backdate_report:!0,view_customer_analytics:!0,view_anomaly_detection:!0,export_reports:!0,share_reports:!0,schedule_reports:!0,view_advanced_analytics:!0,view_cash_receipts:!0,create_cash_receipts:!0,edit_cash_receipts:!0,delete_cash_receipts:!0,view_cash_payments:!0,create_cash_payments:!0,edit_cash_payments:!0,delete_cash_payments:!0,view_bank_receipts:!0,create_bank_receipts:!0,edit_bank_receipts:!0,delete_bank_receipts:!0,view_bank_payments:!0,create_bank_payments:!0,edit_bank_payments:!0,delete_bank_payments:!0,view_expenses:!0,create_expenses:!0,edit_expenses:!0,delete_expenses:!0,approve_expenses:!0,create_purchase_orders:!0,edit_purchase_orders:!0,delete_purchase_orders:!0,approve_purchase_orders:!0,reject_purchase_orders:!0,receive_purchase_orders:!0,create_purchase_invoices:!0,edit_purchase_invoices:!0,delete_purchase_invoices:!0,create_sales_orders:!0,edit_sales_orders:!0,delete_sales_orders:!0,approve_sales_orders:!0,reject_sales_orders:!0,create_sales_invoices:!0,edit_sales_invoices:!0,void_sales_invoices:!0,apply_discounts:!0,override_prices:!0,generate_purchase_orders:!0,acknowledge_inventory_alerts:!0,export_inventory_reports:!0,import_inventory_data:!0,view_accounting_transactions:!0,view_accounting_accounts:!0,view_trial_balance:!0,update_balance_sheet:!0,view_chart_of_accounts:!0,view_accounting_summary:!0,clock_attendance:!0,clock_in:!0,clock_out:!0,manage_attendance_breaks:!0,view_own_attendance:!0,view_team_attendance:!0,open_till:!0,close_till:!0,view_till:!0,view_investors:!0,manage_investors:!0,create_investors:!0,edit_investors:!0,payout_investors:!0,manage_users:!0,manage_settings:!0,view_backups:!0,manage_backups:!0,create_users:!0,edit_users:!0,delete_users:!0,assign_roles:!0,company_settings:!0,system_settings:!0,print_settings:!0,security_settings:!0,view_backup_list:!0,view_backup_logs:!0,create_backups:!0,restore_backups:!0,delete_backups:!0,view_audit_logs:!0,export_data:!0,import_data:!0,manage_integrations:!0,configure_notifications:!0},manager:{view_products:!0,create_products:!0,edit_products:!0,view_product_list:!0,view_product_details:!0,view_product_categories:!0,view_product_inventory:!0,view_customers:!0,create_customers:!0,edit_customers:!0,delete_customers:!0,view_customer_list:!0,view_customer_details:!0,view_customer_history:!0,view_customer_balance:!0,view_suppliers:!0,create_suppliers:!0,edit_suppliers:!0,delete_suppliers:!0,view_supplier_list:!0,view_supplier_details:!0,view_supplier_orders:!0,view_supplier_balance:!0,view_orders:!0,create_orders:!0,edit_orders:!0,cancel_orders:!0,view_sales_orders:!0,view_purchase_orders:!0,view_sales_invoices:!0,view_purchase_invoices:!0,view_cost_prices:!0,view_inventory:!0,update_inventory:!0,view_inventory_levels:!0,view_stock_movements:!0,view_low_stock_alerts:!0,update_stock_quantities:!0,create_stock_adjustments:!0,process_receipts:!0,view_returns:!0,create_returns:!0,edit_returns:!0,approve_returns:!0,process_returns:!0,view_return_requests:!0,view_return_history:!0,view_return_reasons:!0,view_discounts:!0,manage_discounts:!0,view_discount_list:!0,view_discount_rules:!0,view_discount_history:!0,create_discounts:!0,edit_discounts:!0,delete_discounts:!0,view_reports:!0,view_analytics:!0,view_recommendations:!0,view_pl_statements:!0,view_balance_sheets:!0,view_sales_performance:!0,view_inventory_reports:!0,view_general_reports:!0,view_backdate_report:!0,view_customer_analytics:!0,view_anomaly_detection:!0,export_reports:!0,share_reports:!0,schedule_reports:!0,view_advanced_analytics:!0,view_cash_receipts:!0,create_cash_receipts:!0,edit_cash_receipts:!0,delete_cash_receipts:!0,view_cash_payments:!0,create_cash_payments:!0,edit_cash_payments:!0,delete_cash_payments:!0,view_bank_receipts:!0,create_bank_receipts:!0,edit_bank_receipts:!0,delete_bank_receipts:!0,view_bank_payments:!0,create_bank_payments:!0,edit_bank_payments:!0,delete_bank_payments:!0,view_expenses:!0,create_expenses:!0,edit_expenses:!0,delete_expenses:!0,approve_expenses:!0,create_purchase_orders:!0,edit_purchase_orders:!0,delete_purchase_orders:!0,approve_purchase_orders:!0,reject_purchase_orders:!0,receive_purchase_orders:!0,create_purchase_invoices:!0,edit_purchase_invoices:!0,delete_purchase_invoices:!0,create_sales_orders:!0,edit_sales_orders:!0,delete_sales_orders:!0,approve_sales_orders:!0,reject_sales_orders:!0,create_sales_invoices:!0,edit_sales_invoices:!0,void_sales_invoices:!0,apply_discounts:!0,override_prices:!0,generate_purchase_orders:!0,acknowledge_inventory_alerts:!0,export_inventory_reports:!0,import_inventory_data:!0,view_accounting_transactions:!0,view_accounting_accounts:!0,view_trial_balance:!0,update_balance_sheet:!0,view_chart_of_accounts:!0,view_accounting_summary:!0,clock_attendance:!0,clock_in:!0,clock_out:!0,manage_attendance_breaks:!0,view_own_attendance:!0,view_team_attendance:!0,open_till:!0,close_till:!0,view_till:!0,view_investors:!0,manage_investors:!0,create_investors:!0,edit_investors:!0,payout_investors:!0},cashier:{view_products:!0,view_product_list:!0,view_product_details:!0,view_customers:!0,create_customers:!0,edit_customers:!0,view_customer_list:!0,view_customer_details:!0,view_orders:!0,create_orders:!0,view_sales_orders:!0,view_sales_invoices:!0,view_inventory:!0,view_inventory_levels:!0,view_stock_movements:!0,view_returns:!0,process_returns:!0,view_return_requests:!0,view_return_history:!0,view_discounts:!0,view_discount_list:!0,view_reports:!0,view_general_reports:!0},viewer:{view_products:!0,view_product_list:!0,view_product_details:!0,view_customers:!0,view_customer_list:!0,view_customer_details:!0,view_suppliers:!0,view_supplier_list:!0,view_supplier_details:!0,view_orders:!0,view_sales_orders:!0,view_purchase_orders:!0,view_sales_invoices:!0,view_purchase_invoices:!0,view_inventory:!0,view_inventory_levels:!0,view_returns:!0,view_return_requests:!0,view_return_history:!0,view_discounts:!0,view_discount_list:!0,view_reports:!0,view_pl_statements:!0,view_balance_sheets:!0,view_general_reports:!0}},{data:q,isLoading:h,refetch:k}=gs(),[Ke]=bs(),o=(q==null?void 0:q.data)||q;u.useEffect(()=>{if(o){const s={companyName:o.companyName||"",address:o.address||"",contactNumber:o.contactNumber||"",email:o.email||"",logo:o.logo||null,taxRegistrationNumber:o.taxId||""};j(s)}},[o]);const{data:p,isLoading:C,error:B,refetch:P}=ws(void 0,{onError:s=>{var t;(s==null?void 0:s.status)===403?m.error('Access denied. You need "manage_users" permission to view users.'):(s==null?void 0:s.status)===401?m.error("Authentication required. Please log in again."):m.error(`Failed to load users: ${((t=s==null?void 0:s.data)==null?void 0:t.message)||(s==null?void 0:s.message)||"Unknown error"}`),Y([])}});Ee.useEffect(()=>{var s;if(p){let t=null;if((s=p==null?void 0:p.data)!=null&&s.users&&Array.isArray(p.data.users))t=p.data.users;else if(p!=null&&p.users&&Array.isArray(p.users))t=p.users;else if(Array.isArray(p))t=p.filter(r=>r._id&&r.email);else{const r=(d,g=0)=>{var S,De;if(g>5)return null;if(Array.isArray(d)&&d.length>0&&(S=d[0])!=null&&S._id&&(De=d[0])!=null&&De.email)return d;if(typeof d=="object"&&d!==null)for(const V in d){if(V==="users"&&Array.isArray(d[V]))return d[V];const Ae=r(d[V],g+1);if(Ae)return Ae}return null};t=r(p)}t&&Array.isArray(t)?Y(t):Y([])}},[p]),u.useEffect(()=>{var s;(s=o==null?void 0:o.data)!=null&&s.data&&!h&&j(t=>{const r={companyName:o.data.data.companyName||"",address:o.data.data.address||"",contactNumber:o.data.data.contactNumber||"",email:o.data.data.email||"",logo:o.data.data.logo||null,taxRegistrationNumber:o.data.data.taxId||""};return JSON.stringify(t)!==JSON.stringify(r)?r:t})},[(ke=o==null?void 0:o.data)==null?void 0:ke.data,h]),u.useEffect(()=>{var s;if((s=o==null?void 0:o.data)!=null&&s.data&&!h){const t={companyName:o.data.data.companyName||"",address:o.data.data.address||"",contactNumber:o.data.data.contactNumber||"",email:o.data.data.email||"",logo:o.data.data.logo||null,taxRegistrationNumber:o.data.data.taxId||""};j(t)}},[]);const Xe=async s=>{le(!0);try{const t=await Ke(s).unwrap();if(m.success("Company information updated successfully!"),t!=null&&t.data){const r={companyName:t.data.companyName||"",address:t.data.address||"",contactNumber:t.data.contactNumber||"",email:t.data.email||"",logo:t.data.logo||null,taxRegistrationNumber:t.data.taxId||""};j(r)}k()}catch(t){H(t,"Company Information Update")}finally{le(!1)}},[Ze,{isLoading:We}]=js(),[es,{isLoading:ss}]=Ns(),[ts,{isLoading:As}]=fs(),[Es,{isLoading:_e}]=ks(),[Rs,{isLoading:ye}]=hs(),[Ls,{isLoading:ve}]=Cs(),{data:T,isLoading:as,refetch:Ts}=Ps(x==null?void 0:x.id,{skip:!(x!=null&&x.id)});Ee.useEffect(()=>{T!=null&&T.data&&W(s=>({...s,activity:T.data}))},[T]);const rs=async s=>{try{await Ze(s).unwrap(),m.success("User created successfully!"),ee(),P()}catch(t){H(t,"User Creation")}},is=async(s,t)=>{try{await es({id:s,...t}).unwrap(),m.success("User updated successfully!"),z(null),P()}catch(r){H(r,"User Update")}},ns=async s=>{try{await ts(s).unwrap(),m.success("User deleted successfully!"),P()}catch(t){H(t,"User Deletion")}},_=s=>{const{name:t,value:r}=s.target;j(d=>({...d,[t]:r}))},ge=s=>{s.preventDefault();const t={companyName:a.companyName,contactNumber:a.contactNumber,address:a.address,email:a.email,taxId:a.taxRegistrationNumber,logo:a.logo};Xe(t)},be=s=>{const t=s.target.files[0];t&&(j(r=>({...r,logo:t.name})),m.success("Logo uploaded successfully!"))},w=s=>{const{name:t,value:r}=s.target;R(d=>({...d,[t]:r})),t==="role"&&he[r]&&R(d=>({...d,permissions:he[r]}))},cs=s=>{if(s.preventDefault(),!l.firstName.trim()){m.error("First name is required");return}if(!l.lastName.trim()){m.error("Last name is required");return}if(!l.email.trim()){m.error("Email is required");return}if(!l.password.trim()){m.error("Password is required");return}if(l.password.length<6){m.error("Password must be at least 6 characters long");return}const t=Object.keys(l.permissions).filter(d=>l.permissions[d]),r={...l,permissions:t};rs(r)},ls=s=>{z(s);const t={};s.permissions&&Array.isArray(s.permissions)&&s.permissions.forEach(r=>{t[r]=!0}),R({firstName:s.firstName||"",lastName:s.lastName||"",email:s.email||"",password:"",role:s.role||"cashier",status:s.status||"active",permissions:t})},os=s=>{if(s.preventDefault(),n){if(!l.firstName.trim()){m.error("First name is required");return}if(!l.lastName.trim()){m.error("Last name is required");return}if(!l.email.trim()){m.error("Email is required");return}const t=Object.keys(l.permissions).filter(d=>l.permissions[d]),r={firstName:l.firstName,lastName:l.lastName,email:l.email,permissions:t};n._id!==(i==null?void 0:i._id)&&(r.role=l.role,r.status=l.status),is(n._id,r)}},ds=s=>{window.confirm("Are you sure you want to delete this user?")&&ns(s)},we=(s,t)=>{R(r=>({...r,permissions:{...r.permissions,[s]:t}})),l.role&&Ye(r=>({...r,[l.role]:{...r[l.role],[s]:t}}))},v=s=>{const{name:t,value:r,type:d,checked:g}=s.target;Qe(S=>({...S,[t]:d==="checkbox"?g:r}))},ee=()=>{R({firstName:"",lastName:"",email:"",password:"",role:"cashier",status:"active",permissions:{}}),z(null)},ms=()=>{if(!y.trim()){m.error("New password is required");return}if(y.length<6){m.error("Password must be at least 6 characters long");return}if(y!==O){m.error("Passwords do not match");return}const s=L||n;if(!(s!=null&&s._id)){m.error("User not selected");return}handleResetPassword(s._id,y)},je=()=>{if(!de.trim()){m.error("Current password is required");return}if(!y.trim()){m.error("New password is required");return}if(y.length<6){m.error("Password must be at least 6 characters long");return}if(y!==O){m.error("Passwords do not match");return}je()},Ne=(s=null)=>{M(s||n),J(!0),K(""),X("")},fe=s=>{if(!xe[s]){m.error("No permission changes detected for this role");return}if(window.confirm(`Are you sure you want to update permissions for ALL users with "${s}" role? This will override their current permissions.`)){const r=l.permissions,d=Object.keys(r);fe(s,d.filter(g=>r[g]))}},us=s=>{W({id:s._id,name:`${s.firstName} ${s.lastName}`,email:s.email,role:s.role}),pe(!0)};u.useEffect(()=>{k()},[k]);const xs=[{id:"company",name:"Company Information",icon:b},{id:"users",name:"Users Control",icon:F},{id:"print",name:"Print Preview Settings",icon:Ie}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Settings 2"}),e.jsx("p",{className:"text-gray-600",children:"Advanced system configuration and management"})]}),e.jsx("div",{className:"flex space-x-2",children:e.jsxs("button",{onClick:()=>{k(),P()},className:"btn btn-primary btn-sm",disabled:h||C,children:[e.jsx(D,{className:`h-4 w-4 mr-2 ${h||C?"animate-spin":""}`}),"Refresh"]})})]}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:xs.map(s=>{const t=s.icon;return e.jsxs("button",{onClick:()=>Be(s.id),className:`py-2 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 ${U===s.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(t,{className:"h-4 w-4"}),e.jsx("span",{children:s.name})]},s.id)})})}),e.jsxs("div",{className:"mt-6",children:[U==="company"&&e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{className:"h-5 w-5 text-gray-600"}),e.jsx("h2",{className:"text-lg font-semibold",children:"Company Information"})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Manage your company details and branding information"})]}),e.jsxs("div",{className:"card-content",children:[e.jsxs("form",{onSubmit:ge,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{className:"h-4 w-4"}),e.jsx("span",{children:"Company Name *"})]})}),e.jsx("input",{type:"text",name:"companyName",value:a.companyName,onChange:_,className:"input",placeholder:"Enter company name",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(re,{className:"h-4 w-4"}),e.jsx("span",{children:"Contact Number *"})]})}),e.jsx("input",{type:"text",name:"contactNumber",value:a.contactNumber,onChange:_,className:"input",placeholder:"Enter contact number",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(se,{className:"h-4 w-4"}),e.jsx("span",{children:"Email *"})]})}),e.jsx("input",{type:"email",name:"email",value:a.email,onChange:_,className:"input",placeholder:"Enter email address",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(te,{className:"h-4 w-4"}),e.jsx("span",{children:"Tax Registration Number"})]})}),e.jsx("input",{type:"text",name:"taxRegistrationNumber",value:a.taxRegistrationNumber,onChange:_,className:"input",placeholder:"Enter tax registration number"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ae,{className:"h-4 w-4"}),e.jsx("span",{children:"Address *"})]})}),e.jsx("textarea",{name:"address",value:a.address,onChange:_,className:"input",placeholder:"Enter complete address",rows:"3",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ue,{className:"h-4 w-4"}),e.jsx("span",{children:"Company Logo"})]})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:be,className:"input"}),a.logo&&e.jsxs("span",{className:"text-sm text-green-600 flex items-center",children:[e.jsx(Me,{className:"h-4 w-4 mr-1"}),a.logo]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Upload your company logo (PNG, JPG, GIF - Max 2MB)"})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t",children:e.jsxs($,{type:"submit",isLoading:ce,className:"btn btn-primary",children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Save Company Information"]})})]}),e.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{className:"h-5 w-5 text-blue-600"}),e.jsx("h3",{className:"text-lg font-semibold text-blue-800",children:"Current Saved Company Information"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:()=>{k()},className:"btn btn-primary btn-sm",disabled:h,children:[e.jsx(D,{className:`h-4 w-4 mr-2 ${h?"animate-spin":""}`}),h?"Loading...":"Load Data"]}),e.jsxs("button",{onClick:()=>{k()},className:"btn btn-secondary btn-sm",disabled:h,children:[e.jsx(D,{className:`h-4 w-4 mr-2 ${h?"animate-spin":""}`}),"Force Refresh"]}),e.jsx("div",{className:"text-sm text-blue-600",children:(o==null?void 0:o.updatedAt)&&e.jsxs("span",{children:["Last Updated: ",new Date(o.updatedAt).toLocaleString()]})})]})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"View and edit your currently saved company information. Changes here will update the saved data."}),e.jsxs("form",{onSubmit:ge,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-blue-800 mb-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{className:"h-4 w-4"}),e.jsx("span",{children:"Company Name *"})]})}),e.jsx("input",{type:"text",name:"companyName",value:a.companyName,onChange:_,className:"input bg-white border-blue-300 focus:border-blue-500",placeholder:"Enter company name",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-blue-800 mb-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(re,{className:"h-4 w-4"}),e.jsx("span",{children:"Contact Number *"})]})}),e.jsx("input",{type:"text",name:"contactNumber",value:a.contactNumber,onChange:_,className:"input bg-white border-blue-300 focus:border-blue-500",placeholder:"Enter contact number",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-blue-800 mb-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(se,{className:"h-4 w-4"}),e.jsx("span",{children:"Email *"})]})}),e.jsx("input",{type:"email",name:"email",value:a.email,onChange:_,className:"input bg-white border-blue-300 focus:border-blue-500",placeholder:"Enter email address",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-blue-800 mb-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(te,{className:"h-4 w-4"}),e.jsx("span",{children:"Tax Registration Number"})]})}),e.jsx("input",{type:"text",name:"taxRegistrationNumber",value:a.taxRegistrationNumber,onChange:_,className:"input bg-white border-blue-300 focus:border-blue-500",placeholder:"Enter tax registration number"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-blue-800 mb-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ae,{className:"h-4 w-4"}),e.jsx("span",{children:"Address *"})]})}),e.jsx("textarea",{name:"address",value:a.address,onChange:_,className:"input bg-white border-blue-300 focus:border-blue-500",placeholder:"Enter complete address",rows:"3",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-blue-800 mb-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ue,{className:"h-4 w-4"}),e.jsx("span",{children:"Company Logo"})]})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:be,className:"input bg-white border-blue-300 focus:border-blue-500"}),a.logo&&e.jsxs("span",{className:"text-sm text-green-600 flex items-center",children:[e.jsx(Me,{className:"h-4 w-4 mr-1"}),a.logo]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Upload your company logo (PNG, JPG, GIF - Max 2MB)"})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-blue-200",children:e.jsxs($,{type:"submit",isLoading:ce,className:"btn btn-primary bg-blue-600 hover:bg-blue-700",children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Update Company Information"]})})]})]})})]})]}),U==="users"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ss,{className:"h-5 w-5 text-gray-600"}),e.jsxs("h2",{className:"text-lg font-semibold",children:["System Users (",G.length,")"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>{ee();const s=document.getElementById("add-edit-user-form");s&&(s.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout(()=>{const t=s.querySelector('input[type="text"]');t&&t.focus()},300))},className:"btn btn-primary btn-sm",title:"Add New User",children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"Add New User"]}),e.jsxs("button",{onClick:()=>P(),className:"btn btn-secondary btn-sm",disabled:C,children:[e.jsx(D,{className:`h-4 w-4 mr-2 ${C?"animate-spin":""}`}),C?"Loading...":"Refresh Users"]})]})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Manage existing users and their permissions. Admin users have full system access."})]}),e.jsx("div",{className:"card-content",children:C?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(Re,{})}):B?e.jsx("div",{className:"text-center py-8",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md mx-auto",children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsx(I,{className:"h-12 w-12 text-red-500"})}),e.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Failed to Load Users"}),e.jsx("p",{className:"text-sm text-red-600 mb-4",children:((Ce=B.response)==null?void 0:Ce.status)===403?'You need "manage_users" permission to view users. Please contact an administrator.':((Pe=B.response)==null?void 0:Pe.status)===401?"Authentication required. Please refresh the page and log in again.":B.message||"An error occurred while loading users."}),e.jsxs("button",{onClick:()=>P(),className:"btn btn-primary btn-sm",children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Try Again"]})]})}):G.length>0?e.jsx("div",{className:"space-y-3",children:G.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"h-10 w-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(_s,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[s.firstName," ",s.lastName]}),e.jsx("p",{className:"text-xs text-gray-500",children:s.email}),e.jsxs("div",{className:"flex items-center space-x-3 mt-1",children:[e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${s.role==="admin"?"bg-red-100 text-red-800":s.role==="manager"?"bg-blue-100 text-blue-800":s.role==="cashier"?"bg-green-100 text-green-800":s.role==="inventory"?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`,children:s.role.charAt(0).toUpperCase()+s.role.slice(1)}),s.lastLogin&&e.jsxs("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${s.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:[e.jsx("div",{className:`w-2 h-2 rounded-full mr-1 ${s.isActive?"bg-green-400":"bg-red-400"}`}),s.isActive?"Active":"Inactive"]}),s.loginCount>0&&e.jsxs("span",{className:"text-xs text-gray-500",children:[s.loginCount," logins"]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`h-2 w-2 rounded-full ${s.status==="active"?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-xs text-gray-500",children:s.status==="active"?"Active":"Inactive"}),s._id===(i==null?void 0:i._id)&&e.jsx("span",{className:"text-xs text-blue-600 font-medium",children:"(You)"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>us(s),className:"btn btn-primary btn-sm",title:"View Activity",children:e.jsx(ys,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>Ne(s),className:"btn btn-secondary btn-sm",title:"Change Password",children:e.jsx(Oe,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>ls(s),className:"btn btn-secondary btn-sm",title:"Edit User",children:e.jsx(qe,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>ds(s._id),className:"btn btn-danger btn-sm",disabled:s._id===(i==null?void 0:i._id),title:"Delete User",children:e.jsx(Ds,{className:"h-4 w-4"})})]})]})]},s._id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(F,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-700 font-medium mb-2",children:"No users found"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"The system has no users registered yet. Use the form below to create your first user."}),e.jsxs("button",{onClick:()=>{const s=document.getElementById("add-edit-user-form");s&&(s.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout(()=>{const t=s.querySelector('input[type="text"]');t&&t.focus()},300))},className:"btn btn-primary btn-sm",children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"Create First User"]})]})})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(F,{className:"h-5 w-5 text-gray-600"}),e.jsx("h2",{className:"text-lg font-semibold",children:n?"Edit User":"Add New User"})]}),n&&e.jsxs("button",{onClick:ee,className:"btn btn-secondary btn-sm",children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Cancel Edit"]})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:n?"Update user information and permissions":"Create a new system user with specific roles and permissions"})]}),e.jsx("div",{className:"card-content",children:e.jsxs("form",{id:"add-edit-user-form",onSubmit:n?os:cs,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name *"}),e.jsx("input",{type:"text",name:"firstName",value:l.firstName,onChange:w,className:"input",placeholder:"Enter first name",autoComplete:"off",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name *"}),e.jsx("input",{type:"text",name:"lastName",value:l.lastName,onChange:w,className:"input",placeholder:"Enter last name",autoComplete:"off",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address *"}),e.jsx("input",{type:"email",name:"email",value:l.email,onChange:w,className:"input",placeholder:"Enter email address",autoComplete:"off",required:!0})]}),!n&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:Q?"text":"password",name:"password",value:l.password,onChange:w,className:"input pr-10",placeholder:"Enter password",autoComplete:"new-password",required:!0}),e.jsx("button",{type:"button",onClick:()=>Ve(!Q),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:Q?e.jsx(A,{className:"h-4 w-4 text-gray-400"}):e.jsx(E,{className:"h-4 w-4 text-gray-400"})})]})]}),n&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),e.jsxs("button",{type:"button",onClick:Ne,className:"btn btn-secondary w-full",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Change Password"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Click to reset the user's password"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Role * ",n&&n._id===(i==null?void 0:i._id)&&e.jsx("span",{className:"text-xs text-gray-500",children:"(Cannot change your own role)"})]}),e.jsxs("select",{name:"role",value:l.role,onChange:w,className:"input",required:!0,disabled:n&&n._id===(i==null?void 0:i._id),children:[e.jsx("option",{value:"cashier",children:"Cashier - Basic sales operations"}),e.jsx("option",{value:"manager",children:"Manager - Full operational access"}),e.jsx("option",{value:"admin",children:"Admin - Full system access including user management"}),e.jsx("option",{value:"viewer",children:"Viewer - Read-only access"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:n&&n._id===(i==null?void 0:i._id)?"You cannot change your own role. Contact another administrator if needed.":"Admin users have full system access and can manage other users"}),xe[l.role]&&e.jsx("div",{className:"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded-md",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"⚠️ Permission changes detected"}),e.jsxs("p",{className:"text-xs text-yellow-600 mt-1",children:["You've modified permissions for the ",l.role," role"]})]}),e.jsx("button",{type:"button",onClick:()=>fe(l.role),disabled:ve,className:"btn btn-warning btn-sm",children:ve?e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"h-4 w-4 mr-2 animate-spin"}),"Updating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Update All ",l.role,"s"]})})]})})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Status ",n&&n._id===(i==null?void 0:i._id)&&e.jsx("span",{className:"text-xs text-gray-500",children:"(Cannot change your own status)"})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"status",value:"active",checked:l.status==="active",onChange:w,className:"mr-2",disabled:n&&n._id===(i==null?void 0:i._id)}),e.jsx("span",{className:"text-sm text-gray-700",children:"Active"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"status",value:"inactive",checked:l.status==="inactive",onChange:w,className:"mr-2",disabled:n&&n._id===(i==null?void 0:i._id)}),e.jsx("span",{className:"text-sm text-gray-700",children:"Inactive"})]})]}),n&&n._id===(i==null?void 0:i._id)&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"You cannot change your own status. Contact another administrator if needed."}),!n&&e.jsx("div",{className:"mt-6",children:e.jsxs($,{type:"submit",isLoading:We,className:"btn btn-primary w-full",children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"Create User"]})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Le,{className:"h-4 w-4"}),e.jsx("span",{children:"Roles & Permissions"}),n&&n._id===(i==null?void 0:i._id)&&e.jsx("span",{className:"text-xs text-gray-500",children:"(Cannot modify your own permissions)"})]})}),n&&n._id===(i==null?void 0:i._id)?e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Note:"})," You cannot modify your own permissions. This prevents you from accidentally locking yourself out of the system. Contact another administrator if you need to change your permissions."]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(Je).map(([s,t])=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 h-fit",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3 border-b border-gray-100 pb-2",children:t.name}),e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:t.permissions.map(r=>e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center space-x-2 py-1 hover:bg-gray-50 rounded px-1",children:[e.jsx("input",{type:"checkbox",checked:l.permissions[r.key]||!1,onChange:d=>we(r.key,d.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-gray-700 font-medium truncate",children:r.name})]}),r.subcategories&&r.subcategories.length>0&&e.jsx("div",{className:"ml-4 mt-1 space-y-1",children:r.subcategories.map((d,g)=>e.jsxs("label",{className:"flex items-center space-x-2 py-1 hover:bg-blue-50 rounded px-1",children:[e.jsx("input",{type:"checkbox",checked:l.permissions[d.key]||!1,onChange:S=>we(d.key,S.target.checked),className:"h-3 w-3 text-blue-600 border-gray-300 rounded focus:ring-blue-500 flex-shrink-0"}),e.jsx("span",{className:"text-xs text-gray-600 truncate",children:d.name})]},d.key||g))})]},r.key))})]},s))})]}),n&&e.jsx("div",{className:"flex justify-end pt-4 border-t",children:e.jsxs($,{type:"submit",isLoading:ss,className:"btn btn-primary",children:[e.jsx(qe,{className:"h-4 w-4 mr-2"}),"Update User"]})})]},(n==null?void 0:n._id)||"new-user")})]})]}),U==="print"&&e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ie,{className:"h-5 w-5 text-gray-600"}),e.jsx("h2",{className:"text-lg font-semibold",children:"Print Preview Settings"})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Customize how your invoices and receipts appear when printed"})]}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-4",children:"Invoice/Sale Receipt Layout"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("label",{className:"flex items-center p-4 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"radio",name:"invoiceLayout",value:"standard",checked:c.invoiceLayout==="standard",onChange:v,className:"mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Standard"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Basic layout with company info"})]})]}),e.jsxs("label",{className:"flex items-center p-4 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"radio",name:"invoiceLayout",value:"compact",checked:c.invoiceLayout==="compact",onChange:v,className:"mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Compact"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Condensed layout for small receipts"})]})]}),e.jsxs("label",{className:"flex items-center p-4 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"radio",name:"invoiceLayout",value:"detailed",checked:c.invoiceLayout==="detailed",onChange:v,className:"mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Detailed"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Full layout with all information"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Header Text (Optional)"}),e.jsx("textarea",{name:"headerText",value:c.headerText,onChange:v,className:"input",placeholder:"Enter custom header text",rows:"3"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This text will appear at the top of printed documents"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Footer Text (Optional)"}),e.jsx("textarea",{name:"footerText",value:c.footerText,onChange:v,className:"input",placeholder:"Enter custom footer text",rows:"3"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This text will appear at the bottom of printed documents"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-4",children:"Display Options"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("label",{className:"flex items-center space-x-3 p-4 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"checkbox",name:"showLogo",checked:c.showLogo,onChange:v,className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Show Logo"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Display company logo on printed documents"})]})]}),e.jsxs("label",{className:"flex items-center space-x-3 p-4 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"checkbox",name:"showDiscount",checked:c.showDiscount,onChange:v,className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Show Discount"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Display discount information on receipts"})]})]}),e.jsxs("label",{className:"flex items-center space-x-3 p-4 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"checkbox",name:"showTax",checked:c.showTax,onChange:v,className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Show Tax"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Display tax calculations on receipts"})]})]}),e.jsxs("label",{className:"flex items-center space-x-3 p-4 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"checkbox",name:"showDate",checked:c.showDate,onChange:v,className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Show Date"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Display transaction date on receipts"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Print Preview"}),e.jsxs("p",{className:"text-xs text-gray-500 mb-4",children:["This preview shows how your receipts will appear with the actual saved company information.",!a.companyName&&!a.address&&!a.contactNumber&&e.jsx("span",{className:"text-orange-600 font-medium",children:" Please save your company information first to see the preview."})]}),e.jsxs("div",{className:"bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg p-8",children:[c.invoiceLayout==="standard"&&e.jsxs("div",{className:"max-w-md mx-auto bg-white p-6 rounded-lg shadow-sm",children:[c.headerText&&e.jsx("div",{className:"text-center text-sm text-gray-600 mb-4 border-b pb-2",children:c.headerText}),e.jsxs("div",{className:"text-center mb-4",children:[c.showLogo&&e.jsx("div",{className:"h-12 w-12 bg-gray-200 rounded mx-auto mb-2 flex items-center justify-center",children:e.jsx(b,{className:"h-6 w-6 text-gray-400"})}),e.jsx("div",{className:"text-lg font-bold text-gray-900",children:a.companyName||"Company Name"}),!a.companyName&&e.jsx("div",{className:"text-xs text-orange-600 mt-1",children:"(Company name not set)"}),a.address&&e.jsx("div",{className:"text-sm text-gray-700",children:a.address}),a.contactNumber&&e.jsxs("div",{className:"text-sm text-gray-700",children:["Phone: ",a.contactNumber]}),a.email&&e.jsxs("div",{className:"text-sm text-gray-700",children:["Email: ",a.email]}),a.taxRegistrationNumber&&e.jsxs("div",{className:"text-sm text-gray-700",children:["Tax ID: ",a.taxRegistrationNumber]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("div",{className:"text-center text-sm font-medium text-gray-900 mb-2",children:"SAMPLE RECEIPT"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Item 1"}),e.jsx("span",{children:"10.00"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Item 2"}),e.jsx("span",{children:"15.00"})]}),c.showDiscount&&e.jsxs("div",{className:"flex justify-between text-red-600",children:[e.jsx("span",{children:"Discount"}),e.jsx("span",{children:"-2.50"})]}),c.showTax&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Tax"}),e.jsx("span",{children:"2.25"})]}),e.jsxs("div",{className:"border-t pt-1 flex justify-between font-bold",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{children:"24.75"})]})]})]}),e.jsxs("div",{className:"border-t pt-3 mt-4",children:[c.footerText&&e.jsx("div",{className:"text-center text-xs text-gray-600 mb-2",children:c.footerText}),e.jsxs("div",{className:"text-center text-xs text-gray-500 space-y-1",children:[a.email&&e.jsxs("div",{children:["Email: ",a.email]}),a.taxRegistrationNumber&&e.jsxs("div",{children:["Tax ID: ",a.taxRegistrationNumber]})]}),c.showDate&&e.jsxs("div",{className:"text-center text-xs text-gray-500 mt-2",children:["Date: ",new Date().toLocaleDateString()]})]})]}),c.invoiceLayout==="compact"&&e.jsxs("div",{className:"max-w-xs mx-auto bg-white p-4 rounded-lg shadow-sm",children:[c.headerText&&e.jsx("div",{className:"text-center text-xs text-gray-600 mb-2 border-b pb-1",children:c.headerText}),e.jsxs("div",{className:"text-center mb-3",children:[c.showLogo&&e.jsx("div",{className:"h-8 w-8 bg-gray-200 rounded mx-auto mb-1 flex items-center justify-center",children:e.jsx(b,{className:"h-4 w-4 text-gray-400"})}),e.jsx("div",{className:"text-sm font-bold text-gray-900",children:a.companyName||"Your Company Name"}),a.address&&e.jsx("div",{className:"text-xs text-gray-600",children:a.address}),a.contactNumber&&e.jsx("div",{className:"text-xs text-gray-600",children:a.contactNumber})]}),e.jsxs("div",{className:"border-t pt-2",children:[e.jsx("div",{className:"text-center text-xs font-medium text-gray-900 mb-1",children:"SAMPLE RECEIPT"}),e.jsxs("div",{className:"space-y-0.5 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Item 1"}),e.jsx("span",{children:"10.00"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Item 2"}),e.jsx("span",{children:"15.00"})]}),c.showDiscount&&e.jsxs("div",{className:"flex justify-between text-red-600",children:[e.jsx("span",{children:"Discount"}),e.jsx("span",{children:"-2.50"})]}),c.showTax&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Tax"}),e.jsx("span",{children:"2.25"})]}),e.jsxs("div",{className:"border-t pt-0.5 flex justify-between font-bold text-sm",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{children:"24.75"})]})]})]}),e.jsxs("div",{className:"border-t pt-2 mt-2",children:[c.footerText&&e.jsx("div",{className:"text-center text-xs text-gray-600 mb-1",children:c.footerText}),c.showDate&&e.jsxs("div",{className:"text-center text-xs text-gray-500",children:["Date: ",new Date().toLocaleDateString()]})]})]}),c.invoiceLayout==="detailed"&&e.jsxs("div",{className:"max-w-lg mx-auto bg-white p-8 rounded-lg shadow-sm",children:[c.headerText&&e.jsx("div",{className:"text-center text-base text-gray-700 mb-4 border-b-2 pb-3",children:c.headerText}),e.jsxs("div",{className:"text-center mb-6",children:[c.showLogo&&e.jsx("div",{className:"h-16 w-16 bg-gray-200 rounded-lg mx-auto mb-3 flex items-center justify-center",children:e.jsx(b,{className:"h-8 w-8 text-gray-400"})}),e.jsx("div",{className:"text-xl font-bold text-gray-900 mb-2",children:a.companyName||"Company Name"}),!a.companyName&&e.jsx("div",{className:"text-xs text-orange-600 mb-2",children:"(Company name not set)"}),e.jsxs("div",{className:"space-y-1 text-sm text-gray-700",children:[a.address&&e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(ae,{className:"h-4 w-4 mr-1"}),a.address]}),a.contactNumber&&e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(re,{className:"h-4 w-4 mr-1"}),a.contactNumber]}),a.email&&e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(se,{className:"h-4 w-4 mr-1"}),a.email]}),a.taxRegistrationNumber&&e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(te,{className:"h-4 w-4 mr-1"}),"Tax ID: ",a.taxRegistrationNumber]})]})]}),e.jsxs("div",{className:"border-t-2 pt-4",children:[e.jsx("div",{className:"text-center text-base font-semibold text-gray-900 mb-4",children:"SAMPLE RECEIPT"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between py-1 border-b border-gray-100",children:[e.jsx("span",{className:"font-medium",children:"Item 1"}),e.jsx("span",{className:"font-medium",children:"10.00"})]}),e.jsxs("div",{className:"flex justify-between py-1 border-b border-gray-100",children:[e.jsx("span",{className:"font-medium",children:"Item 2"}),e.jsx("span",{className:"font-medium",children:"15.00"})]}),c.showDiscount&&e.jsxs("div",{className:"flex justify-between py-1 text-red-600 border-b border-gray-100",children:[e.jsx("span",{className:"font-medium",children:"Discount"}),e.jsx("span",{className:"font-medium",children:"-2.50"})]}),c.showTax&&e.jsxs("div",{className:"flex justify-between py-1 border-b border-gray-100",children:[e.jsx("span",{className:"font-medium",children:"Tax"}),e.jsx("span",{className:"font-medium",children:"2.25"})]}),e.jsxs("div",{className:"border-t-2 pt-2 flex justify-between font-bold text-base mt-2",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{children:"24.75"})]})]})]}),e.jsxs("div",{className:"border-t-2 pt-4 mt-6",children:[c.footerText&&e.jsx("div",{className:"text-center text-sm text-gray-700 mb-3 border-b pb-2",children:c.footerText}),e.jsxs("div",{className:"text-center text-xs text-gray-500 space-y-1 mb-2",children:[a.email&&e.jsxs("div",{children:["Email: ",a.email]}),a.taxRegistrationNumber&&e.jsxs("div",{children:["Tax ID: ",a.taxRegistrationNumber]})]}),c.showDate&&e.jsxs("div",{className:"text-center text-sm text-gray-600 mt-3 font-medium",children:["Date: ",new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})]})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t",children:e.jsxs("button",{type:"button",onClick:()=>m.success("Print settings saved!"),className:"btn btn-primary",children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Save Print Settings"]})})]})})]}),ze&&x&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"User Activity Dashboard"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[x.name," (",x.email,")"]})]}),e.jsx("button",{onClick:()=>{pe(!1),W(null)},className:"text-gray-400 hover:text-gray-600",children:e.jsx(I,{className:"h-5 w-5"})})]}),as?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(Re,{})}):x.activity?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Te,{className:"h-8 w-8 text-blue-600 mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-800",children:"Last Login"}),e.jsx("p",{className:"text-lg font-semibold text-blue-900",children:x.activity.lastLogin?new Date(x.activity.lastLogin).toLocaleString():"Never"})]})]})}),e.jsx("div",{className:"bg-green-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(vs,{className:"h-8 w-8 text-green-600 mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-800",children:"Total Logins"}),e.jsx("p",{className:"text-lg font-semibold text-green-900",children:x.activity.loginCount||0})]})]})}),e.jsx("div",{className:"bg-purple-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`h-8 w-8 rounded-full mr-3 flex items-center justify-center ${x.activity.isOnline?"bg-green-500":"bg-gray-400"}`,children:e.jsx("div",{className:"h-3 w-3 bg-white rounded-full"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-purple-800",children:"Status"}),e.jsx("p",{className:"text-lg font-semibold text-purple-900",children:x.activity.isOnline?"Online":"Offline"})]})]})})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("h4",{className:"text-md font-semibold flex items-center",children:[e.jsx(Te,{className:"h-5 w-5 mr-2"}),"Recent Login History"]})}),e.jsx("div",{className:"p-4",children:x.activity.loginHistory&&x.activity.loginHistory.length>0?e.jsx("div",{className:"space-y-3",children:x.activity.loginHistory.map((s,t)=>{var r;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:new Date(s.loginTime).toLocaleString()}),e.jsxs("p",{className:"text-xs text-gray-500",children:["IP: ",s.ipAddress]})]}),e.jsx("div",{className:"text-xs text-gray-500",children:((r=s.userAgent)==null?void 0:r.split(" ")[0])||"Unknown"})]},t)})}):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No login history available"})})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("h4",{className:"text-md font-semibold flex items-center",children:[e.jsx(Le,{className:"h-5 w-5 mr-2"}),"Permission Change History"]})}),e.jsx("div",{className:"p-4",children:x.activity.permissionHistory&&x.activity.permissionHistory.length>0?e.jsx("div",{className:"space-y-3",children:x.activity.permissionHistory.map((s,t)=>e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${s.changeType==="created"?"bg-green-100 text-green-800":s.changeType==="role_changed"?"bg-blue-100 text-blue-800":s.changeType==="permissions_modified"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:s.changeType.replace("_"," ").toUpperCase()}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(s.changedAt).toLocaleString()})]}),e.jsxs("p",{className:"text-sm text-gray-700 mb-1",children:["Changed by: ",s.changedBy?`${s.changedBy.firstName} ${s.changedBy.lastName}`:"System"]}),s.notes&&e.jsx("p",{className:"text-xs text-gray-600",children:s.notes})]},t))}):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No permission changes recorded"})})]})]}):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"Failed to load activity data"})})]})}),Fe&&(L||n)&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Reset Password"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:((Se=L||n)==null?void 0:Se.email)&&`Resetting password for: ${(L||n).email}`})]}),e.jsx("button",{onClick:()=>{J(!1),M(null)},className:"text-gray-400 hover:text-gray-600",children:e.jsx(I,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Password *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:N?"text":"password",value:y,onChange:s=>K(s.target.value),className:"input pr-10",placeholder:"Enter new password"}),e.jsx("button",{type:"button",onClick:()=>me(!N),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:N?e.jsx(A,{className:"h-4 w-4 text-gray-400"}):e.jsx(E,{className:"h-4 w-4 text-gray-400"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm Password *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:f?"text":"password",value:O,onChange:s=>X(s.target.value),className:"input pr-10",placeholder:"Confirm new password"}),e.jsx("button",{type:"button",onClick:()=>ue(!f),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:f?e.jsx(A,{className:"h-4 w-4 text-gray-400"}):e.jsx(E,{className:"h-4 w-4 text-gray-400"})})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{onClick:()=>{J(!1),M(null)},className:"btn btn-secondary",children:"Cancel"}),e.jsx("button",{onClick:ms,disabled:_e||!(L||n),className:"btn btn-primary",children:_e?"Resetting...":"Reset Password"})]})]})}),$e&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Change My Password"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:(i==null?void 0:i.email)&&`Changing password for: ${i.email}`})]}),e.jsx("button",{onClick:()=>oe(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(I,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Password *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:Z?"text":"password",value:de,onChange:s=>He(s.target.value),className:"input pr-10",placeholder:"Enter current password"}),e.jsx("button",{type:"button",onClick:()=>Ge(!Z),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:Z?e.jsx(A,{className:"h-4 w-4 text-gray-400"}):e.jsx(E,{className:"h-4 w-4 text-gray-400"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Password *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:N?"text":"password",value:y,onChange:s=>K(s.target.value),className:"input pr-10",placeholder:"Enter new password"}),e.jsx("button",{type:"button",onClick:()=>me(!N),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:N?e.jsx(A,{className:"h-4 w-4 text-gray-400"}):e.jsx(E,{className:"h-4 w-4 text-gray-400"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm New Password *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:f?"text":"password",value:O,onChange:s=>X(s.target.value),className:"input pr-10",placeholder:"Confirm new password"}),e.jsx("button",{type:"button",onClick:()=>ue(!f),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:f?e.jsx(A,{className:"h-4 w-4 text-gray-400"}):e.jsx(E,{className:"h-4 w-4 text-gray-400"})})]})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-3",children:e.jsxs("p",{className:"text-xs text-blue-800",children:[e.jsx("strong",{children:"Note:"})," You must enter your current password to change it to a new one."]})})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{onClick:()=>oe(!1),className:"btn btn-secondary",children:"Cancel"}),e.jsx("button",{onClick:je,disabled:ye,className:"btn btn-primary",children:ye?"Changing...":"Change Password"})]})]})})]})]})};export{Ks as Settings2,Ks as default};
