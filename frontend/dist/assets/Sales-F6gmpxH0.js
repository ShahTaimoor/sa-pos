import{D as kt,E as _t,r as c,p as e,X as as,F as ns,G as tt,L as pe,B as se,y as re,H as at,P as Pe,I as vt,t as nt,T as rt,x as st,J as cs,K as is,u as os,a as ls,d as ds,M as us,N as ms,O as X,z as B,U as xs,s as ps,A as hs,v as fs,Q as gs,R as ys}from"./index-DaTQeIrM.js";import{u as At,b as $t,a as bs}from"./productsApi-CuUSDwZw.js";import{u as js}from"./banksApi-BjGxgmxs.js";import{u as vs}from"./useFuzzySearch-BgntWuv8.js";import{S as Tt}from"./SearchableDropdown-OW0MXnv1.js";import{A as Ns}from"./AsyncErrorBoundary-BPQ7SV4v.js";import{C as ws}from"./ConfirmationDialog-DxRMdj0p.js";import{u as Ps}from"./useConfirmation-C3qnwA_z.js";import{C as Ss}from"./check-D4trJhmm.js";import{A as xe}from"./alert-circle-3gdbj3DL.js";import{P as Cs}from"./PrintModal-faBbSLsh.js";import{E as ct}from"./eye-DQ0qHB88.js";import{H as ks,S as We}from"./sparkles-DaslYAcR.js";import{S as _s}from"./star-uKxSgdal.js";import{g as As}from"./ComponentRegistry-DXgiU2WN.js";import{C as $s,B as Ts}from"./BarcodeScanner-mW7EPbdL.js";import{D as Nt}from"./download-sNUxQ2Ce.js";import{P as Mt}from"./plus-CH9F90nm.js";import{E as Ms}from"./eye-off-yu1ZFiMM.js";import{C as Rs}from"./calculator-C67OGIjx.js";import{H as Es}from"./history-DotX95kV.js";import{C as wt}from"./check-circle-C7Swk4iC.js";import{I as Pt}from"./info-geJWZ_yE.js";import{T as St}from"./trash-2-NO2IJ0Re.js";import{P as Ls}from"./printer-sSBWtYCz.js";import{X as Is}from"./x-circle-CEJfwNq8.js";import"./chevron-down-5FLXPK9w.js";import"./shield-DyTx0jkP.js";import"./useCompanyInfo-x6rWwbVQ.js";import"./settingsApi-B2ylrE_e.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bs=kt("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=kt("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),Os=_t.injectEndpoints({endpoints:P=>({processPayment:P.mutation({query:a=>({url:"payments/process",method:"post",data:a}),invalidatesTags:[{type:"Sales",id:"LIST"},{type:"Sales",id:"PAYMENT_HISTORY"},{type:"Orders",id:"LIST"}]}),processRefund:P.mutation({query:({paymentId:a,...f})=>({url:`payments/${a}/refund`,method:"post",data:f}),invalidatesTags:[{type:"Sales",id:"LIST"},{type:"Sales",id:"PAYMENT_HISTORY"},{type:"Orders",id:"LIST"}]}),voidTransaction:P.mutation({query:({transactionId:a,reason:f})=>({url:`payments/transactions/${a}/void`,method:"post",data:{reason:f}}),invalidatesTags:[{type:"Sales",id:"LIST"},{type:"Sales",id:"PAYMENT_HISTORY"},{type:"Orders",id:"LIST"}]}),getPaymentHistory:P.query({query:(a={})=>({url:"payments",method:"get",params:a}),providesTags:a=>{var $;const f=(($=a==null?void 0:a.data)==null?void 0:$.payments)||(a==null?void 0:a.payments)||(a==null?void 0:a.items)||[];return f.length?[...f.map(({_id:u,id:N})=>({type:"Sales",id:u||N})),{type:"Sales",id:"PAYMENT_HISTORY"}]:[{type:"Sales",id:"PAYMENT_HISTORY"}]}}),getPaymentDetails:P.query({query:a=>({url:`payments/${a}`,method:"get"}),providesTags:(a,f,$)=>[{type:"Sales",id:$}]}),getPaymentStats:P.query({query:({startDate:a,endDate:f})=>({url:"payments/stats",method:"get",params:{startDate:a,endDate:f}}),providesTags:[{type:"Sales",id:"PAYMENT_STATS"}]}),getPaymentMethods:P.query({query:()=>({url:"payments/methods",method:"get"}),providesTags:[{type:"Settings",id:"PAYMENT_METHODS"}]})}),overrideExisting:!1}),{useProcessPaymentMutation:Fs}=Os,qs=({isOpen:P,onClose:a,orderData:f,onPaymentSuccess:$,onPaymentError:u})=>{var D;const[N,s]=c.useState(""),[O,H]=c.useState(""),[g,C]=c.useState({number:"",expiryMonth:"",expiryYear:"",cvc:"",holderName:""}),[U,F]=c.useState(!1),[m,j]=c.useState({}),[q]=Fs(),x=[{id:"cash",name:"Cash",icon:ns,description:"Cash payment",color:"text-green-600",bgColor:"bg-green-50",borderColor:"border-green-200"},{id:"credit_card",name:"Credit Card",icon:tt,description:"Visa, Mastercard, Amex",color:"text-blue-600",bgColor:"bg-blue-50",borderColor:"border-blue-200"},{id:"debit_card",name:"Debit Card",icon:tt,description:"Visa, Mastercard debit",color:"text-purple-600",bgColor:"bg-purple-50",borderColor:"border-purple-200"},{id:"digital_wallet",name:"Digital Wallet",icon:Ct,description:"Apple Pay, Google Pay",color:"text-orange-600",bgColor:"bg-orange-50",borderColor:"border-orange-200"},{id:"check",name:"Check",icon:Ss,description:"Check payment",color:"text-gray-600",bgColor:"bg-gray-50",borderColor:"border-gray-200"},{id:"gift_card",name:"Gift Card",icon:Bs,description:"Store gift card",color:"text-pink-600",bgColor:"bg-pink-50",borderColor:"border-pink-200"},{id:"store_credit",name:"Store Credit",icon:tt,description:"Store credit account",color:"text-indigo-600",bgColor:"bg-indigo-50",borderColor:"border-indigo-200"}];c.useEffect(()=>{f&&f.total&&H(f.total.toString())},[f]),c.useEffect(()=>{P||(s(""),H(""),C({number:"",expiryMonth:"",expiryYear:"",cvc:"",holderName:""}),j({}))},[P]);const w=()=>{const d={};return N||(d.method="Please select a payment method"),(!O||parseFloat(O)<=0)&&(d.amount="Please enter a valid amount"),f&&parseFloat(O)>f.total&&(d.amount="Amount cannot exceed order total"),["credit_card","debit_card"].includes(N)&&((!g.number||g.number.length<13)&&(d.cardNumber="Please enter a valid card number"),(!g.expiryMonth||!g.expiryYear)&&(d.cardExpiry="Please enter card expiry date"),(!g.cvc||g.cvc.length<3)&&(d.cardCvc="Please enter a valid CVC"),g.holderName||(d.cardHolder="Please enter cardholder name")),j(d),Object.keys(d).length===0},k=async()=>{if(w()){F(!0),j({});try{const d={orderId:f._id,paymentMethod:N,amount:parseFloat(O),currency:"USD",gateway:["credit_card","debit_card","digital_wallet"].includes(N)?"stripe":"manual",cardDetails:["credit_card","debit_card"].includes(N)?g:void 0,metadata:{terminalId:"POS_001",location:"Main Store",ipAddress:"127.0.0.1",userAgent:navigator.userAgent}},b=await q(d).unwrap();if(b.success)se("Payment processed successfully!"),$&&$(b.data),a();else throw new Error(b.message||"Payment processing failed")}catch(d){re(d,"Payment Processing"),u&&u(d)}finally{F(!1)}}},_=d=>{const b=d.replace(/\s+/g,"").replace(/[^0-9]/gi,""),L=b.match(/\d{4,16}/g),Q=L&&L[0]||"",T=[];for(let G=0,K=Q.length;G<K;G+=4)T.push(Q.substring(G,G+4));return T.length?T.join(" "):b},E=d=>{const b=_(d.target.value);C(L=>({...L,number:b}))};return P?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Process Payment"}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(as,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[f&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Order Summary"}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Order #:"}),e.jsx("span",{children:f.orderNumber||f._id})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Amount:"}),e.jsxs("span",{className:"font-medium",children:["$",(D=f.total)==null?void 0:D.toFixed(2)]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Select Payment Method"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:x.map(d=>{const b=d.icon;return e.jsx("button",{onClick:()=>s(d.id),className:`p-4 rounded-lg border-2 transition-all ${N===d.id?`${d.borderColor} ${d.bgColor} ring-2 ring-offset-2 ring-current`:"border-gray-200 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(b,{className:`h-6 w-6 ${d.color}`}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:`font-medium ${d.color}`,children:d.name}),e.jsx("div",{className:"text-xs text-gray-500",children:d.description})]})]})},d.id)})}),m.method&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[e.jsx(xe,{className:"h-4 w-4 mr-1"}),m.method]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Amount"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"$"})}),e.jsx("input",{type:"number",step:"0.01",min:"0",max:(f==null?void 0:f.total)||999999,value:O,onChange:d=>H(d.target.value),className:"block w-full pl-7 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"0.00"})]}),m.amount&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[e.jsx(xe,{className:"h-4 w-4 mr-1"}),m.amount]})]}),["credit_card","debit_card"].includes(N)&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"Card Details"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Card Number"}),e.jsx("input",{type:"text",value:g.number,onChange:E,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"1234 5678 9012 3456",maxLength:"19"}),m.cardNumber&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[e.jsx(xe,{className:"h-4 w-4 mr-1"}),m.cardNumber]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expiry Date"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"number",value:g.expiryMonth,onChange:d=>C(b=>({...b,expiryMonth:d.target.value})),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"MM",min:"1",max:"12"}),e.jsx("input",{type:"number",value:g.expiryYear,onChange:d=>C(b=>({...b,expiryYear:d.target.value})),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"YYYY",min:"2024"})]}),m.cardExpiry&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[e.jsx(xe,{className:"h-4 w-4 mr-1"}),m.cardExpiry]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CVC"}),e.jsx("input",{type:"text",value:g.cvc,onChange:d=>C(b=>({...b,cvc:d.target.value.replace(/\D/g,"")})),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"123",maxLength:"4"}),m.cardCvc&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[e.jsx(xe,{className:"h-4 w-4 mr-1"}),m.cardCvc]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cardholder Name"}),e.jsx("input",{type:"text",value:g.holderName,onChange:d=>C(b=>({...b,holderName:d.target.value})),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"John Doe"}),m.cardHolder&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[e.jsx(xe,{className:"h-4 w-4 mr-1"}),m.cardHolder]})]})]}),N==="digital_wallet"&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ct,{className:"h-5 w-5 text-blue-600 mr-2"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium",children:"Digital Wallet Payment"}),e.jsx("p",{children:"This will open your digital wallet for payment processing."})]})]})})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t bg-gray-50",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",disabled:U,children:"Cancel"}),e.jsx(pe,{onClick:k,loading:U,className:"px-4 py-2 text-sm font-medium text-white bg-primary-600 border border-transparent rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:U?"Processing...":"Process Payment"})]})]})}):null},Ds=_t.injectEndpoints({endpoints:P=>({generateRecommendations:P.mutation({query:a=>({url:"recommendations/generate",method:"post",data:a})}),getRecommendation:P.query({query:a=>({url:`recommendations/${a}`,method:"get"}),providesTags:(a,f,$)=>[{type:"Settings",id:`RECOMMENDATION_${$}`}]}),trackInteraction:P.mutation({query:({recommendationId:a,...f})=>({url:`recommendations/${a}/interactions`,method:"post",data:f})}),trackBehavior:P.mutation({query:a=>({url:"recommendations/behavior",method:"post",data:a})}),getPerformance:P.query({query:a=>({url:"recommendations/performance",method:"get",params:a}),providesTags:[{type:"Reports",id:"RECOMMENDATIONS_PERFORMANCE"}]}),getUserRecommendations:P.query({query:({userId:a,...f})=>({url:`recommendations/user/${a}`,method:"get",params:f}),providesTags:(a,f,{userId:$})=>[{type:"Settings",id:`USER_RECOMMENDATIONS_${$}`}]})}),overrideExisting:!1}),{useGenerateRecommendationsMutation:Us,useTrackInteractionMutation:Ys,useTrackBehaviorMutation:Hs}=Ds,Gs=({src:P,webpSrc:a,alt:f="",className:$="",sizes:u=null,lazy:N=!0,fallback:s=null,style:O={},...H})=>{const[g,C]=c.useState(!1),[U,F]=c.useState(!1),[m,j]=c.useState(!N),q=c.useRef(null);c.useEffect(()=>{if(!N||m)return;const d=new IntersectionObserver(b=>{b.forEach(L=>{L.isIntersecting&&(j(!0),d.disconnect())})},{rootMargin:"50px"});return q.current&&d.observe(q.current),()=>{q.current&&d.unobserve(q.current),d.disconnect()}},[N,m]);const x=()=>{if(!u||!a)return null;const d=[],b=a.replace(/\.webp$/,"");return u.thumbnail&&d.push(`${b}_thumbnail.webp 150w`),u.small&&d.push(`${b}_small.webp 300w`),u.medium&&d.push(`${b}_medium.webp 600w`),u.large&&d.push(`${b}_large.webp 1200w`),d.length>0?d.join(", "):null},w=()=>"(max-width: 640px) 300px, (max-width: 1024px) 600px, 1200px",k=()=>{C(!0)},_=()=>{F(!0)};if(N&&!m)return e.jsx("div",{ref:q,className:`bg-gray-200 animate-pulse ${$}`,style:{minHeight:"200px",...O},...H});if(U)return s?e.jsx("img",{src:s,alt:f,className:$,style:O,...H}):e.jsx("div",{className:`bg-gray-200 flex items-center justify-center ${$}`,style:{minHeight:"200px",...O},...H,children:e.jsx("span",{className:"text-gray-400 text-sm",children:"Image not available"})});const E=x(),D=E?w():void 0;return e.jsxs("picture",{ref:q,className:$,style:O,children:[a&&E&&e.jsx("source",{srcSet:E,sizes:D,type:"image/webp"}),a&&!E&&e.jsx("source",{srcSet:a,type:"image/webp"}),e.jsx("img",{src:P,alt:f,className:`${$} ${g?"opacity-100 transition-opacity duration-300":"opacity-0"}`,onLoad:k,onError:_,loading:N?"lazy":"eager",decoding:"async",...H})]})},Vs=({recommendation:P,position:a,onAddToCart:f,onViewProduct:$,showReason:u=!0,showScore:N=!1,className:s=""})=>{var d,b,L,Q,T,G,K,M;const[O,H]=c.useState(!1),[g,C]=c.useState(!1),{isMobile:U}=at(),[F]=Ys(),{product:m,score:j,reason:q}=P,x=async()=>{if(!g){C(!0);try{P._id&&await F({recommendationId:P._id,productId:m._id,action:"add_to_cart",position:a}).unwrap(),f&&await f(m)}catch(S){re(S,"Add to Cart")}finally{C(!1)}}},w=async()=>{try{P._id&&await F({recommendationId:P._id,productId:m._id,action:"click",position:a}).unwrap(),$&&$(m)}catch(S){re(S,"View Product")}},k=()=>{switch(q){case"trending":return e.jsx(rt,{className:"h-4 w-4 text-orange-500"});case"frequently_bought_together":return e.jsx(Pe,{className:"h-4 w-4 text-blue-500"});case"similar_products":return e.jsx(Pe,{className:"h-4 w-4 text-purple-500"});case"seasonal":return e.jsx(_s,{className:"h-4 w-4 text-yellow-500"});case"collaborative_filtering":return e.jsx(ks,{className:"h-4 w-4 text-red-500"});case"content_similarity":return e.jsx(Pe,{className:"h-4 w-4 text-green-500"});case"price_range":return e.jsx(Pe,{className:"h-4 w-4 text-indigo-500"});default:return e.jsx(Pe,{className:"h-4 w-4 text-gray-500"})}},_=()=>{switch(q){case"trending":return"Trending Now";case"frequently_bought_together":return"Frequently Bought Together";case"similar_products":return"Similar Products";case"seasonal":return"Seasonal Pick";case"collaborative_filtering":return"Customers Also Bought";case"content_similarity":return"You Might Like";case"price_range":return"In Your Price Range";default:return"Recommended"}},E=((d=m.inventory)==null?void 0:d.currentStock)<=((b=m.inventory)==null?void 0:b.reorderPoint),D=((L=m.inventory)==null?void 0:L.currentStock)===0;return e.jsxs("div",{className:`bg-white border border-gray-200 rounded-lg shadow-sm hover:shadow-md transition-all duration-200 ${s}`,onMouseEnter:()=>H(!0),onMouseLeave:()=>H(!1),children:[e.jsxs("div",{className:"relative aspect-square bg-gray-100 rounded-t-lg overflow-hidden",children:[m.image?e.jsx(Gs,{src:m.image,webpSrc:m.imageWebp||((Q=m.image)==null?void 0:Q.replace(/\.(jpg|jpeg|png)$/i,".webp")),alt:m.name,className:"w-full h-full object-cover",sizes:{thumbnail:!0,small:!0,medium:!0,large:!0},lazy:!0}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(Pe,{className:"h-12 w-12 text-gray-400"})}),(E||D)&&e.jsx("div",{className:"absolute top-2 right-2",children:D?e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[e.jsx(vt,{className:"h-3 w-3 mr-1"}),"Out of Stock"]}):e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[e.jsx(vt,{className:"h-3 w-3 mr-1"}),"Low Stock"]})}),u&&e.jsx("div",{className:"absolute top-2 left-2",children:e.jsxs("div",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-white bg-opacity-90 text-gray-700",children:[k(),e.jsx("span",{className:"ml-1 hidden sm:inline",children:_()})]})}),N&&e.jsx("div",{className:"absolute bottom-2 right-2",children:e.jsxs("div",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[Math.round(j*100),"%"]})})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("h3",{className:"font-medium text-gray-900 text-sm line-clamp-2 mb-1",children:m.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Category: ",m.category||"N/A"]})]}),e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-lg font-bold text-gray-900",children:["$",((G=(T=m.pricing)==null?void 0:T.retail)==null?void 0:G.toFixed(2))||"0.00"]}),((K=m.pricing)==null?void 0:K.wholesale)&&m.pricing.wholesale!==m.pricing.retail&&e.jsxs("span",{className:"text-sm text-gray-500 line-through",children:["$",m.pricing.wholesale.toFixed(2)]})]})}),e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-gray-500",children:"Stock:"}),e.jsx("span",{className:`font-medium ${D?"text-red-600":E?"text-yellow-600":"text-green-600"}`,children:((M=m.inventory)==null?void 0:M.currentStock)||0})]})}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:w,className:"flex-1 btn btn-secondary btn-sm flex items-center justify-center",children:[e.jsx(ct,{className:"h-4 w-4 mr-1"}),U?"View":"View Details"]}),e.jsx("button",{onClick:x,disabled:D||g,className:"flex-1 btn btn-primary btn-sm flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed",children:g?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"h-4 w-4 mr-1"}),U?"Add":"Add to Cart"]})})]}),e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx("button",{onClick:async()=>{try{P._id&&await F({recommendationId:P._id,productId:m._id,action:"dismiss",position:a}).unwrap()}catch(S){re(S,"Dismiss Recommendation")}},className:"text-xs text-gray-400 hover:text-gray-600 transition-colors",children:"Not interested"})})]})]})},Ws=({title:P="Recommended for You",algorithm:a="hybrid",context:f={},limit:$=8,showTitle:u=!0,showControls:N=!0,onAddToCart:s,onViewProduct:O,className:H=""})=>{var T,G,K;const[g]=c.useState(()=>`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`),[C,U]=c.useState(a),[F,m]=c.useState(!1),[j,q]=c.useState(null),[x,w]=c.useState(null);at();const[k,{isLoading:_}]=Us(),E=c.useRef(!1);c.useEffect(()=>{if(E.current)return;(async()=>{if(!E.current){E.current=!0;try{w(null);const S=await k({sessionId:g,algorithm:C,context:f,limit:$}).unwrap();q(S)}catch(S){w(S),re(S,"Recommendations")}finally{setTimeout(()=>{E.current=!1},100)}}})()},[C,g,$]);const D=async()=>{if(!(E.current||F)){m(!0),E.current=!0;try{w(null);const M=await k({sessionId:g,algorithm:C,context:f,limit:$}).unwrap();q(M),se("Recommendations updated")}catch(M){w(M),re(M,"Refresh Recommendations")}finally{m(!1),setTimeout(()=>{E.current=!1},100)}}},d=M=>{U(M)},b=async M=>{try{s&&await s(M),se(`${M.name} added to cart`)}catch(S){re(S,"Add to Cart")}},L=M=>{O&&O(M)},Q=[{value:"hybrid",label:"Smart Recommendations",icon:We},{value:"trending",label:"Trending Now",icon:rt},{value:"frequently_bought",label:"Frequently Bought",icon:nt},{value:"similar_products",label:"Similar Products",icon:ct},{value:"collaborative",label:"Others Also Bought",icon:rt},{value:"seasonal",label:"Seasonal Picks",icon:We}];return x?e.jsxs("div",{className:`text-center py-8 ${H}`,children:[e.jsx("div",{className:"text-red-500 mb-4",children:e.jsx(st,{className:"h-8 w-8 mx-auto"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Unable to load recommendations"}),e.jsx("p",{className:"text-gray-500 mb-4",children:x.message}),e.jsx("button",{onClick:D,className:"btn btn-primary",children:"Try Again"})]}):e.jsxs(cs,{className:H,children:[u&&e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-primary-100 rounded-lg",children:e.jsx(We,{className:"h-6 w-6 text-primary-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:P}),e.jsx("p",{className:"text-sm text-gray-500",children:(T=Q.find(M=>M.value===C))==null?void 0:T.label})]})]}),N&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("select",{value:C,onChange:M=>d(M.target.value),className:"select select-sm",children:Q.map(M=>e.jsx("option",{value:M.value,children:M.label},M.value))}),e.jsx(pe,{onClick:D,isLoading:F,className:"btn btn-secondary btn-sm",children:e.jsx(st,{className:"h-4 w-4"})})]})]}),_&&e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:Array.from({length:$}).map((M,S)=>e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"aspect-square bg-gray-200 rounded-lg mb-4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-2/3 mb-2"}),e.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/2 mb-4"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded flex-1"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded flex-1"})]})]})},S))}),(j==null?void 0:j.recommendations)&&e.jsx(is,{cols:{default:2,md:3,lg:4},gap:4,className:"mb-6",children:j.recommendations.map((M,S)=>e.jsx(Vs,{recommendation:{...M,_id:j.recommendationId},position:S+1,onAddToCart:b,onViewProduct:L,showReason:!0,showScore:!1},`${M.product._id}-${S}`))}),((G=j==null?void 0:j.recommendations)==null?void 0:G.length)===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-gray-400 mb-4",children:e.jsx(We,{className:"h-12 w-12 mx-auto"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No recommendations available"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"We need more data to provide personalized recommendations."}),e.jsxs("button",{onClick:D,className:"btn btn-primary",children:[e.jsx(st,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),(j==null?void 0:j.metadata)&&e.jsx("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("span",{children:["Generated in ",j.metadata.processingTime,"ms"]}),e.jsxs("span",{children:[((K=j.recommendations)==null?void 0:K.length)||0," recommendations"]})]})})]})},Qs=()=>`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,zs=()=>{let P=sessionStorage.getItem("recommendation_session_id");return P||(P=Qs(),sessionStorage.setItem("recommendation_session_id",P)),P},Ks=()=>{const P=c.useRef(zs()),a=c.useRef([]),f=c.useRef(!1),[$]=Hs(),u=async x=>{const w={sessionId:P.current,...x,timestamp:new Date().toISOString()};a.current.push(w),f.current||N()},N=async()=>{if(!(f.current||a.current.length===0)){for(f.current=!0;a.current.length>0;){const x=a.current.shift();try{await $(x).unwrap()}catch{(x.action==="purchase"||x.action==="add_to_cart")&&a.current.unshift(x)}}f.current=!1}},s=(x,w=null)=>{u({action:"page_view",entity:{type:"page",name:x},context:{page:x,referrer:w,userAgent:navigator.userAgent,timestamp:Date.now()}})},O=(x,w=null)=>{var k;u({action:"product_view",entity:{type:"product",id:x._id,ref:"Product",name:x.name,category:x.category},metadata:{productPrice:(k=x.pricing)==null?void 0:k.retail,position:w}})},H=(x,w=null)=>{var k;u({action:"product_click",entity:{type:"product",id:x._id,ref:"Product",name:x.name,category:x.category},metadata:{productPrice:(k=x.pricing)==null?void 0:k.retail,position:w}})},g=(x,w=1,k=null)=>{var _,E;u({action:"add_to_cart",entity:{type:"product",id:x._id,ref:"Product",name:x.name,category:x.category},metadata:{productPrice:(_=x.pricing)==null?void 0:_.retail,quantity:w,position:k,cartValue:((E=x.pricing)==null?void 0:E.retail)*w}})},C=(x,w=1,k=null)=>{var _;u({action:"remove_from_cart",entity:{type:"product",id:x._id,ref:"Product",name:x.name,category:x.category},metadata:{productPrice:(_=x.pricing)==null?void 0:_.retail,quantity:w,position:k}})},U=(x,w,k=null)=>{x.forEach((_,E)=>{var D,d,b,L,Q;u({action:"purchase",entity:{type:"product",id:_._id||((D=_.product)==null?void 0:D._id),ref:"Product",name:_.name||((d=_.product)==null?void 0:d.name),category:_.category||((b=_.product)==null?void 0:b.category)},metadata:{productPrice:_.price||((Q=(L=_.product)==null?void 0:L.pricing)==null?void 0:Q.retail),quantity:_.quantity,position:E+1,totalAmount:w,orderId:k}})})},F=(x,w=0,k={})=>{u({action:"search",entity:{type:"search",name:x},metadata:{searchQuery:x,resultsCount:w,filterCriteria:k}})},m=(x,w=null)=>{u({action:"category_view",entity:{type:"category",id:x._id,ref:"Category",name:x.name},metadata:{position:w}})},j=(x,w,k=0)=>{u({action:"filter",entity:{type:"filter",name:x},metadata:{filterType:x,filterValue:w,resultsCount:k}})},q=(x,w,k,_=null)=>{u({action:`recommendation_${k}`,entity:{type:"product",id:w,ref:"Product"},metadata:{recommendationId:x,position:_,interactionType:k}})};return c.useEffect(()=>()=>{a.current.length>0&&N()},[]),{sessionId:P.current,trackBehavior:u,trackPageView:s,trackProductView:O,trackProductClick:H,trackAddToCart:g,trackRemoveFromCart:C,trackPurchase:U,trackSearch:F,trackCategoryView:m,trackFilter:j,trackRecommendationInteraction:q}},Js=({onAddProduct:P,selectedCustomer:a,showCostPrice:f,onLastPurchasePriceFetched:$,hasCostPricePermission:u,priceType:N,onRefetchReady:s})=>{const[O,H]=c.useState(""),[g,C]=c.useState(null),[U,F]=c.useState(1),[m,j]=c.useState(""),[q,x]=c.useState(0),[w,k]=c.useState(!1),[_,E]=c.useState(!1),[D,d]=c.useState(0),[b,L]=c.useState(null),[Q,T]=c.useState(!1),G=c.useRef(null),[K]=At(),[M]=$t(),{data:S,isLoading:ce,error:je,refetch:he}=bs({limit:100,status:"active"},{keepPreviousData:!0,staleTime:0,refetchOnMountOrArgChange:!0});c.useEffect(()=>{s&&he&&typeof he=="function"&&s(he)},[s,he]);const ie=ys.useMemo(()=>{var p,V,Y;return S?Array.isArray(S)?S:(p=S==null?void 0:S.data)!=null&&p.products?S.data.products:S!=null&&S.products?S.products:(Y=(V=S==null?void 0:S.data)==null?void 0:V.data)!=null&&Y.products?S.data.data.products:[]:[]},[S]),ve=vs(ie,O,["name","description","brand"],{threshold:.4,minScore:.3,limit:10}),Se=(p,V)=>p?V==="wholesale"?p.pricing.wholesale||p.pricing.retail:V==="retail"?p.pricing.retail:p.pricing.wholesale||p.pricing.retail:0,Ne=async p=>{if(C(p),F(1),k(!0),H(p.name),p._id)try{const Y=await K(p._id).unwrap();Y&&Y.lastPurchasePrice!==null?(L(Y.lastPurchasePrice),$&&$(p._id,Y.lastPurchasePrice)):L(null)}catch{L(null)}else L(null);const V=Se(p,N);x(V),j(V.toString())};c.useEffect(()=>{if(g){const p=Se(g,N);x(p);const V=Se(g,N==="wholesale"?"retail":"wholesale");(!m||m===V.toString()||m===q.toString())&&j(p.toString())}},[N,g]);const Ie=async()=>{if(g){if(!m||parseInt(m)<=0){X.error("Please enter a valid rate");return}if(g.inventory.currentStock===0){X.error(`${g.name} is out of stock and cannot be added to the invoice.`);return}if(U>g.inventory.currentStock){X.error(`Cannot add ${U} units. Only ${g.inventory.currentStock} units available in stock.`);return}E(!0);try{const p=parseInt(m)||Math.round(q);if(b!==null&&p<b){const Y=b-p,Z=(Y/b*100).toFixed(1);if(!window.confirm(`⚠️ WARNING: Sale price (${p}) is below cost price (${Math.round(b)}).

Loss per unit: ${Math.round(Y)} (${Z}%)
Total loss for ${U} unit(s): ${Math.round(Y*U)}

Do you want to proceed?`))return;X.warning(`Product added with loss: ${Math.round(Y)} per unit (${Z}%)`,{duration:6e3})}P({product:g,quantity:U,unitPrice:p}),C(null),F(1),j(""),x(0),k(!1),H(""),d(Y=>Y+1),setTimeout(()=>{G.current&&G.current.focus()},100);const V=(a==null?void 0:a.businessType)==="wholesale"?"wholesale":(a==null?void 0:a.businessType)==="distributor"?"distributor":"retail";X.success(`${g.name} added to cart at ${V} price: ${Math.round(p)}`)}catch(p){re(p,"Product Price Check")}finally{E(!1)}}},Ce=p=>{p.key==="Enter"&&w?(p.preventDefault(),Ie()):p.key==="Escape"&&w&&(p.preventDefault(),C(null),F(1),j(""),x(0),k(!1))},Qe=p=>{var Z;p.inventory.currentStock<=p.inventory.reorderPoint,p.inventory.currentStock;let V=p.pricing.wholesale||p.pricing.retail;N==="wholesale"?V=p.pricing.wholesale||p.pricing.retail:N==="retail"&&(V=p.pricing.retail);const Y=((Z=p.pricing)==null?void 0:Z.cost)||0;return e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("div",{className:"font-medium",children:p.name}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Stock: ",p.inventory.currentStock]}),f&&u&&e.jsxs("div",{className:"text-sm text-red-600 font-medium",children:["Cost: ",Math.round(Y)]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Price: ",Math.round(V)]})]})]})},Be=f&&u?"col-span-6":"col-span-7";return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-12 gap-4 items-end",children:[e.jsxs("div",{className:Be,children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product Search"}),e.jsxs("div",{className:"relative flex space-x-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx(Tt,{ref:G,placeholder:"Search or select product...",items:ve||[],onSelect:Ne,onSearch:H,displayKey:Qe,selectedItem:g,loading:ce,emptyMessage:O.length>0?"No products found":"Start typing to search products...",value:O},D)}),e.jsx("button",{type:"button",onClick:()=>T(!0),className:"px-3 py-2 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors flex items-center justify-center",title:"Scan barcode to search product",children:e.jsx($s,{className:"h-5 w-5 text-gray-600"})})]})]}),e.jsxs("div",{className:"col-span-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Stock"}),e.jsx("span",{className:"text-sm font-semibold text-gray-700 bg-gray-100 px-2 py-1 rounded border border-gray-200 block text-center h-10 flex items-center justify-center",children:g?g.inventory.currentStock:"0"})]}),e.jsxs("div",{className:"col-span-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quantity"}),e.jsx("input",{type:"number",min:"1",max:g==null?void 0:g.inventory.currentStock,value:U,onChange:p=>F(parseInt(p.target.value)||1),onKeyDown:Ce,onFocus:p=>p.target.select(),className:"input text-center",placeholder:"1 (Enter to add & focus search)",autoFocus:w})]}),f&&u&&e.jsxs("div",{className:"col-span-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cost"}),e.jsx("span",{className:"text-sm font-semibold text-red-700 bg-red-50 px-2 py-1 rounded border border-red-200 block text-center h-10 flex items-center justify-center",title:"Last Purchase Price",children:b!==null?`${Math.round(b)}`:g?"N/A":"0"})]}),e.jsxs("div",{className:"col-span-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rate"}),e.jsx("input",{type:"number",step:"1",value:m,onChange:p=>j(p.target.value),onKeyDown:Ce,onFocus:p=>p.target.select(),className:"input text-center",placeholder:"0 (Enter to add & focus search)",required:!0})]}),e.jsxs("div",{className:"col-span-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Amount"}),e.jsx("span",{className:"text-sm font-semibold text-gray-700 bg-gray-100 px-2 py-1 rounded border border-gray-200 block text-center h-10 flex items-center justify-center",children:w?Math.round(U*parseInt(m||0)):0})]}),e.jsx("div",{className:"col-span-1 flex items-end",children:e.jsxs(pe,{type:"button",onClick:Ie,isLoading:_,className:"w-full btn btn-primary flex items-center justify-center px-3 py-2",disabled:!g||_,title:"Add to cart (or press Enter in Quantity/Rate fields - focus returns to search)",children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Add"]})})]})}),e.jsx(Ts,{isOpen:Q,onClose:()=>T(!1),onScan:p=>{const V=ie.find(Y=>Y.barcode===p||Y.sku===p);V?(Ne(V),X.success(`Product found: ${V.name}`)):(H(p),X(`Searching for: ${p}`,{icon:"ℹ️"})),T(!1)},scanMode:"both"})]})},Tr=({tabId:P,editData:a})=>{const[f,$]=c.useState(null),[u,N]=c.useState([]),[s,O]=c.useState(null),[H,g]=c.useState(""),[C,U]=c.useState("cash"),[F,m]=c.useState(""),[j,q]=c.useState(0),[x,w]=c.useState(!1),[k,_]=c.useState(!1),[E,D]=c.useState(null),[d,b]=c.useState([]),[L,Q]=c.useState(!0),[T,G]=c.useState({type:"amount",value:0}),[K,M]=c.useState(!1),[S,ce]=c.useState(""),[je,he]=c.useState(!0),[ie,ve]=c.useState(""),[Se,Ne]=c.useState(!1),[Ie,Ce]=c.useState(!1),[Qe,Be]=c.useState(!1),[p,V]=c.useState({}),[Y,Z]=c.useState({}),[ke,de]=c.useState(!1),[J,oe]=c.useState({}),[ue,Rt]=c.useState(!1),[ee,_e]=c.useState({}),[ze,it]=c.useState("wholesale"),[Et,Oe]=c.useState(!1),[te,Fe]=c.useState("pdf"),[Ke,ot]=c.useState(!1),me=(()=>{const t=new Date,r=new Date;r.setMonth(t.getMonth()-1);const i=l=>{const n=l.getFullYear(),o=String(l.getMonth()+1).padStart(2,"0"),h=String(l.getDate()).padStart(2,"0");return`${n}-${o}-${h}`};return{from:i(r),to:i(t)}})(),[Ae,qe]=c.useState(me.from),[De,Ue]=c.useState(me.to),{isMobile:$e}=at(),{trackProductView:Lt}=Ks(),{updateTabTitle:lt,getActiveTab:dt,openTab:It}=os(),{hasPermission:Te,user:Je}=ls(),[ut,Bt]=c.useState(!1),mt=c.useMemo(()=>!Array.isArray(u)||u.length===0?0:u.reduce((t,r)=>{var y,I,R;if(!(r!=null&&r.product))return t;const i=r.product._id,l=Number(r.quantity)||0,n=Number(r.unitPrice)||0,h=(i&&ee[i]!==void 0?Number(ee[i]):null)??Number((y=r.product.pricing)==null?void 0:y.cost)??Number((I=r.product.pricing)==null?void 0:I.purchasePrice)??Number((R=r.product.pricing)==null?void 0:R.wholesaleCost)??0,W=(n-(Number.isFinite(h)?h:0))*l;return t+(Number.isFinite(W)?W:0)},0),[u,ee]),Xe=t=>{if(!t)return"";const r=new Date,i=r.getFullYear(),l=String(r.getMonth()+1).padStart(2,"0"),n=String(r.getDate()).padStart(2,"0"),o=String(r.getTime()).slice(-4);return`INV-${t.displayName.split(" ").map(v=>v.charAt(0).toUpperCase()).join("").substring(0,3)}-${i}${l}${n}-${o}`};c.useEffect(()=>{if(a&&a.isEditMode&&a.orderId){if(a.customer&&O(a.customer),a.orderNumber&&(ce(a.orderNumber),he(!1)),a.notes&&ve(a.notes),a.items&&a.items.length>0){const t=a.items.map(r=>{var i,l,n,o;return{product:r.product,quantity:r.quantity,unitPrice:r.unitPrice||r.price||((l=(i=r.product)==null?void 0:i.pricing)==null?void 0:l.retail)||0,totalPrice:r.totalPrice||r.quantity*(r.unitPrice||r.price||((o=(n=r.product)==null?void 0:n.pricing)==null?void 0:o.retail)||0)}});N(t)}a.isTaxExempt!==void 0&&Q(a.isTaxExempt),a.payment&&(U(a.payment.method||"cash"),q(a.payment.amount||0),a.payment.method==="bank"?m(a.payment.bankAccount||""):m("")),a.orderType}},[a==null?void 0:a.orderId]);const{data:fe,isLoading:xt}=js({isActive:!0},{staleTime:5*6e4}),{data:ne,isLoading:Ot,refetch:Zs}=ds({limit:1e3},{staleTime:0,refetchOnMountOrArgChange:!0}),[Ft]=At(),[qt]=$t(),[pt,{isLoading:Ye}]=us(),[ht,{isLoading:He}]=ms(),ge=c.useRef(!1),[Ge,Ze]=c.useState(!1),le=c.useCallback(()=>{ge.current=!1,Ze(!1)},[]),Me=c.useMemo(()=>{var t;return((t=ne==null?void 0:ne.data)==null?void 0:t.customers)||(ne==null?void 0:ne.customers)||(ne==null?void 0:ne.data)||ne||[]},[ne]),Re=c.useMemo(()=>{var r;return(((r=fe==null?void 0:fe.data)==null?void 0:r.banks)||(fe==null?void 0:fe.banks)||[]).filter(i=>i.isActive!==!1)},[fe]);c.useEffect(()=>{if(C==="bank"&&!F){const t=Re.find(r=>r==null?void 0:r.isDefault)||Re[0];t!=null&&t._id&&m(t._id)}},[C,F,Re]),c.useEffect(()=>{if(s&&Me&&Me.length>0){const t=Me.find(r=>r._id===s._id);t&&(t.pendingBalance!==s.pendingBalance||t.advanceBalance!==s.advanceBalance||t.currentBalance!==s.currentBalance)&&O(t)}},[Me]);const ye=u.reduce((t,r)=>t+r.unitPrice*r.quantity,0),Dt=d.reduce((t,r)=>t+r.amount,0);let Ve=0;T.value>0&&(T.type==="percentage"?Ve=ye*T.value/100:Ve=Math.min(T.value,ye));const we=Dt+Ve,ft=ye-we,Ee=L?0:ft*.08,ae=ft+Ee,et=t=>t?t==="retail"||t==="wholesale"?t:t==="distributor"?"wholesale":"retail":"retail",Ut=async t=>{O(t),Z({}),de(!1),oe({}),je&&t&&ce(Xe(t));const r=dt();r&&t&&lt(r.id,`Sales - ${t.displayName}`)};c.useEffect(()=>{},[ze]),c.useEffect(()=>{(async()=>{if(u.length===0)return;const r=u.map(i=>i.product._id);if(r.length!==0)try{const i=await qt({productIds:r}).unwrap();if(i&&i.prices){const l={};Object.keys(i.prices).forEach(n=>{l[n]=i.prices[n].lastPurchasePrice}),_e(n=>({...n,...l}))}}catch{}})()},[u]);const gt=async t=>{N(r=>{var l;const i=r.find(n=>n.product._id===t.product._id);if(i){const n=i.quantity+t.quantity,o=((l=t.product.inventory)==null?void 0:l.currentStock)||0;return n>o?(X.error(`Cannot add ${t.quantity} more units. Only ${o-i.quantity} additional units available (${i.quantity} already in cart).`),r):r.map(v=>v.product._id===t.product._id?{...v,quantity:v.quantity+t.quantity,unitPrice:t.unitPrice}:v)}return t.product._id&&Ft(t.product._id).unwrap().then(n=>{n&&n.lastPurchasePrice!==null&&_e(o=>({...o,[t.product._id]:n.lastPurchasePrice}))}).catch(()=>{}),[...r,t]})},Yt=async(t,r)=>{if(r<=0){yt(t);return}N(i=>{var o;const l=i.find(h=>h.product._id===t);if(!l)return i;const n=((o=l.product.inventory)==null?void 0:o.currentStock)||0;return r>n?(X.error(`Cannot set quantity to ${r}. Only ${n} units available in stock.`),i):i.map(h=>h.product._id===t?{...h,quantity:r}:h)})},Ht=(t,r)=>{if(r<0)return;if(u.find(l=>l.product._id===t)){const l=ee[t];if(l!==void 0&&r<l){const n=l-r,o=(n/l*100).toFixed(1);X.error(`Warning: Sale price (${r}) is below cost price (${Math.round(l)}). Loss: ${Math.round(n)} (${o}%)`,{duration:5e3,position:"top-center",icon:"⚠️"})}}N(l=>l.map(n=>n.product._id===t?{...n,unitPrice:r}:n))},yt=t=>{N(r=>{const i=r.filter(l=>l.product._id!==t);return i.length===0?(Z({}),de(!1),oe({})):(Z(l=>{const n={...l};return delete n[t.toString()],Object.keys(n).length===0&&(de(!1),oe({})),n}),oe(l=>{const n={...l};return delete n[t.toString()],n})),i})},Gt=()=>{N(t=>{if(!t||t.length<2)return t;const r=l=>{const n=l.product;return n?typeof n=="string"?n:n.name||n.title||n.displayName||n.businessName||n.fullName||"":""};return[...t].sort((l,n)=>{const o=r(l).toString().toLowerCase(),h=r(n).toString().toLowerCase();return o<h?-1:o>h?1:0})})},Vt=async()=>{if(!s){B("Please select a customer first");return}if(u.length===0){B("Please add products to cart first");return}Ne(!0);try{const t=await salesAPI.getLastPrices(s._id),{prices:r,orderNumber:i,orderDate:l}=t.data;if(!r||Object.keys(r).length===0){B("No previous order found for this customer"),Ne(!1);return}const n={},o={};u.forEach(R=>{const A=R.product._id.toString();n[A]=R.unitPrice}),Z(n);let h=0,v=0,W=0;const y=u.map(R=>{const A=R.product._id.toString();if(r[A]){const z=r[A].unitPrice,be=R.unitPrice;return z!==be?(h++,o[A]="updated",{...R,unitPrice:z}):(v++,o[A]="unchanged",R)}else return W++,o[A]="not-found",R});N(y),oe(o),de(!0);const I=l?new Date(l).toLocaleDateString():"previous order";if(h>0){let R=`Applied prices from ${i||"previous order"} (${I}). Updated ${h} product(s).`;v>0&&(R+=` ${v} product(s) had same price.`),W>0&&(R+=` ${W} product(s) not found in previous order.`),se(R)}else v>0?se(`All products already have the same prices as in ${i||"previous order"} (${I}).`):B("No matching products found in previous order")}catch(t){re(t,"Apply Last Prices")}finally{Ne(!1)}},Wt=()=>{if(Object.keys(Y).length===0){B("No original prices to restore");return}Ce(!0);try{let t=0;const r=u.map(i=>{const l=i.product._id.toString();return Y[l]!==void 0?(t++,{...i,unitPrice:Y[l]}):i});N(r),de(!1),Z({}),oe({}),t>0?se(`Restored original prices for ${t} product(s).`):B("No matching products found to restore")}finally{Ce(!1)}},{confirmation:Qt,confirmClear:zt,handleConfirm:Kt,handleCancel:Jt}=Ps(),Xt=()=>{u.length>0&&(Be(!0),zt(u.length,"items",async()=>{try{N([]),O(null),g(""),b([]),Q(!0),G({type:"amount",value:0}),M(!1),ce(""),U("cash"),m(""),q(0),Z({}),de(!1),oe({}),it("wholesale");const t=dt();t&&lt(t.id,"Sales"),X.success("Cart cleared")}finally{Be(!1)}}))},Zt=()=>{Oe(!0)},es=async()=>{var t,r,i,l;ot(!0);try{const n={...(s==null?void 0:s._id)&&{customer:s._id},...Ae&&{dateFrom:Ae},...De&&{dateTo:De}};let o;if(te==="excel"?o=await salesAPI.exportExcel(n):te==="csv"?o=await salesAPI.exportCSV(n):te==="json"?o=await salesAPI.exportJSON(n):te==="pdf"&&(o=await salesAPI.exportPDF(n)),(t=o==null?void 0:o.data)!=null&&t.filename){const h=o.data.filename;try{te==="pdf"&&await new Promise(y=>setTimeout(y,500));let v;try{v=await salesAPI.downloadFile(h)}catch(y){if(y.response){const I=y.response.data;if(I instanceof Blob){const R=new FileReader;R.onload=()=>{const A=R.result;try{const z=JSON.parse(A);B(z.message||`Download failed: ${y.response.status}`)}catch{B(`Download failed: ${y.response.status}`)}},R.readAsText(I)}else typeof I=="object"&&I!==null?B(I.message||`Download failed: ${y.response.status}`):B(`Download failed: ${y.response.status}`)}else B("Download failed: "+(y.message||"Network error"));return}if(!v){B("Download failed: No response received");return}if(v.status!==200){B(`Download failed with status ${v.status}`);return}if(!v.data){B("Download failed: No data received from server");return}const W=((r=v.headers)==null?void 0:r["content-type"])||((i=v.headers)==null?void 0:i["Content-Type"])||"";if(te==="pdf"){const y=v.data;if(!y||!(y instanceof Blob)){if(typeof y=="string")B(`Server error: ${y.substring(0,100)}`);else if(y&&typeof y=="object"){let A=y.message||y.error;if(!A)try{const z=JSON.stringify(y);z==="{}"||z==="null"||z===""?A=y.statusText||y.status||"Unknown server error":A=z.substring(0,150)}catch{A="Invalid response format"}B(`Server error: ${A||"Unknown error"}`)}else B("Invalid PDF file received - expected Blob. Response type: "+typeof y);return}if(W.includes("application/json")||W.includes("text/html")){const A=new FileReader;A.onload=()=>{const z=A.result;try{const be=JSON.parse(z);B(be.message||"File not found or generation failed")}catch{B("Server returned error instead of PDF. Please try again.")}},A.readAsText(y);return}if(y.size===0){B("PDF file is empty");return}if(y.type&&!y.type.includes("pdf")&&!y.type.includes("application/octet-stream")){const A=new FileReader;A.onload=()=>{const z=A.result;if(z.includes("<!DOCTYPE")||z.includes('{"error"')||z.includes('{"message"'))B("Server returned an error instead of PDF file");else{const be=URL.createObjectURL(y);if(window.open(be,"_blank"))se("PDF opened in new tab");else{const Le=document.createElement("a");Le.href=be,Le.download=h,document.body.appendChild(Le),Le.click(),document.body.removeChild(Le),se("PDF downloaded (popup was blocked)")}setTimeout(()=>URL.revokeObjectURL(be),1e4)}},A.readAsText(y.slice(0,100));return}const I=URL.createObjectURL(y);if(window.open(I,"_blank"))se("PDF opened in new tab");else{const A=document.createElement("a");A.href=I,A.download=h,document.body.appendChild(A),A.click(),document.body.removeChild(A),se("PDF downloaded (popup was blocked)")}setTimeout(()=>URL.revokeObjectURL(I),1e4)}else{const y=new Blob([v.data],{type:te==="excel"?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":te==="csv"?"text/csv":"application/json"}),I=URL.createObjectURL(y),R=document.createElement("a");R.href=I,R.download=h,document.body.appendChild(R),R.click(),document.body.removeChild(R),URL.revokeObjectURL(I),se(`${te.toUpperCase()} file downloaded successfully`)}}catch(v){if(v.response)if(v.response.data instanceof Blob){const W=new FileReader;W.onload=()=>{const y=W.result;try{const I=JSON.parse(y);B(I.message||"Download failed")}catch{B("Download failed: "+y.substring(0,100))}},W.readAsText(v.response.data)}else B(((l=v.response.data)==null?void 0:l.message)||`Download failed: ${v.response.status}`);else B("Download failed: "+(v.message||"Unknown error"));return}}Oe(!1)}catch(n){re(n,"Export")}finally{ot(!1)}},bt=c.useCallback(async t=>{var r,i,l,n;if(!ge.current){ge.current=!0,Ze(!0);try{const o=await pt({payload:t}).unwrap();se("Sale created successfully"),N([]),q(0),b([]),G({type:"amount",value:0}),ve(""),ce(""),_e({}),Z({}),de(!1),oe({}),o!=null&&o.order&&(D(o.order),_(!0)),le()}catch(o){if((o==null?void 0:o.status)===409||((i=(r=o==null?void 0:o.data)==null?void 0:r.error)==null?void 0:i.code)==="DUPLICATE_REQUEST"){const h=((n=(l=o==null?void 0:o.data)==null?void 0:l.error)==null?void 0:n.retryAfter)||1;X(`Your request is being processed. Please wait ${h} second${h>1?"s":""}...`,{duration:3e3,icon:"ℹ️"}),setTimeout(()=>{le()},(h+2)*1e3)}else re(o,"Create Sale"),le()}}},[pt,le]),jt=c.useCallback(async(t,r)=>{var i,l,n,o;if(!ge.current){ge.current=!0,Ze(!0);try{const h=await ht({id:t,...r}).unwrap();se("Order updated successfully"),N([]),q(0),b([]),G({type:"amount",value:0}),ve(""),ce(""),_e({}),Z({}),de(!1),oe({}),h!=null&&h.order&&(D(h.order),_(!0)),le()}catch(h){if((h==null?void 0:h.status)===409||((l=(i=h==null?void 0:h.data)==null?void 0:i.error)==null?void 0:l.code)==="DUPLICATE_REQUEST"){const v=((o=(n=h==null?void 0:h.data)==null?void 0:n.error)==null?void 0:o.retryAfter)||1;X(`Your request is being processed. Please wait ${v} second${v>1?"s":""}...`,{duration:3e3,icon:"ℹ️"}),setTimeout(()=>{le()},(v+2)*1e3)}else re(h,"Update Order"),le()}}},[ht,le,ge]),ts=c.useCallback(t=>{if(t&&(t.preventDefault(),t.stopPropagation()),ge.current||Ge||Ye||He)return;if(u.length===0){B({message:"Cart is empty"});return}if(s&&s.creditLimit>0){const i=C||"cash",n=ae-(j||0);if(i==="account"||n>0){const o=s.currentBalance||0,h=s.pendingBalance||0,v=o+h,W=v+n,y=s.creditLimit-v;if(W>s.creditLimit){const I=`Credit limit exceeded for ${s.displayName||s.name}. Current balance: $${v.toFixed(2)}, Unpaid amount: $${n.toFixed(2)}, Credit limit: $${s.creditLimit.toFixed(2)}, Available credit: $${y.toFixed(2)}. Please collect payment or reduce the order amount.`;X.error(I,{duration:8e3,position:"top-center"});return}else if(y-n<s.creditLimit*.1){const I=`Warning: ${s.displayName||s.name} is near credit limit. Available credit: $${y.toFixed(2)}, After this order: $${(y-n).toFixed(2)} remaining.`;X.warning(I,{duration:6e3,position:"top-center"})}}}if(C==="bank"&&!F){B({message:"Please select a bank account for bank payments"});return}const r={orderType:et(s==null?void 0:s.businessType),customer:s==null?void 0:s._id,items:u.map(i=>({product:i.product._id,quantity:i.quantity,unitPrice:i.unitPrice})),appliedDiscounts:d,directDiscount:T,subtotal:ye,discountAmount:we,tax:Ee,isTaxExempt:L,total:ae,invoiceNumber:S,notes:(ie==null?void 0:ie.trim())||"",payment:{method:C,bankAccount:C==="bank"?F:null,amount:j,remainingBalance:ae-j,isPartialPayment:j<ae,isAdvancePayment:K,advanceAmount:K?j-ae:0}};if(a!=null&&a.isEditMode){const i=a.orderId,l={orderType:et(s==null?void 0:s.businessType),customer:s==null?void 0:s._id,items:u.map(n=>{const o=n.quantity*n.unitPrice,h=0,v=0,W=o-h+v;return{product:n.product._id,quantity:n.quantity,unitPrice:n.unitPrice,discountPercent:0,taxRate:0,subtotal:o,discountAmount:h,taxAmount:v,total:W}}),notes:ie||""};jt(i,l)}else bt(r)},[Ge,Ye,He,u,s,C,j,ae,d,T,ye,we,Ee,L,S,ie,F,K,a,le,bt,jt]),ss=async t=>{},rs=t=>{re(t,"Payment processing"),w(!1),D(null)};return e.jsxs(Ns,{children:[e.jsxs("div",{className:"space-y-4 lg:space-y-6",children:[e.jsxs("div",{className:`flex ${$e?"flex-col space-y-4":"items-start justify-between"}`,children:[e.jsxs("div",{children:[e.jsx("h1",{className:`${$e?"text-xl":"text-2xl"} font-bold text-gray-900`,children:"Point of Sale"}),e.jsx("p",{className:"text-gray-600",children:"Process sales transactions"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:Zt,className:"btn btn-secondary btn-md",title:"Export Sales Report",children:[e.jsx(Nt,{className:"h-4 w-4 mr-2"}),"Export Sales Report"]}),e.jsxs("button",{onClick:()=>{const t=As("/sales");if(t){const r=`tab_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;It({title:"Sales",path:"/sales",component:t.component,icon:t.icon,allowMultiple:!0,props:{tabId:r}})}},className:"btn btn-primary btn-md",children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"New Sales"]})]})]}),e.jsxs("div",{className:`flex ${$e?"flex-col space-y-4":"items-start space-x-4"}`,children:[e.jsxs("div",{className:`${$e?"w-full":"w-[500px] flex-shrink-0"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Select Customer"}),s&&e.jsx("button",{onClick:()=>{O(null),g("")},className:"text-xs text-blue-600 hover:text-blue-800 underline",title:"Change customer",children:"Change Customer"})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("label",{className:"text-xs font-normal text-gray-400",children:"Price Type:"}),e.jsxs("select",{value:ze,onChange:t=>it(t.target.value),className:"border border-gray-200 rounded-md px-2 py-1 text-xs text-gray-600 focus:outline-none focus:ring-1 focus:ring-primary-400 focus:border-primary-400",children:[e.jsx("option",{value:"wholesale",children:"Wholesale"}),e.jsx("option",{value:"retail",children:"Retail"}),e.jsx("option",{value:"custom",children:"Custom"})]})]})})]}),e.jsx(Tt,{placeholder:"Search customers by name, email, or business...",items:Me||[],onSelect:Ut,onSearch:g,selectedItem:s,displayKey:t=>{const r=t.pendingBalance||0,i=t.advanceBalance||0,l=r-i,n=l<0,o=r>0||i>0;return e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.displayName}),o?e.jsxs("div",{className:`text-sm ${n?"text-red-600":"text-green-600"}`,children:[n?"Advance:":"Receivables:"," ",Math.abs(l).toFixed(2)]}):null]})},loading:Ot,emptyMessage:"No customers found"})]}),e.jsx("div",{className:`${$e?"w-full":"flex-1"}`,children:s?e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(xs,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:s.displayName}),e.jsxs("p",{className:"text-sm text-gray-600 capitalize",children:[s.businessType," • ",s.phone||"No phone"]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[(()=>{const t=s.pendingBalance||0,r=s.advanceBalance||0,i=t-r,l=i<0,n=i>0;return t>0||r>0?e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:l?"Advance:":"Receivables:"}),e.jsx("span",{className:`text-sm font-medium ${l?"text-red-600":n?"text-green-600":"text-gray-600"}`,children:Math.abs(i).toFixed(2)})]}):null})(),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Credit Limit:"}),e.jsx("span",{className:`text-sm font-medium ${s.creditLimit>0?(s.currentBalance||0)+(s.pendingBalance||0)>=s.creditLimit*.9?"text-red-600":(s.currentBalance||0)+(s.pendingBalance||0)>=s.creditLimit*.7?"text-yellow-600":"text-blue-600":"text-gray-600"}`,children:(s.creditLimit||0).toFixed(2)}),s.creditLimit>0&&(s.currentBalance||0)+(s.pendingBalance||0)>=s.creditLimit*.9&&e.jsx("span",{className:"text-xs text-red-600 font-bold ml-1",children:"⚠️"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Available Credit:"}),e.jsx("span",{className:`text-sm font-medium ${s.creditLimit>0?s.creditLimit-((s.currentBalance||0)+(s.pendingBalance||0))<=s.creditLimit*.1?"text-red-600":s.creditLimit-((s.currentBalance||0)+(s.pendingBalance||0))<=s.creditLimit*.3?"text-yellow-600":"text-green-600":"text-gray-600"}`,children:(s.creditLimit-((s.currentBalance||0)+(s.pendingBalance||0))).toFixed(2)})]})]})]})]})}):e.jsx("div",{className:"hidden lg:block"})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-3",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Product Selection & Cart"}),e.jsxs("div",{className:"flex flex-wrap items-center justify-start lg:justify-end gap-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>Rt(!ue),className:"btn btn-secondary btn-sm flex items-center space-x-2",title:ue?"Hide purchase cost prices":"Show purchase cost prices",children:ue?e.jsxs(e.Fragment,{children:[e.jsx(Ms,{className:"h-4 w-4"}),e.jsx("span",{children:"Hide Cost"})]}):e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"h-4 w-4"}),e.jsx("span",{children:"Show Cost"})]})}),(Je==null?void 0:Je.role)==="admin"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>Bt(t=>!t),className:"btn btn-secondary btn-sm flex items-center space-x-2",title:"Show estimated profit (BP)",children:[e.jsx(Rs,{className:"h-4 w-4"}),e.jsx("span",{children:ut?"Hide BP":"Show BP"})]}),ut&&e.jsx("span",{className:`text-sm font-semibold ${mt>=0?"text-green-600":"text-red-600"}`,children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(mt||0)})]})]}),s&&u.length>0&&e.jsx(e.Fragment,{children:ke?e.jsxs(pe,{onClick:Wt,isLoading:Ie,className:"btn btn-secondary btn-sm flex items-center space-x-2",title:"Restore original/current prices",children:[e.jsx(ps,{className:"h-4 w-4"}),e.jsx("span",{children:"Restore Current Prices"})]}):e.jsxs(pe,{onClick:Vt,isLoading:Se,className:"btn btn-secondary btn-sm",title:"Apply prices from last order for this customer",children:[e.jsx(Es,{className:"h-4 w-4 mr-2"}),"Apply Last Prices"]})})]})]})}),e.jsxs("div",{className:"card-content",children:[e.jsx("div",{className:"mb-6",children:e.jsx(Js,{onAddProduct:gt,selectedCustomer:s,showCostPrice:ue,hasCostPricePermission:Te("view_cost_prices"),priceType:ze,onRefetchReady:$,onLastPurchasePriceFetched:(t,r)=>{_e(i=>({...i,[t]:r}))}})}),u.length===0?e.jsxs("div",{className:"p-8 text-center text-gray-500 border-t border-gray-200",children:[e.jsx(nt,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("p",{className:"mt-2",children:"No items in cart"})]}):e.jsxs("div",{className:"space-y-4 border-t border-gray-200 pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-md font-medium text-gray-700",children:"Cart Items"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("button",{type:"button",onClick:Gt,className:"btn btn-secondary btn-sm flex items-center space-x-2",title:"Sort products alphabetically",children:[e.jsx(hs,{className:"h-4 w-4"}),e.jsx("span",{children:"Sort A-Z"})]}),ke&&Object.keys(J).length>0&&e.jsxs("div",{className:"flex items-center space-x-3 text-xs",children:[e.jsx("span",{className:"text-gray-600 font-medium",children:"Price Status:"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(wt,{className:"h-3 w-3 text-green-600"}),e.jsx("span",{className:"text-gray-600",children:"Updated"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Pt,{className:"h-3 w-3 text-blue-600"}),e.jsx("span",{className:"text-gray-600",children:"Same Price"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(xe,{className:"h-3 w-3 text-yellow-600"}),e.jsx("span",{className:"text-gray-600",children:"Not in Last Order"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-12 gap-4 items-center pb-2 border-b border-gray-300 mb-2",children:[e.jsx("div",{className:"col-span-1",children:e.jsx("span",{className:"text-xs font-semibold text-gray-600 uppercase",children:"#"})}),e.jsx("div",{className:`${ue&&Te("view_cost_prices")?"col-span-5":"col-span-6"}`,children:e.jsx("span",{className:"text-xs font-semibold text-gray-600 uppercase",children:"Product"})}),e.jsx("div",{className:"col-span-1",children:e.jsx("span",{className:"text-xs font-semibold text-gray-600 uppercase",children:"Stock"})}),e.jsx("div",{className:"col-span-1",children:e.jsx("span",{className:"text-xs font-semibold text-gray-600 uppercase",children:"Qty"})}),ue&&Te("view_cost_prices")&&e.jsx("div",{className:"col-span-1",children:e.jsx("span",{className:"text-xs font-semibold text-gray-600 uppercase",children:"Cost"})}),e.jsx("div",{className:"col-span-1",children:e.jsx("span",{className:"text-xs font-semibold text-gray-600 uppercase",children:"Rate"})}),e.jsx("div",{className:"col-span-1",children:e.jsx("span",{className:"text-xs font-semibold text-gray-600 uppercase",children:"Total"})}),e.jsx("div",{className:"col-span-1",children:e.jsx("span",{className:"text-xs font-semibold text-gray-600 uppercase",children:"Action"})})]}),u.map((t,r)=>{var n,o,h,v,W,y,I,R;const i=t.unitPrice*t.quantity,l=((n=t.product.inventory)==null?void 0:n.currentStock)<=((o=t.product.inventory)==null?void 0:o.reorderPoint);return e.jsx("div",{className:`py-1 ${r%2===0?"bg-white":"bg-gray-50"}`,children:e.jsxs("div",{className:"grid grid-cols-12 gap-4 items-center",children:[e.jsx("div",{className:"col-span-1",children:e.jsx("span",{className:"text-sm font-medium text-gray-700 bg-gray-50 px-0.5 py-1 rounded border border-gray-200 block text-center h-8 flex items-center justify-center",children:r+1})}),e.jsx("div",{className:`${ue&&Te("view_cost_prices")?"col-span-5":"col-span-6"} flex items-center h-8`,children:e.jsxs("span",{className:"font-medium text-sm truncate",children:[t.product.name,l&&e.jsx("span",{className:"text-yellow-600 text-xs ml-2",children:"⚠️ Low Stock"}),ee[t.product._id]!==void 0&&t.unitPrice<ee[t.product._id]&&e.jsx("span",{className:"text-xs ml-2 px-1.5 py-0.5 rounded bg-red-100 text-red-700 font-bold",title:`Sale price below cost! Loss: ${Math.round(ee[t.product._id]-t.unitPrice)} per unit`,children:"⚠️ Loss"}),ke&&J[t.product._id]&&e.jsx("span",{className:`text-xs ml-2 px-1.5 py-0.5 rounded ${J[t.product._id]==="updated"?"bg-green-100 text-green-700":J[t.product._id]==="unchanged"?"bg-blue-100 text-blue-700":"bg-yellow-100 text-yellow-700"}`,children:J[t.product._id]==="updated"?"Updated":J[t.product._id]==="unchanged"?"Same Price":"Not in Last Order"})]})}),e.jsx("div",{className:"col-span-1",children:e.jsx("span",{className:`text-sm font-semibold px-2 py-1 rounded border block text-center h-8 flex items-center justify-center ${(((h=t.product.inventory)==null?void 0:h.currentStock)||0)===0?"text-red-700 bg-red-50 border-red-200":(((v=t.product.inventory)==null?void 0:v.currentStock)||0)<=(((W=t.product.inventory)==null?void 0:W.reorderPoint)||0)?"text-yellow-700 bg-yellow-50 border-yellow-200":"text-gray-700 bg-gray-100 border-gray-200"}`,children:((y=t.product.inventory)==null?void 0:y.currentStock)||0})}),e.jsx("div",{className:"col-span-1",children:e.jsx("input",{type:"number",value:t.quantity,onChange:A=>Yt(t.product._id,parseInt(A.target.value)||1),className:"input text-center h-8",min:"1",max:((I=t.product.inventory)==null?void 0:I.currentStock)||999999,title:`Maximum available: ${((R=t.product.inventory)==null?void 0:R.currentStock)||0}`})}),ue&&Te("view_cost_prices")&&e.jsx("div",{className:"col-span-1",children:e.jsx("span",{className:"text-sm font-semibold text-red-700 bg-red-50 px-2 py-1 rounded border border-red-200 block text-center h-8 flex items-center justify-center",title:"Last Purchase Price",children:ee[t.product._id]!==void 0?`${Math.round(ee[t.product._id])}`:"N/A"})}),e.jsxs("div",{className:"col-span-1 relative",children:[e.jsx("input",{type:"number",step:"1",value:Math.round(t.unitPrice),onChange:A=>Ht(t.product._id,parseInt(A.target.value)||0),className:`input text-center h-8 ${ee[t.product._id]!==void 0&&t.unitPrice<ee[t.product._id]?"bg-red-50 border-red-400 ring-2 ring-red-300":J[t.product._id]==="updated"?"bg-green-50 border-green-300 ring-1 ring-green-200":J[t.product._id]==="not-found"?"bg-yellow-50 border-yellow-300 ring-1 ring-yellow-200":J[t.product._id]==="unchanged"?"bg-blue-50 border-blue-300 ring-1 ring-blue-200":""}`,min:"0",title:ee[t.product._id]!==void 0&&t.unitPrice<ee[t.product._id]?`⚠️ WARNING: Sale price (${Math.round(t.unitPrice)}) is below cost price (${Math.round(ee[t.product._id])})`:""}),ke&&J[t.product._id]&&e.jsxs("div",{className:"absolute -right-7 top-1/2 transform -translate-y-1/2 flex items-center z-10",title:J[t.product._id]==="updated"?"Price updated from last order":J[t.product._id]==="unchanged"?"Price same as last order":"Product not found in previous order",children:[J[t.product._id]==="updated"&&e.jsx(wt,{className:"h-4 w-4 text-green-600 bg-white rounded-full"}),J[t.product._id]==="unchanged"&&e.jsx(Pt,{className:"h-4 w-4 text-blue-600 bg-white rounded-full"}),J[t.product._id]==="not-found"&&e.jsx(xe,{className:"h-4 w-4 text-yellow-600 bg-white rounded-full"})]})]}),e.jsx("div",{className:"col-span-1",children:e.jsx("span",{className:"text-sm font-semibold text-gray-700 bg-gray-100 px-2 py-1 rounded border border-gray-200 block text-center h-8 flex items-center justify-center",children:Math.round(i)})}),e.jsx("div",{className:"col-span-1",children:e.jsx(pe,{onClick:()=>yt(t.product._id),isLoading:p[t.product._id],className:"btn btn-danger btn-sm h-8 w-full",children:e.jsx(St,{className:"h-4 w-4"})})})]})},t.product._id)})]})]})]}),u.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-lg max-w-5xl ml-auto mt-4",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-blue-200",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 text-right mb-4",children:"Sales Details"}),e.jsxs("div",{className:"flex flex-nowrap gap-3 items-end justify-end",children:[e.jsxs("div",{className:"flex flex-col w-44",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Order Type"}),e.jsxs("select",{value:(s==null?void 0:s.businessType)||"wholesale",className:"input h-8 text-sm",disabled:!0,children:[e.jsx("option",{value:"retail",children:"Retail"}),e.jsx("option",{value:"wholesale",children:"Wholesale"}),e.jsx("option",{value:"return",children:"Return"}),e.jsx("option",{value:"exchange",children:"Exchange"})]})]}),e.jsxs("div",{className:"flex flex-col w-40",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Tax Status"}),e.jsxs("div",{className:"flex items-center space-x-1 px-2 py-1 border border-gray-200 rounded h-8",children:[e.jsx("input",{type:"checkbox",id:"taxExempt",checked:L,onChange:t=>Q(t.target.checked),className:"h-3 w-3 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsx("div",{className:"flex-1",children:e.jsx("label",{htmlFor:"taxExempt",className:"text-xs font-medium text-gray-700 cursor-pointer",children:"Tax Exempt"})}),L&&e.jsx("div",{className:"text-green-600 text-xs font-medium",children:"✓"})]})]}),e.jsxs("div",{className:"flex flex-col w-72",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 m-0",children:"Invoice Number"}),e.jsxs("label",{htmlFor:"autoGenerateInvoice",className:"flex items-center space-x-1 text-[11px] text-gray-600 cursor-pointer select-none",children:[e.jsx("input",{type:"checkbox",id:"autoGenerateInvoice",checked:je,onChange:t=>{he(t.target.checked),t.target.checked&&s&&ce(Xe(s))},className:"h-3 w-3 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsx("span",{children:"Auto-generate"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:S,onChange:t=>ce(t.target.value),className:"w-full input pr-16 h-8 text-sm",placeholder:je?"Auto-generated":"Enter invoice number",disabled:je}),je&&e.jsx("button",{type:"button",onClick:()=>{s&&ce(Xe(s))},className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-[11px] text-primary-600 hover:text-primary-800 font-medium",children:"Regenerate"})]})]}),e.jsxs("div",{className:"flex flex-col w-[28rem]",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Notes"}),e.jsx("input",{type:"text",value:ie,onChange:t=>ve(t.target.value),className:"input h-8 text-sm",placeholder:"Additional notes..."})]})]})]}),e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-600 px-6 py-4",children:e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Order Summary"})}),e.jsxs("div",{className:"px-6 py-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-800 font-semibold",children:"Subtotal:"}),e.jsx("span",{className:"text-xl font-bold text-gray-900",children:Math.round(ye)})]}),we>0&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-800 font-semibold",children:"Discount:"}),e.jsxs("span",{className:"text-xl font-bold text-red-600",children:["-",Math.round(we)]})]}),!L&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-800 font-semibold",children:"Tax (8%):"}),e.jsx("span",{className:"text-xl font-bold text-gray-900",children:Math.round(Ee)})]}),s&&(()=>{const t=s.pendingBalance||0,r=s.advanceBalance||0,i=t-r;return t>0||r>0?e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsx("span",{className:"text-gray-800 font-semibold",children:i<0?"Previous Advance:":"Previous Receivables:"}),e.jsxs("span",{className:`text-xl font-bold ${i<0?"text-red-600":"text-green-600"}`,children:[i<0?"-":"+",Math.abs(Math.round(i))]})]}):null})(),e.jsxs("div",{className:"flex justify-between items-center text-xl font-bold border-t-2 border-blue-400 pt-3 mt-2",children:[e.jsx("span",{className:"text-blue-900",children:"Total:"}),e.jsx("span",{className:"text-blue-900 text-3xl",children:Math.round(ae)})]}),s&&(()=>{const t=s.pendingBalance||0,r=s.advanceBalance||0,i=t-r;if(!(t>0||r>0))return null;const n=ae+i,o=n<0;return e.jsxs("div",{className:"flex justify-between items-center text-lg font-bold border-t-2 border-red-400 pt-3 mt-2",children:[e.jsx("span",{className:o?"text-red-700":"text-green-700",children:o?"Total Advance:":"Total Receivables:"}),e.jsx("span",{className:`text-2xl ${o?"text-red-700":"text-green-700"}`,children:Math.abs(Math.round(n))})]})})()]}),e.jsxs("div",{className:"mt-4 bg-white rounded-lg p-4 shadow-sm",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[minmax(0,2fr)_minmax(0,1fr)_minmax(0,1fr)] gap-4 items-start",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Apply Discount"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("select",{value:T.type,onChange:t=>G({...T,type:t.target.value}),className:"px-3 py-2 border-2 border-blue-200 rounded-md bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-medium h-[42px]",children:[e.jsx("option",{value:"amount",children:"Amount"}),e.jsx("option",{value:"percentage",children:"%"})]}),e.jsx("input",{type:"number",placeholder:T.type==="amount"?"Enter amount...":"Enter percentage...",value:T.value||"",onChange:t=>{const r=parseInt(t.target.value)||0;G({...T,value:r})},className:"flex-1 px-3 py-2 border-2 border-blue-200 rounded-md bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-medium text-gray-900 h-[42px]",min:"0",step:(T.type==="percentage","1")})]}),T.value>0&&e.jsx("div",{className:"text-sm text-green-700 font-semibold mt-2 bg-green-50 px-2 py-1 rounded",children:T.type==="percentage"?`${T.value}% = ${Math.round(Ve)} off`:`${Math.round(T.value)} off`})]}),e.jsxs("div",{className:"flex flex-col md:col-start-2 md:row-start-1 w-full",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Payment Method"}),e.jsxs("select",{value:C,onChange:t=>{const r=t.target.value;U(r),r!=="bank"&&m("")},className:"w-full px-3 py-2 border-2 border-blue-200 rounded-md bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-medium text-gray-900 h-[42px]",children:[e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"bank",children:"Bank Transfer"}),e.jsx("option",{value:"credit_card",children:"Credit Card"}),e.jsx("option",{value:"debit_card",children:"Debit Card"}),e.jsx("option",{value:"check",children:"Check"}),e.jsx("option",{value:"account",children:"Account"}),e.jsx("option",{value:"split",children:"Split Payment"})]}),C==="bank"&&e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Bank Account"}),e.jsxs("select",{value:F,onChange:t=>m(t.target.value),className:"w-full px-3 py-2 border-2 border-blue-200 rounded-md bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-medium text-gray-900 h-[42px]",children:[e.jsx("option",{value:"",children:"Select bank account..."}),Re.map(t=>e.jsxs("option",{value:t._id,children:[t.bankName," - ",t.accountNumber,t.accountName?` (${t.accountName})`:""]},t._id))]}),xt&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Loading bank accounts..."}),!xt&&Re.length===0&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:"No bank accounts available. Add one in Banks."})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Amount Paid"}),e.jsx("input",{type:"number",step:"1",value:Math.round(j),onChange:t=>q(parseInt(t.target.value)||0),onFocus:t=>t.target.select(),className:"w-full px-3 py-2 border-2 border-blue-200 rounded-md bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-medium text-gray-900 text-lg h-[42px]",placeholder:"0"})]})]}),T.value>0&&e.jsx("div",{className:"mt-2",children:e.jsx("button",{onClick:()=>G({type:"amount",value:0}),className:"px-3 py-1 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm",children:"Clear Discount"})})]}),e.jsxs("div",{className:"flex space-x-3 mt-6",children:[u.length>0&&e.jsxs(pe,{onClick:Xt,isLoading:Qe,className:"btn btn-secondary flex-1",children:[e.jsx(St,{className:"h-4 w-4 mr-2"}),"Clear Cart"]}),u.length>0&&e.jsxs("button",{onClick:()=>{const t={orderNumber:`TEMP-${Date.now()}`,orderType:et(s==null?void 0:s.businessType),customer:s==null?void 0:s._id,customerInfo:s?{name:s.displayName,email:s.email,phone:s.phone,businessName:s.businessName}:null,items:u.map(r=>({product:{name:r.product.name},quantity:r.quantity,unitPrice:r.unitPrice})),pricing:{subtotal:ye,discountAmount:we,taxAmount:Ee,isTaxExempt:L,total:ae},payment:{method:C,bankAccount:C==="bank"?F:null,amountPaid:j,remainingBalance:ae-j,isPartialPayment:j<ae,isAdvancePayment:K,advanceAmount:K?j-ae:0},createdAt:new Date,createdBy:{name:"Current User"},invoiceNumber:S};D(t),_(!0)},className:"btn btn-secondary flex-1",children:[e.jsx(Ls,{className:"h-4 w-4 mr-2"}),"Print Preview"]}),e.jsxs(pe,{onClick:ts,isLoading:Ge||Ye||He,disabled:Ge||Ye||He,className:"btn btn-primary btn-lg flex-2",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),a!=null&&a.isEditMode?j===0?"Update Invoice":"Update Sale":j===0?"Create Invoice":"Complete Sale"]})]})]})]}),u.length>0&&e.jsx("div",{className:"mt-4 max-w-5xl ml-auto",children:e.jsx(Ws,{title:"Customers Also Bought",algorithm:"frequently_bought",context:{page:"sales",currentProducts:u.map(t=>t.product._id),customerTier:s==null?void 0:s.customerTier,businessType:s==null?void 0:s.businessType},limit:4,onAddToCart:gt,onViewProduct:t=>{Lt(t)}})})]}),e.jsx(ws,{isOpen:Qt.isOpen,onClose:Jt,onConfirm:Kt,itemCount:u.length,itemType:"items",isLoading:!1}),e.jsx(qs,{isOpen:x,onClose:()=>{w(!1),D(null)},orderData:E,onPaymentSuccess:ss,onPaymentError:rs}),e.jsx(Cs,{isOpen:k,onClose:()=>{_(!1),D(null)},orderData:E,documentTitle:"Sales Invoice",partyLabel:"Customer"}),Et&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Export Sales Report"}),e.jsx("button",{onClick:()=>{Oe(!1),qe(me.from),Ue(me.to)},className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Is,{className:"h-6 w-6"})})]}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Export Format"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("label",{className:"flex items-center p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"radio",name:"format",value:"pdf",checked:te==="pdf",onChange:t=>Fe(t.target.value),className:"mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:"PDF"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Print-ready format"})]})]}),e.jsxs("label",{className:"flex items-center p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"radio",name:"format",value:"excel",checked:te==="excel",onChange:t=>Fe(t.target.value),className:"mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:"Excel"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Spreadsheet format"})]})]}),e.jsxs("label",{className:"flex items-center p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"radio",name:"format",value:"csv",checked:te==="csv",onChange:t=>Fe(t.target.value),className:"mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:"CSV"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Comma-separated values"})]})]}),e.jsxs("label",{className:"flex items-center p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"radio",name:"format",value:"json",checked:te==="json",onChange:t=>Fe(t.target.value),className:"mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:"JSON"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Data format"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Date Range (Optional)"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"From Date"}),e.jsx("input",{type:"date",value:Ae,onChange:t=>qe(t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"To Date"}),e.jsx("input",{type:"date",value:De,onChange:t=>Ue(t.target.value),min:Ae,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),(Ae||De)&&e.jsx("button",{type:"button",onClick:()=>{qe(me.from),Ue(me.to)},className:"mt-2 text-sm text-primary-600 hover:text-primary-700",children:"Reset to default"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:()=>{Oe(!1),qe(me.from),Ue(me.to)},className:"btn btn-secondary",disabled:Ke,children:"Cancel"}),e.jsx("button",{type:"button",onClick:es,className:"btn btn-primary",disabled:Ke,children:Ke?e.jsxs(e.Fragment,{children:[e.jsx(gs,{className:"h-4 w-4 mr-2"}),"Exporting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Nt,{className:"h-4 w-4 mr-2"}),"Export"]})})]})]})})]})})]})};export{Tr as Sales};
